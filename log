=== Docker build Dockerfile.bridge-local-git
[2017-05-02 08:36.23] Starting...
Cloning into '/tmp/with_clone151499fd'...
done.
warning: remote HEAD refers to nonexistent ref, unable to checkout.

HEAD is now at ed918bd Merge pull request #543 from samoht/release
[2017-05-02 08:36.23] Rewrite Dockerfile's first line to:
FROM sha256:c75a4bc73cf9c3222243b58d2e591bf8008e4ac28b5e057525c8f232a7608f70
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon  5.48 MB
Step 1/21 : FROM sha256:c75a4bc73cf9c3222243b58d2e591bf8008e4ac28b5e057525c8f232a7608f70
 ---> c75a4bc73cf9
Step 2/21 : RUN opam pin add github --dev -n
 ---> Using cache
 ---> a45ddfcb08a6
Step 3/21 : RUN opam pin add datakit-github.dev /home/opam/src/datakit -n
 ---> Using cache
 ---> a3637f7f7713
Step 4/21 : RUN opam pin add irmin.1.1.0 -n https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0
 ---> Using cache
 ---> b64d64ecb836
Step 5/21 : RUN opam pin add irmin-git.1.1.0 -n https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0
 ---> Using cache
 ---> aa871a7014a1
Step 6/21 : RUN opam pin add irmin-unix.1.1.0 -n https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0
 ---> Using cache
 ---> 7fa0c17e4d1e
Step 7/21 : RUN opam depext datakit-github && opam install datakit-github --deps
 ---> Using cache
 ---> fc4e465b4752
Step 8/21 : COPY datakit-bridge-local-git.opam /home/opam/src/datakit/datakit-bridge-local-git.opam
 ---> Using cache
 ---> c890af2b450e
Step 9/21 : RUN opam pin add datakit-bridge-local-git.dev /home/opam/src/datakit -n
 ---> Using cache
 ---> 053ed57bd01b
Step 10/21 : RUN opam depext datakit-bridge-local-git && opam install datakit-bridge-local-git --deps
 ---> Running in 556c71f51e4b
# Detecting depexts using flags: x86_64 linux alpine
# The following system packages are needed:
#  - gmp-dev
#  - linux-headers
#  - m4
#  - ncurses-dev
#  - openssl-dev
#  - perl
#  - pkgconfig
#  - zlib-dev
m4
ncurses-dev
pkgconf
# The following new OS packages need to be installed: gmp-dev linux-headers openssl-dev perl zlib-dev
The following command needs to be run through "sudo":
    apk add gmp-dev linux-headers openssl-dev perl zlib-dev
(1/8) Installing libgmpxx (6.1.1-r0)
(2/8) Installing gmp-dev (6.1.1-r0)
(3/8) Installing linux-headers (4.4.6-r1)
(4/8) Installing zlib-dev (1.2.8-r2)
(5/8) Installing libcrypto1.0 (1.0.2k-r0)
(6/8) Installing libssl1.0 (1.0.2k-r0)
(7/8) Installing openssl-dev (1.0.2k-r0)
(8/8) Installing perl (5.24.0-r0)
Executing busybox-1.25.1-r0.trigger
OK: 654 MiB in 101 packages
# OS packages installation successful

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-bridge-local-git: local] Command started
[datakit-bridge-local-git] /home/opam/src/datakit/ already up-to-date
The following actions will be performed:
  - install conf-perl       1     
  - install camlzip         1.07  
  - install calendar        2.03.2
  - install mtime           0.8.4 
  - install magic-mime      1.0.0 
  - install datakit-github  dev*  
  - install fieldslib       v0.9.0
  - install conf-gmp        1     
  - install ocamlgraph      1.8.7 
  - install cpuid           0.1.1 
  - install uutf            1.0.1 
  - install mirage-no-solo5 1     
  - install crunch          2.0.0 
  - install ipaddr          2.7.2 
  - install base64          2.1.2 
  - install irmin-watcher   0.2.0 
  - install mstruct         1.3.2 
  - install dispatch        0.3.0 
  - install mirage-no-xen   1     
  - install hex             1.0.0 
  - install ppx_fields_conv v0.9.0
  - install zarith          1.4.1 
  - install jsonm           1.0.1 
  - install conduit         0.15.0
  - install git             1.10.0
  - install nocrypto        0.5.4 
  - install irmin           1.1.0*
  - install cohttp          0.22.0
  - install irmin-git       1.1.0*
  - install webmachine      0.4.0 
  - install git-http        1.10.0
  - install irmin-http      1.0.0 
  - install git-unix        1.10.1
  - install irmin-unix      1.1.0*
===== 34 to install =====

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[base64: http] Command started
[calendar: http] Command started
[camlzip: http] Command started
[calendar: http] Command started
[calendar.2.03.2] http://forge.ocamlcore.org/frs/download.php/915/calendar-2.03.2.tar.gz downloaded
[cohttp: http] Command started
[base64: http] Command started
[base64.2.1.2] https://github.com/mirage/ocaml-base64/releases/download/v2.1.2/base64-2.1.2.tbz downloaded
[conduit: http] Command started
[camlzip: http] Command started
[camlzip.1.07] https://github.com/xavierleroy/camlzip/archive/rel107.zip downloaded
[cpuid: http] Command started
[cohttp: http] Command started
[cohttp.0.22.0] https://github.com/mirage/ocaml-cohttp/archive/v0.22.0.tar.gz downloaded
[crunch: http] Command started
[conduit: http] Command started
[conduit.0.15.0] https://github.com/mirage/ocaml-conduit/archive/v0.15.0.tar.gz downloaded
[datakit-github: local] Command started
[datakit-github.dev] /home/opam/src/datakit/ already up-to-date
[dispatch: http] Command started
[crunch: http] Command started
[crunch.2.0.0] https://github.com/mirage/ocaml-crunch/releases/download/2.0.0/crunch-2.0.0.tbz downloaded
[fieldslib: http] Command started
[cpuid: http] Command started
[cpuid.0.1.1] https://github.com/pqwy/cpuid/releases/download/v0.1.1/cpuid-0.1.1.tbz downloaded
[git: http] Command started
[fieldslib: http] Command started
[fieldslib.v0.9.0] https://ocaml.janestreet.com/ocaml-core/v0.9/files/fieldslib-v0.9.0.tar.gz downloaded
[git-http: http] Command started
[dispatch: http] Command started
[dispatch.0.3.0] https://github.com/inhabitedtype/ocaml-dispatch/archive/0.3.0.tar.gz downloaded
[git-unix: http] Command started
[git: http] Command started
[git.1.10.0] https://github.com/mirage/ocaml-git/releases/download/1.10.0/git-1.10.0.tbz downloaded
[hex: http] Command started
[git-unix: http] Command started
[git-unix.1.10.1] https://github.com/mirage/ocaml-git/releases/download/1.10.1/git-1.10.1.tbz downloaded
[ipaddr: http] Command started
[git-http: http] Command started
[git-http.1.10.0] https://github.com/mirage/ocaml-git/releases/download/1.10.0/git-1.10.0.tbz downloaded
[irmin: git] Command started
[irmin: git] Command started
[hex: http] Command started
[hex.1.0.0] https://github.com/mirage/ocaml-hex/archive/1.0.0.tar.gz downloaded
[irmin-git: git] Command started
[irmin-git: git] Command started
[irmin: git] Command started
[irmin: git] Command started
[irmin] https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0 already up-to-date
[irmin-http: http] Command started
[irmin-git: git] Command started
[irmin-git: git] Command started
[irmin-git] https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0 already up-to-date
[irmin-unix: git] Command started
[irmin-unix: git] Command started
[ipaddr: http] Command started
[ipaddr.2.7.2] https://github.com/mirage/ocaml-ipaddr/releases/download/2.7.2/ipaddr-2.7.2.tbz downloaded
[irmin-watcher: http] Command started
[irmin-unix: git] Command started
[irmin-unix: git] Command started
[irmin-unix] https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0 already up-to-date
[jsonm: http] Command started
[jsonm: http] Command started
[jsonm.1.0.1] http://erratique.ch/software/jsonm/releases/jsonm-1.0.1.tbz downloaded
[magic-mime: http] Command started
[irmin-watcher: http] Command started
[irmin-watcher.0.2.0] https://github.com/samoht/irmin-watcher/releases/download/0.2.0/irmin-watcher-0.2.0.tbz downloaded
[mstruct: http] Command started
[irmin-http: http] Command started
[irmin-http.1.0.0] https://github.com/mirage/irmin/releases/download/1.0.0/irmin-1.0.0.tbz downloaded
[mtime: http] Command started
[mtime: http] Command started
[mtime.0.8.4] http://erratique.ch/software/mtime/releases/mtime-0.8.4.tbz downloaded
[nocrypto: http] Command started
[magic-mime: http] Command started
[magic-mime.1.0.0] https://github.com/mirage/ocaml-magic-mime/archive/v1.0.0.tar.gz downloaded
[ocamlgraph: http] Command started
[ocamlgraph: http] Command started
[ocamlgraph.1.8.7] http://ocamlgraph.lri.fr/download/ocamlgraph-1.8.7.tar.gz downloaded
[ppx_fields_conv: http] Command started
[mstruct: http] Command started
[mstruct.1.3.2] https://github.com/mirage/ocaml-mstruct/archive/1.3.2.tar.gz downloaded
[uutf: http] Command started
[uutf: http] Command started
[uutf.1.0.1] http://erratique.ch/software/uutf/releases/uutf-1.0.1.tbz downloaded
[webmachine: http] Command started
[ppx_fields_conv: http] Command started
[ppx_fields_conv.v0.9.0] https://ocaml.janestreet.com/ocaml-core/v0.9/files/ppx_fields_conv-v0.9.0.tar.gz downloaded
[zarith: http] Command started
[zarith: http] Command started
[zarith.1.4.1] https://forge.ocamlcore.org/frs/download.php/1574/zarith-1.4.1.tgz downloaded
[webmachine: http] Command started
[webmachine.0.4.0] https://github.com/inhabitedtype/ocaml-webmachine/archive/0.4.0.tar.gz downloaded
[nocrypto: http] Command started
[nocrypto.0.5.4] https://github.com/mirleft/ocaml-nocrypto/releases/download/v0.5.4/nocrypto-0.5.4.tbz downloaded

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[base64: ocaml build] Command started
[calendar: ./configure] Command started
[camlzip: make all] Command started
[conf-gmp: sh] Command started
-> installed conf-gmp.1
[conf-perl: perl] Command started
-> installed conf-perl.1
[cpuid: ocaml build] Command started
-> installed base64.2.1.2
[crunch: ocaml build] Command started
[calendar: make] Command started
[camlzip: make allopt] Command started
[camlzip: make install-findlib] Command started
-> installed camlzip.1.07
[datakit-github: jbuilder build] Command started
-> installed cpuid.0.1.1
[dispatch: ocaml setup.ml] Command started
-> installed crunch.2.0.0
[fieldslib: jbuilder build] Command started
-> installed datakit-github.dev
[hex: ./configure] Command started
-> installed fieldslib.v0.9.0
[ipaddr: ocaml build] Command started
[calendar: make install] Command started
-> installed calendar.2.03.2
[irmin-watcher: ocaml build] Command started
[dispatch: ocaml setup.ml] Command started
[hex: make] Command started
-> installed irmin-watcher.0.2.0
[magic-mime: ./configure] Command started
-> installed ipaddr.2.7.2
[conduit: ./configure] Command started
[dispatch: ocaml setup.ml] Command started
[conduit: make] Command started
[magic-mime: make] Command started
[hex: make install] Command started
-> installed dispatch.0.3.0
-> installed mirage-no-solo5.1
-> installed mirage-no-xen.1
[mstruct: ./configure] Command started
-> installed hex.1.0.0
[mtime: ocaml build] Command started
[magic-mime: make install] Command started
[mstruct: make] Command started
-> installed mtime.0.8.4
[ocamlgraph: touch] Command started
[ocamlgraph: ./configure] Command started
[ocamlgraph: make] Command started
-> installed magic-mime.1.0.0
[ppx_fields_conv: jbuilder build] Command started
[mstruct: make install] Command started
-> installed ppx_fields_conv.v0.9.0
[uutf: ocaml build] Command started
[conduit: make install] Command started
-> installed conduit.0.15.0
[cohttp: make] Command started
-> installed mstruct.1.3.2
[zarith: ./configure] Command started
-> installed uutf.1.0.1
[jsonm: ocaml build] Command started
[zarith: make] Command started
-> installed jsonm.1.0.1
[ocamlgraph: make install-findlib] Command started
-> installed ocamlgraph.1.8.7
[git: ocaml build] Command started
[irmin: ocaml build] Command started
[zarith: make install] Command started
-> installed zarith.1.4.1
[nocrypto: ocaml build] Command started
-> installed git.1.10.0
-> installed irmin.1.1.0
[irmin-git: ocaml build] Command started
-> installed nocrypto.0.5.4
-> installed irmin-git.1.1.0
[cohttp: make install] Command started
-> installed cohttp.0.22.0
[git-http: ocaml build] Command started
[webmachine: ocaml setup.ml] Command started
-> installed git-http.1.10.0
[git-unix: ocaml build] Command started
[webmachine: ocaml setup.ml] Command started
-> installed git-unix.1.10.1
[webmachine: ocaml setup.ml] Command started
-> installed webmachine.0.4.0
[irmin-http: ocaml build] Command started
-> installed irmin-http.1.0.0
[irmin-unix: ocaml build] Command started
-> installed irmin-unix.1.1.0
Done.
 ---> 03fe8a060265
Removing intermediate container 556c71f51e4b
Step 11/21 : COPY . /home/opam/src/datakit/
 ---> 5b135eebc3b6
Removing intermediate container 41c0dbc7cd0d
Step 12/21 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in 606aa2842404
 ---> cf46b27fc8a5
Removing intermediate container 606aa2842404
Step 13/21 : RUN cd /home/opam/src/datakit &&     scripts/watermark.sh &&     git status --porcelain
 ---> Running in 9fdc7b010544
 M Dockerfile.bridge-local-git
 M src/version.ml
 ---> 6cd5716be3a8
Removing intermediate container 9fdc7b010544
Step 14/21 : RUN opam update datakit-bridge-local-git
 ---> Running in 79165620876c

=-=- Synchronizing development packages -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-bridge-local-git: local] Command started
[datakit-bridge-local-git] /home/opam/src/datakit/ synchronized
 ---> c6203655286e
Removing intermediate container 79165620876c
Step 15/21 : RUN opam install datakit-bridge-local-git -vv
 ---> Running in da8707ab29c2

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-bridge-local-git: local] Command started
+ rsync "-rLptgoDrvc" "--exclude" ".git" "--exclude" "_darcs" "--exclude" ".hg" "--exclude" ".#*" "--delete" "/home/opam/src/datakit/" "/home/opam/.opam/4.04.1/packages.dev/datakit-bridge-local-git"
- sending incremental file list
- 
- sent 8,055 bytes  received 46 bytes  16,202.00 bytes/sec
- total size is 1,250,368  speedup is 154.35
[datakit-bridge-local-git] /home/opam/src/datakit/ already up-to-date
The following actions will be performed:
  - install datakit-bridge-local-git dev*

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-bridge-local-git: local] Command started
+ rsync "-rLptgoDrvc" "--exclude" ".git" "--exclude" "_darcs" "--exclude" ".hg" "--exclude" ".#*" "--delete" "/home/opam/src/datakit/" "/home/opam/.opam/4.04.1/packages.dev/datakit-bridge-local-git"
- sending incremental file list
- 
- sent 8,055 bytes  received 46 bytes  16,202.00 bytes/sec
- total size is 1,250,368  speedup is 154.35
[datakit-bridge-local-git.dev] /home/opam/src/datakit/ already up-to-date

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-bridge-local-git: jbuilder build] Command started
+ jbuilder "build" "-p" "datakit-bridge-local-git" "-j" "4" (CWD=/home/opam/.opam/4.04.1/build/datakit-bridge-local-git.dev)
-     ocamldep bridge/local/main.depends.ocamldep-output
-     ocamldep bridge/local/main.dependsi.ocamldep-output
-       ocamlc bridge/local/main.{cmi,cmti}
-       ocamlc bridge/local/sync.{cmi,cmti}
-     ocamlopt bridge/local/sync.{cmx,o}
-     ocamlopt bridge/local/main.{cmx,o}
-     ocamlopt bridge/local/main.exe
+ install "-m" "0755" "/home/opam/.opam/4.04.1/build/datakit-bridge-local-git.dev/_build/install/default/bin/datakit-bridge-local-git" "/home/opam/.opam/4.04.1/bin/datakit-bridge-local-git"
+ install "-m" "0644" "/home/opam/.opam/4.04.1/build/datakit-bridge-local-git.dev/_build/install/default/lib/datakit-bridge-local-git/META" "/home/opam/.opam/4.04.1/lib/datakit-bridge-local-git/META"
+ install "-m" "0644" "/home/opam/.opam/4.04.1/build/datakit-bridge-local-git.dev/_build/install/default/lib/datakit-bridge-local-git/opam" "/home/opam/.opam/4.04.1/lib/datakit-bridge-local-git/opam"
+ install "-m" "0644" "/home/opam/.opam/4.04.1/build/datakit-bridge-local-git.dev/_build/install/default/doc/datakit-bridge-local-git/README.md" "/home/opam/.opam/4.04.1/doc/datakit-bridge-local-git/README.md"
+ install "-m" "0644" "/home/opam/.opam/4.04.1/build/datakit-bridge-local-git.dev/_build/install/default/doc/datakit-bridge-local-git/LICENSE.md" "/home/opam/.opam/4.04.1/doc/datakit-bridge-local-git/LICENSE.md"
+ install "-m" "0644" "/home/opam/.opam/4.04.1/build/datakit-bridge-local-git.dev/_build/install/default/doc/datakit-bridge-local-git/CHANGES.md" "/home/opam/.opam/4.04.1/doc/datakit-bridge-local-git/CHANGES.md"
-> installed datakit-bridge-local-git.dev
Done.
 ---> 84090aaee3bf
Removing intermediate container da8707ab29c2
Step 16/21 : RUN opam config exec -- ocaml /home/opam/src/datakit/check-libev.ml
 ---> Running in ce20495dae0c
 ---> fbf899a2b8dc
Removing intermediate container ce20495dae0c
Step 17/21 : RUN sudo cp $(opam config exec -- which datakit-bridge-local-git) /usr/bin/
 ---> Running in a216ac031320
 ---> 708abf92f3c8
Removing intermediate container a216ac031320
Step 18/21 : FROM alpine:3.5
 ---> 4a415e366388
Step 19/21 : RUN apk add --no-cache libev gmp tzdata ca-certificates
 ---> Using cache
 ---> cfa1a4a81238
Step 20/21 : ENTRYPOINT /usr/bin/datakit-bridge-local-git
 ---> Using cache
 ---> 025b59017633
Step 21/21 : COPY --from=0 /usr/bin/datakit-bridge-local-git /usr/bin/datakit-bridge-local-git
 ---> 4674d17be281
Removing intermediate container baf5ff53b689
Successfully built 4674d17be281
[2017-05-02 08:38.03] Success
