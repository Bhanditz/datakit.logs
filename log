=== Docker build Dockerfile
[2017-05-15 21:48.29] Starting...
Cloning into '/tmp/with_clone3b308473'...
done.
warning: remote HEAD refers to nonexistent ref, unable to checkout.

HEAD is now at a41aced Fix appveyor scripts
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.303 MB
Step 1/32 : FROM ocaml/opam-dev@sha256:64dc0522876ebbd27b186e3ba955ae5ab864ace580add5b0d1abb8715bdf1bbe
sha256:64dc0522876ebbd27b186e3ba955ae5ab864ace580add5b0d1abb8715bdf1bbe: Pulling from ocaml/opam-dev
Digest: sha256:64dc0522876ebbd27b186e3ba955ae5ab864ace580add5b0d1abb8715bdf1bbe
Status: Image is up to date for ocaml/opam-dev@sha256:64dc0522876ebbd27b186e3ba955ae5ab864ace580add5b0d1abb8715bdf1bbe
 ---> 477ad7d223ad
Step 2/32 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 20061f41087f
Step 3/32 : RUN sudo apk add tzdata aspcud gmp-dev perl
 ---> Using cache
 ---> f112729d161c
Step 4/32 : RUN opam pin add irmin.1.1.0 -n https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0
 ---> Using cache
 ---> b2eae6f4800a
Step 5/32 : RUN opam pin add irmin-git.1.1.0 -n https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0
 ---> Using cache
 ---> 9b82cbd2f42b
Step 6/32 : RUN opam pin add -yn protocol-9p.0.11.0 'https://github.com/mirage/ocaml-9p.git#v0.11.0'
 ---> Using cache
 ---> 7c7555ff51a3
Step 7/32 : RUN opam pin add -yn protocol-9p-unix.0.11.0 'https://github.com/mirage/ocaml-9p.git#v0.11.0'
 ---> Using cache
 ---> fed1f6b5c38b
Step 8/32 : RUN opam depext -ui lwt inotify alcotest conf-libev asl win-eventlog camlzip     irmin-watcher mtime mirage-flow conduit hvsock prometheus-app git irmin     cmdliner protocol-9p rresult win-error named-pipe
 ---> Using cache
 ---> 6d7dd847476d
Step 9/32 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> 26626382c243
Step 10/32 : RUN opam config exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> 32634368192e
Step 11/32 : COPY datakit.opam /home/opam/src/datakit/
 ---> Using cache
 ---> 5cda557ac5c2
Step 12/32 : COPY datakit-client.opam /home/opam/src/datakit/datakit-client.opam
 ---> Using cache
 ---> 420121542837
Step 13/32 : COPY datakit-client-9p.opam /home/opam/src/datakit/datakit-client-9p.opam
 ---> Using cache
 ---> acb5a83928f3
Step 14/32 : COPY datakit-server.opam /home/opam/src/datakit/datakit-server.opam
 ---> Using cache
 ---> d2f6a832b96f
Step 15/32 : COPY datakit-server-9p.opam /home/opam/src/datakit/datakit-server-9p.opam
 ---> Using cache
 ---> e24d2a378f45
Step 16/32 : RUN opam pin add datakit-server.dev /home/opam/src/datakit -yn &&     opam pin add datakit-server-9p.dev /home/opam/src/datakit -yn &&     opam pin add datakit-client.dev /home/opam/src/datakit -yn &&     opam pin add datakit-client-9p.dev /home/opam/src/datakit -yn &&     opam pin add datakit.dev /home/opam/src/datakit -yn
 ---> Using cache
 ---> 7c0345d3c601
Step 17/32 : RUN opam depext -y datakit
 ---> Using cache
 ---> 69d69fd1c90e
Step 18/32 : RUN opam install -y --deps-only datakit-client datakit-server
 ---> Using cache
 ---> c80c4bf9b6f1
Step 19/32 : RUN opam install alcotest
 ---> Using cache
 ---> baa0586f3904
Step 20/32 : COPY . /home/opam/src/datakit
 ---> 000ff95b117d
Removing intermediate container c55cc1b3202e
Step 21/32 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in 859eeb6ac9cb
 ---> f135946582ce
Error removing intermediate container 859eeb6ac9cb: Driver aufs failed to remove root filesystem 859eeb6ac9cb1c3ee5284de64f74fd6f896363522843933482bb77c2c9cdca73: rename /var/lib/docker/aufs/mnt/00c15b01b5d7c5928b0989ead5c4dec2fea2142c94e064d261db05739820c4b1 /var/lib/docker/aufs/mnt/00c15b01b5d7c5928b0989ead5c4dec2fea2142c94e064d261db05739820c4b1-removing: device or resource busy
Step 22/32 : RUN cd /home/opam/src/datakit &&     scripts/watermark.sh &&     git status --porcelain
 ---> Running in da14bcf2a64e
 M src/version.ml
 ---> 0fea3110671b
Error removing intermediate container 859eeb6ac9cb: No such container: 859eeb6ac9cb1c3ee5284de64f74fd6f896363522843933482bb77c2c9cdca73
Step 23/32 : RUN opam install datakit-client-9p
 ---> Running in 09d64497bffb

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-client-9p.dev] synchronised from file:///home/opam/src/datakit

The following actions will be performed:
  - install datakit-client    dev*                              [required by datakit-client-9p]
  - install protocol-9p-unix  0.11.0*                           [required by datakit-client-9p]
  - install datakit-client-9p dev*
===== 3 to install =====
[datakit-client.dev] synchronised from file:///home/opam/src/datakit
[datakit-client-9p.dev] synchronised from file:///home/opam/src/datakit
[protocol-9p-unix.0.11.0] synchronised from git+https://github.com/mirage/ocaml-9p.git#v0.11.0

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-client.dev
-> installed protocol-9p-unix.0.11.0
-> installed datakit-client-9p.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> c171574002c3
Removing intermediate container 09d64497bffb
Error removing intermediate container 859eeb6ac9cb: No such container: 859eeb6ac9cb1c3ee5284de64f74fd6f896363522843933482bb77c2c9cdca73
Step 24/32 : RUN opam install datakit -ytv
 ---> Running in b21d0f39a3d3

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Processing  1/1: [datakit.dev: rsync]
[datakit.dev] synchronised from file:///home/opam/src/datakit

The following actions will be performed:
  - install irmin-git         1.1.0*                            [required by datakit]
  - install datakit-server    dev*                              [required by datakit-server-9p]
  - install datakit-server-9p dev*                              [required by datakit]
  - install datakit           dev*
===== 4 to install =====
Processing  1/4: [datakit.dev: rsync]
Processing  2/4: [datakit.dev: rsync] [datakit-server.dev: rsync]
Processing  3/4: [datakit.dev: rsync] [datakit-server.dev: rsync] [datakit-server-9p.dev: rsync]
[datakit.dev] synchronised from file:///home/opam/src/datakit
Processing  3/4: [datakit-server.dev: rsync] [datakit-server-9p.dev: rsync]
Processing  4/4: [datakit-server.dev: rsync] [datakit-server-9p.dev: rsync] [irmin-git.1.1.0: git]
[datakit-server.dev] synchronised from file:///home/opam/src/datakit
Processing  4/4: [datakit-server-9p.dev: rsync] [irmin-git.1.1.0: git]
[datakit-server-9p.dev] synchronised from file:///home/opam/src/datakit
Processing  4/4: [irmin-git.1.1.0: git]
[irmin-git.1.1.0] synchronised from git+https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Processing  1/8: [datakit-server: jbuilder build]
+ jbuilder "build" "-p" "datakit-server" "-j" "1" (CWD=/home/opam/.opam/default/.opam-switch/build/datakit-server.dev)
-     ocamldep src/datakit-server/datakit_server.depends.ocamldep-output
-     ocamldep src/datakit-server/datakit_server.dependsi.ocamldep-output
-       ocamlc src/datakit-server/vfs.{cmi,cmti}
-       ocamlc src/datakit-server/vfs.{cmo,cmt}
-     ocamlopt src/datakit-server/vfs.{cmx,o}
-       ocamlc src/datakit-server/datakit_server.cma
-     ocamlopt src/datakit-server/datakit_server.{a,cmxa}
-     ocamlopt src/datakit-server/datakit_server.cmxs
-> compiled  datakit-server.dev
Processing  2/8: [irmin-git: ocaml build]
+ ocaml "pkg/pkg.ml" "build" "--pinned" "true" "-n" "irmin-git" (CWD=/home/opam/.opam/default/.opam-switch/build/irmin-git.1.1.0)
- pkg.ml: [WARNING] Watermarks: opam fields of irmin-git.opam: topkg: no such command. Did you install topkg-care ?
- pkg.ml: [WARNING] file irmin-git.opam: opam field "maintainer" undefined or unsupported
- pkg.ml: [WARNING] file irmin-git.opam: opam field "authors" undefined or unsupported
- pkg.ml: [WARNING] file irmin-git.opam: opam field "homepage" undefined or unsupported
- pkg.ml: [WARNING] file irmin-git.opam: opam field "bug-reports" undefined or unsupported
- pkg.ml: [WARNING] file irmin-git.opam: opam field "doc" undefined or unsupported
- pkg.ml: [WARNING] file irmin-git.opam: opam field "license" undefined or unsupported
- pkg.ml: [WARNING] file irmin-git.opam: opam field "dev-repo" undefined or unsupported
- ocamlfind ocamldep -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -package irmin -modules src-git/irmin_git.ml > src-git/irmin_git.ml.depends
- ocamlfind ocamldep -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -package irmin -modules src-git/irmin_git.mli > src-git/irmin_git.mli.depends
- ocamlfind ocamlc -c -g -bin-annot -short-paths -strict-sequence -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -warn-error +1..49+60 -w A-4-41-44-7 -package irmin -I src-git -o src-git/irmin_git.cmi src-git/irmin_git.mli
- ocamlfind ocamlopt -c -g -bin-annot -short-paths -strict-sequence -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -warn-error +1..49+60 -w A-4-41-44-7 -package irmin -I src-git -o src-git/irmin_git.cmx src-git/irmin_git.ml
- ocamlfind ocamlopt -a -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -package irmin -I src-git src-git/irmin_git.cmx -o src-git/irmin-git.cmxa
- ocamlfind ocamlopt -shared -linkall -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -package irmin -I src-git src-git/irmin-git.cmxa -o src-git/irmin-git.cmxs
- ocamlfind ocamlc -c -g -bin-annot -short-paths -strict-sequence -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -warn-error +1..49+60 -w A-4-41-44-7 -package irmin -I src-git -o src-git/irmin_git.cmo src-git/irmin_git.ml
- ocamlfind ocamlc -a -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -package irmin -I src-git src-git/irmin_git.cmo -o src-git/irmin-git.cma
- pkg.ml: [WARNING] Package description has 8 warning(s), see log above.
-> compiled  irmin-git.1.1.0
-> installed datakit-server.dev
Processing  4/8: [datakit-server-9p: jbuilder build]
+ jbuilder "build" "-p" "datakit-server-9p" "-j" "1" (CWD=/home/opam/.opam/default/.opam-switch/build/datakit-server-9p.dev)
-     ocamldep src/datakit-server-9p/datakit_server_9p.depends.ocamldep-output
-     ocamldep src/datakit-server-9p/datakit_server_9p.dependsi.ocamldep-output
-       ocamlc src/datakit-server-9p/fs9p.{cmi,cmti}
-       ocamlc src/datakit-server-9p/fs9p_error.{cmi,cmti}
-       ocamlc src/datakit-server-9p/fs9p_error.{cmo,cmt}
-     ocamlopt src/datakit-server-9p/fs9p_error.{cmx,o}
-       ocamlc src/datakit-server-9p/fs9p.{cmo,cmt}
-     ocamlopt src/datakit-server-9p/fs9p.{cmx,o}
-       ocamlc src/datakit-server-9p/datakit_server_9p.cma
-     ocamlopt src/datakit-server-9p/datakit_server_9p.{a,cmxa}
-     ocamlopt src/datakit-server-9p/datakit_server_9p.cmxs
-> compiled  datakit-server-9p.dev
-> installed datakit-server-9p.dev
-> installed irmin-git.1.1.0
Processing  7/8: [datakit: jbuilder build]
+ jbuilder "build" "-p" "datakit" "-j" "1" (CWD=/home/opam/.opam/default/.opam-switch/build/datakit.dev)
- Error: Findlib package "irmin-mem" not found.
- -> required by "src/datakit/jbuild (context default)"
- Hint: try: jbuilder external-lib-deps --missing -p datakit -j 1


=-=- Error report -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
+- The following actions failed
| - build datakit dev
+- 
+- The following changes have been performed
| - install datakit-server    dev
| - install datakit-server-9p dev
| - install irmin-git         1.1.0
+- 
[91m[ERROR] The compilation of datakit failed at "jbuilder build -p datakit -j 1".

#=== ERROR while compiling datakit.dev ========================================#
# command              jbuilder build -p datakit -j 1
# path                 /home/opam/.opam/default/.opam-switch/build/datakit.dev
# exit-code            1
# env-file             /home/opam/.opam/log/datakit-7-51aaa5.env
# output-file          /home/opam/.opam/log/datakit-7-51aaa5.out
### output ###
# Error: Findlib package "irmin-mem" not found.
# -> required by "src/datakit/jbuild (context default)"
# Hint: try: jbuilder external-lib-deps --missing -p datakit -j 1

[0m# Run eval `opam env` to update the current shell environment
[91m
The former state can be restored with:
    opam switch import "/home/opam/.opam/default/.opam-switch/backup/state-20170515214904.export"
'opam install datakit -ytv' failed.
[0mThe command '/bin/sh -c opam install datakit -ytv' returned a non-zero code: 4
[2017-05-15 21:49.22] Failed: Command "docker" "build" "--pull" "-f" "Dockerfile" "." exited with status 4
