=== Docker build Dockerfile
[2017-04-26 15:00.39] Starting...
Cloning into '/tmp/with_clonefa0514d'...
done.
warning: remote HEAD refers to nonexistent ref, unable to checkout.

HEAD is now at 454caa9 Use jbuilder
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.316 MB
Step 1/30 : FROM ocaml/opam-dev@sha256:337fd0f78b182a12da3f66d9d5ca075dbb79df414fc01d6a0aee99ffeb35552a
sha256:337fd0f78b182a12da3f66d9d5ca075dbb79df414fc01d6a0aee99ffeb35552a: Pulling from ocaml/opam-dev
Digest: sha256:337fd0f78b182a12da3f66d9d5ca075dbb79df414fc01d6a0aee99ffeb35552a
Status: Image is up to date for ocaml/opam-dev@sha256:337fd0f78b182a12da3f66d9d5ca075dbb79df414fc01d6a0aee99ffeb35552a
 ---> 9107a2254d1d
Step 2/30 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 90b67f82c489
Step 3/30 : RUN sudo apk add tzdata aspcud gmp-dev perl
 ---> Using cache
 ---> fff031e34a88
Step 4/30 : RUN opam pin add hvsock.0.14.0 -n https://github.com/mirage/ocaml-hvsock.git#88397c37a910c61507a9655ed8413c1692294da0
 ---> Using cache
 ---> a0c3d8deec46
Step 5/30 : RUN opam pin add irmin.1.1.0 -n https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0
 ---> Using cache
 ---> 3bf883894542
Step 6/30 : RUN opam pin add irmin-git.1.1.0 -n https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0
 ---> Using cache
 ---> 1ccc0ba0bf22
Step 7/30 : RUN opam pin add -yn protocol-9p 'https://github.com/talex5/ocaml-9p.git#ping-mirage-3'
 ---> Using cache
 ---> 9e6264aef747
Step 8/30 : RUN opam depext -ui lwt inotify alcotest conf-libev lambda-term asl win-eventlog camlzip irmin-watcher mtime mirage-flow conduit hvsock cohttp prometheus-app git irmin cmdliner protocol-9p channel rresult win-error named-pipe
 ---> Using cache
 ---> 07ae063a9513
Step 9/30 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> 173ef7632cca
Step 10/30 : RUN opam config exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> 6624c133a8bd
Step 11/30 : COPY datakit.opam /home/opam/src/datakit/
 ---> f2e54cb07c68
Removing intermediate container fb5ac9c7ce2d
Step 12/30 : COPY datakit-client.opam /home/opam/src/datakit/datakit-client.opam
 ---> 475c4d1348e7
Removing intermediate container 467375d81731
Step 13/30 : COPY datakit-server.opam /home/opam/src/datakit/datakit-server.opam
 ---> 3903a7ce18bc
Error removing intermediate container 19a82a0217e8: Driver aufs failed to remove root filesystem 19a82a0217e8763d8ea986c4e9f89f7cca4ac48204593766b88f7eecff1d3263: rename /var/lib/docker/aufs/mnt/d96d2d484c48a9b592d989e96b1feff482b01f6e94f07c96587ca999aeab7386 /var/lib/docker/aufs/mnt/d96d2d484c48a9b592d989e96b1feff482b01f6e94f07c96587ca999aeab7386-removing: device or resource busy
Step 14/30 : COPY datakit-github.opam /home/opam/src/datakit/datakit-github.opam
 ---> 844ee011b2a9
Error removing intermediate container 19a82a0217e8: No such container: 19a82a0217e8763d8ea986c4e9f89f7cca4ac48204593766b88f7eecff1d3263
Step 15/30 : RUN opam pin add datakit-server.dev /home/opam/src/datakit -yn &&     opam pin add datakit-client.dev /home/opam/src/datakit -yn &&     opam pin add datakit.dev /home/opam/src/datakit -yn        &&     opam pin add datakit-github.dev /home/opam/src/datakit -yn
 ---> Running in 7c881243117a
[datakit-server.dev: rsync]
[datakit-server.dev] synchronised from file:///home/opam/src/datakit
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-server/datakit-server.opam from 1.2 to 2.0~beta
[0mdatakit-server is now pinned to file:///home/opam/src/datakit (version dev)
[datakit-client.dev: rsync]
[datakit-client.dev] synchronised from file:///home/opam/src/datakit
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-client/datakit-client.opam from 1.2 to 2.0~beta
[0mdatakit-client is now pinned to file:///home/opam/src/datakit (version dev)
[datakit.dev: rsync]
[datakit.dev] synchronised from file:///home/opam/src/datakit
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit/datakit.opam from 1.2 to 2.0~beta
[0mdatakit is now pinned to file:///home/opam/src/datakit (version dev)
[datakit-github.dev: rsync]
[datakit-github.dev] synchronised from file:///home/opam/src/datakit
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-github/datakit-github.opam from 1.2 to 2.0~beta
[0mdatakit-github is now pinned to file:///home/opam/src/datakit (version dev)
 ---> 0d548b6118ac
Error removing intermediate container 19a82a0217e8: No such container: 19a82a0217e8763d8ea986c4e9f89f7cca4ac48204593766b88f7eecff1d3263
Step 16/30 : RUN opam depext -y datakit
 ---> Running in 6d643e07859a
# Detecting depexts using flags: x86_64 linux alpine
# The following system packages are needed:
#  - linux-headers
#  - m4
#  - ncurses-dev
#  - openssl-dev
#  - pcre-dev
#  - pkgconfig
#  - zlib-dev
linux-headers
m4
ncurses-dev
openssl-dev
pcre-dev
pkgconf
zlib-dev
# All required OS packages found.
 ---> 1914248aec78
Error removing intermediate container 19a82a0217e8: No such container: 19a82a0217e8763d8ea986c4e9f89f7cca4ac48204593766b88f7eecff1d3263
Step 17/30 : RUN opam install -y --deps-only datakit-client datakit-server
 ---> Running in df3a0a4010f2

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-client.dev] no changes from file:///home/opam/src/datakit
[datakit-server.dev] no changes from file:///home/opam/src/datakit

Nothing to do.
# Run eval `opam env` to update the current shell environment
 ---> ded6ac2cc244
Removing intermediate container 7c881243117a
Removing intermediate container 6d643e07859a
Error removing intermediate container df3a0a4010f2: Driver aufs failed to remove root filesystem df3a0a4010f25e2638357d24183acf5b10dc6ca8a88de7237f43910f7bfb5545: rename /var/lib/docker/aufs/mnt/f00d28f81ad2e47b83af1dcac5c3f6a5a58995725686431e35976852618f1ab1 /var/lib/docker/aufs/mnt/f00d28f81ad2e47b83af1dcac5c3f6a5a58995725686431e35976852618f1ab1-removing: device or resource busy
Step 18/30 : COPY . /home/opam/src/datakit
 ---> 26d2b201e5b4
Error removing intermediate container df3a0a4010f2: No such container: df3a0a4010f25e2638357d24183acf5b10dc6ca8a88de7237f43910f7bfb5545
Step 19/30 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in e5c266469a17
 ---> d5e212548b22
Error removing intermediate container e5c266469a17: Driver aufs failed to remove root filesystem e5c266469a17b028d68468e97168c903ca68cce657fec770cf072a1c89b3704f: rename /var/lib/docker/aufs/mnt/4e677715ad345c5866b2af2d7890e0683f486685d346f1da92ef4aa806710b87 /var/lib/docker/aufs/mnt/4e677715ad345c5866b2af2d7890e0683f486685d346f1da92ef4aa806710b87-removing: device or resource busy
Step 20/30 : RUN cd /home/opam/src/datakit &&     scripts/watermark.sh &&     git status --porcelain
 ---> Running in b2668b3f20da
 M src/version.ml
 ---> 11f366b505ed
Error removing intermediate container 19a82a0217e8: No such container: 19a82a0217e8763d8ea986c4e9f89f7cca4ac48204593766b88f7eecff1d3263
Step 21/30 : RUN opam install datakit-client datakit-github alcotest
 ---> Running in e074f6ef428f

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-client.dev] synchronised from file:///home/opam/src/datakit
[datakit-github.dev] synchronised from file:///home/opam/src/datakit

[91m[NOTE] Package alcotest is already installed (current version is 0.7.2).
[0mThe following actions will be performed:
  - install datakit-client dev*
  - install datakit-github dev*
===== 2 to install =====
[datakit-client.dev] synchronised from file:///home/opam/src/datakit
[datakit-github.dev] synchronised from file:///home/opam/src/datakit

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-client.dev
[91m[ERROR] The compilation of datakit-github failed at "jbuilder build -p datakit-github -j 1".

#=== ERROR while compiling datakit-github.dev =================================#
# command              jbuilder build -p datakit-github -j 1
# path                 /home/opam/.opam/default/.opam-switch/build/datakit-github.dev
# exit-code            1
# env-file             /home/opam/.opam/log/datakit-github-7-865888.env
# output-file          /home/opam/.opam/log/datakit-github-7-865888.out
### output ###
#     ocamldep src/datakit-github/datakit_github.depends.ocamldep-output
#     ocamldep src/datakit-github/datakit_github.dependsi.ocamldep-output
#       ocamlc src/datakit-github/datakit_github.{cmi,cmti}
#       ocamlc src/datakit-github/datakit_github.{cmo,cmt}
#     ocamlopt src/datakit-github/datakit_github.{cmx,o}
#       ocamlc src/datakit-github/datakit_github_conv.{cmi,cmti} (exit 2)
# (cd _build/default && /usr/bin/ocamlc.opt -w -40 -g -bin-annot -I /home/opam/.opam/default/lib/asetmap -I /home/opam/.opam/default/lib/astring -I /home/opam/.opam/default/lib/bytes -I /home/opam/.opam/default/lib/datakit-client -I /home/opam/.opam/default/lib/fmt -I /home/opam/.opam/default/lib/logs -I /home/opam/.opam/default/lib/lwt -I /home/opam/.opam/default/lib/re -I /home/opam/.opam/default/lib/result -I /home/opam/.opam/default/lib/sexplib -I /home/opam/.opam/default/lib/sexplib/0 -I /home/opam/.opam/default/lib/stringext -I /home/opam/.opam/default/lib/uchar -I /home/opam/.opam/default/lib/uri -I /usr/lib/ocaml -no-alias-deps -I src/datakit-github -o src/datakit-github/datakit_github_conv.cmi -c -intf src/datakit-github/datakit_github_conv.mli)
# File "src/datakit-github/datakit_github_conv.mli", line 7, characters 17-33:
# Error: Unbound module Datakit_S

[0m

=-=- Error report -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
+- The following actions failed
| - build datakit-github dev
+- 
+- The following changes have been performed
| - install datakit-client dev
+- 
# Run eval `opam env` to update the current shell environment
[91m
The former state can be restored with:
    opam switch import "/home/opam/.opam/default/.opam-switch/backup/state-20170426150132.export"
[0mThe command '/bin/sh -c opam install datakit-client datakit-github alcotest' returned a non-zero code: 4
[2017-04-26 15:01.47] Failed: Command "docker" "build" "--pull" "-f" "Dockerfile" "." exited with status 4
