=== Docker build Dockerfile.github
[2017-06-08 17:31.42] Starting...
Cloning into '/tmp/with_clone1b568ffd'...
done.
warning: remote HEAD refers to nonexistent ref, unable to checkout.

HEAD is now at d60dbb1 github: make user an abstract type
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.685 MBSending build context to Docker daemon 7.242 MBSending build context to Docker daemon 7.799 MBSending build context to Docker daemon 8.119 MB
Step 1/30 : FROM ocaml/opam-dev@sha256:1dd4440b3e5f182f705cb5a74f9d4e860c2842b45ed72c199de89a894d13f522
sha256:1dd4440b3e5f182f705cb5a74f9d4e860c2842b45ed72c199de89a894d13f522: Pulling from ocaml/opam-dev
Digest: sha256:1dd4440b3e5f182f705cb5a74f9d4e860c2842b45ed72c199de89a894d13f522
Status: Image is up to date for ocaml/opam-dev@sha256:1dd4440b3e5f182f705cb5a74f9d4e860c2842b45ed72c199de89a894d13f522
 ---> f03bf6a81395
Step 2/30 : RUN git -C /home/opam/opam-repository fetch origin &&     git -C /home/opam/opam-repository reset 79046b8ab --hard &&     opam update -u
 ---> Using cache
 ---> 834afef17701
Step 3/30 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> c4322ca77791
Step 4/30 : RUN sudo apk add tzdata aspcud
 ---> Using cache
 ---> b636b99cfd07
Step 5/30 : RUN opam depext -ui lwt inotify alcotest conf-libev lambda-term cmdliner     github protocol-9p rresult prometheus-app asl win-eventlog mtime hex     github-hooks hvsock irmin-watcher git irmin
 ---> Using cache
 ---> 3c49818f6ae5
Step 6/30 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> e1bd80b0b228
Step 7/30 : RUN opam config exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> 113d6030554b
Step 8/30 : COPY datakit.opam /home/opam/src/datakit/datakit.opam
 ---> Using cache
 ---> 86a950d73c99
Step 9/30 : COPY datakit-client.opam /home/opam/src/datakit/datakit-client.opam
 ---> Using cache
 ---> 7f0d265516b4
Step 10/30 : COPY datakit-client-9p.opam /home/opam/src/datakit/datakit-client-9p.opam
 ---> Using cache
 ---> b41cfac6cb98
Step 11/30 : COPY datakit-client-git.opam /home/opam/src/datakit/datakit-client-git.opam
 ---> Using cache
 ---> aa11575b6aab
Step 12/30 : COPY datakit-server.opam /home/opam/src/datakit/datakit-server.opam
 ---> Using cache
 ---> dd80cc0313ed
Step 13/30 : COPY datakit-server-9p.opam /home/opam/src/datakit/datakit-server-9p.opam
 ---> Using cache
 ---> 9fd8601e387a
Step 14/30 : COPY datakit-github.opam /home/opam/src/datakit/datakit-github.opam
 ---> Using cache
 ---> ddcb6a84b832
Step 15/30 : COPY datakit-bridge-github.opam /home/opam/src/datakit/datakit-bridge-github.opam
 ---> Using cache
 ---> 14583546c2fc
Step 16/30 : RUN opam pin add datakit.dev /home/opam/src/datakit -yn &&     opam pin add datakit-server.dev /home/opam/src/datakit -yn &&     opam pin add datakit-server-9p.dev /home/opam/src/datakit -yn &&     opam pin add datakit-client.dev /home/opam/src/datakit -yn &&     opam pin add datakit-client-9p.dev /home/opam/src/datakit -yn &&     opam pin add datakit-client-git.dev /home/opam/src/datakit -yn &&     opam pin add datakit-github.dev /home/opam/src/datakit -yn &&     opam pin add datakit-bridge-github.dev /home/opam/src/datakit -yn
 ---> Using cache
 ---> 116244a7a978
Step 17/30 : COPY . /home/opam/src/datakit
 ---> d937746d7bbb
Error removing intermediate container 0b5d57d570d0: Driver aufs failed to remove root filesystem 0b5d57d570d0fd7a5f2210d96f6579243e021a167d8cd56d80947de1786a4b11: rename /var/lib/docker/aufs/mnt/28c1bd82dfd97e4072d3e387941f57f5f9a916d3ef6e5748e4dd954c50fd7912 /var/lib/docker/aufs/mnt/28c1bd82dfd97e4072d3e387941f57f5f9a916d3ef6e5748e4dd954c50fd7912-removing: device or resource busy
Step 18/30 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in c19fe5e03a6e
 ---> 6a58cc98d924
Error removing intermediate container 0b5d57d570d0: No such container: 0b5d57d570d0fd7a5f2210d96f6579243e021a167d8cd56d80947de1786a4b11
Step 19/30 : RUN cd /home/opam/src/datakit &&     scripts/watermark.sh &&     git status --porcelain
 ---> Running in 4abf897c57d5
 M src/version.ml
 ---> edad43ee1762
Error removing intermediate container 0b5d57d570d0: No such container: 0b5d57d570d0fd7a5f2210d96f6579243e021a167d8cd56d80947de1786a4b11
Step 20/30 : RUN opam install datakit
 ---> Running in 604bd7518f10

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit.dev] synchronised from file:///home/opam/src/datakit

The following actions will be performed:
  - install protocol-9p-unix  0.11.0                            [required by datakit]
  - install irmin-git         1.2.0                             [required by datakit]
  - install datakit-server    dev*                              [required by datakit-server-9p]
  - install irmin-mem         1.2.0                             [required by datakit]
  - install datakit-server-9p dev*                              [required by datakit]
  - install datakit           dev*
===== 6 to install =====

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-server-9p.dev] synchronised from file:///home/opam/src/datakit
[irmin-git.1.2.0] found in cache
[datakit.dev] synchronised from file:///home/opam/src/datakit
[irmin-mem.1.2.0] found in cache
[datakit-server.dev] synchronised from file:///home/opam/src/datakit
[protocol-9p-unix.0.11.0] found in cache

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[91m[ERROR] The compilation of datakit-server failed at "jbuilder build -p datakit-server -j 1".
[0m-> installed irmin-git.1.2.0
-> installed irmin-mem.1.2.0
-> installed protocol-9p-unix.0.11.0
[91m
#=== ERROR while compiling datakit-server.dev =================================#
# command              jbuilder build -p datakit-server -j 1
# path                 /home/opam/.opam/default/.opam-switch/build/datakit-server.dev
# exit-code            1
# env-file             /home/opam/.opam/log/datakit-server-7-0a5907.env
# output-file          /home/opam/.opam/log/datakit-server-7-0a5907.out
### output ###
# File "ci/src/jbuild", line 12, characters 15-94:
# Error: Unknown constructor per_module

[0m

=-=- Error report -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
+- The following actions were aborted
| - install datakit           dev
| - install datakit-server-9p dev
+- 
+- The following actions failed
| - build datakit-server dev
+- 
+- The following changes have been performed
| - install irmin-git        1.2.0
| - install irmin-mem        1.2.0
| - install protocol-9p-unix 0.11.0
+- 
# Run eval `opam env` to update the current shell environment
[91m
The former state can be restored with:
    opam switch import "/home/opam/.opam/default/.opam-switch/backup/state-20170608173208.export"
[0mThe command '/bin/sh -c opam install datakit' returned a non-zero code: 4
[2017-06-08 17:32.26] Failed: Command "docker" "build" "--pull" "-f" "Dockerfile.github" "." exited with status 4
