=== Docker build Dockerfile.ci
[2017-06-01 11:12.21] Starting...
Cloning into '/tmp/with_clone1cc9c5c'...
done.
warning: remote HEAD refers to nonexistent ref, unable to checkout.

HEAD is now at c1595b3 Merge pull request #583 from samoht/datakit
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.685 MBSending build context to Docker daemon 7.242 MBSending build context to Docker daemon 7.778 MBSending build context to Docker daemon 7.778 MB
Step 1/24 : FROM ocaml/opam-dev@sha256:64dc0522876ebbd27b186e3ba955ae5ab864ace580add5b0d1abb8715bdf1bbe
sha256:64dc0522876ebbd27b186e3ba955ae5ab864ace580add5b0d1abb8715bdf1bbe: Pulling from ocaml/opam-dev
Digest: sha256:64dc0522876ebbd27b186e3ba955ae5ab864ace580add5b0d1abb8715bdf1bbe
Status: Image is up to date for ocaml/opam-dev@sha256:64dc0522876ebbd27b186e3ba955ae5ab864ace580add5b0d1abb8715bdf1bbe
 ---> 477ad7d223ad
Step 2/24 : RUN git -C /home/opam/opam-repository fetch origin &&     git -C /home/opam/opam-repository reset origin/master --hard &&     git -C /home/opam/opam-repository rev-parse HEAD &&     opam update -u
 ---> Using cache
 ---> c69e233216dc
Step 3/24 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 76a9b29cb29b
Step 4/24 : RUN sudo apk add tzdata aspcud
 ---> Using cache
 ---> 51de971a728f
Step 5/24 : RUN opam pin add git.dev --dev -n
 ---> Using cache
 ---> 52ddb6c32f2b
Step 6/24 : RUN opam pin add git-unix.dev --dev -n
 ---> Using cache
 ---> 8dd044677942
Step 7/24 : RUN opam pin add irmin.1.2.0 -n https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821
 ---> Using cache
 ---> c73aae43c720
Step 8/24 : RUN opam pin add irmin-mem.1.2.0 -n https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821
 ---> Using cache
 ---> 144ca572117f
Step 9/24 : RUN opam pin add irmin-fs.1.2.0 -n https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821
 ---> Using cache
 ---> abdcb9b7a984
Step 10/24 : RUN opam pin add irmin-http.1.2.0 -n https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821
 ---> Using cache
 ---> 2150dd7516bb
Step 11/24 : RUN opam pin add irmin-git.1.2.0 -n https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821
 ---> Using cache
 ---> d488b8d82fb8
Step 12/24 : RUN opam pin add irmin-unix.1.2.0 -n https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821
 ---> Using cache
 ---> 3fe6a4915d56
Step 13/24 : RUN opam pin add protocol-9p-unix.dev --dev -n
 ---> Using cache
 ---> 8923eba1dee5
Step 14/24 : RUN opam depext -i asl win-eventlog alcotest mtime mirage-flow hvsock     git irmin irmin-unix lwt protocol-9p-unix tyxml redis multipart-form-data     pbkdf tls prometheus-app github git session irmin irmin-unix cmdliner     webmachine alcotest
 ---> Using cache
 ---> 8ff2e89077ac
Step 15/24 : ADD . /home/opam/datakit
 ---> 226c94beb90c
Error removing intermediate container a3e0d757e9cf: Driver aufs failed to remove root filesystem a3e0d757e9cf601cdd267312f63cdd1f61baa0b1cc763c032d98129a6221ef02: rename /var/lib/docker/aufs/mnt/018b426ef6c53a98628c8b24028af7c17b54a5a6a100d6beb41466529fb19507 /var/lib/docker/aufs/mnt/018b426ef6c53a98628c8b24028af7c17b54a5a6a100d6beb41466529fb19507-removing: device or resource busy
Step 16/24 : RUN sudo chown opam /home/opam/datakit
 ---> Running in a4a612c79f95
 ---> d6e3a88062cb
Error removing intermediate container a3e0d757e9cf: No such container: a3e0d757e9cf601cdd267312f63cdd1f61baa0b1cc763c032d98129a6221ef02
Step 17/24 : RUN opam pin add -k git datakit-client.dev /home/opam/datakit -y
 ---> Running in 5b8482aa0ab6
[datakit-client.dev: git]
[datakit-client.dev: git]
[datakit-client.dev: git]
[datakit-client.dev: git]
[datakit-client.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-client/datakit-client.opam from 1.2 to 2.0~beta
[0mdatakit-client is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - install datakit-client dev*
[datakit-client.dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-client.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> 57485495cf0f
Error removing intermediate container a3e0d757e9cf: No such container: a3e0d757e9cf601cdd267312f63cdd1f61baa0b1cc763c032d98129a6221ef02
Step 18/24 : RUN opam pin add -k git datakit-client-9p.dev /home/opam/datakit -y
 ---> Running in ab3c36ba3f84
Package datakit-client-9p does not exist, create as a NEW package ? [Y/n] y
[datakit-client-9p.dev: git]
[datakit-client-9p.dev: git]
[datakit-client-9p.dev: git]
[datakit-client-9p.dev: git]
[datakit-client-9p.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-client-9p/datakit-client-9p.opam from 1.2 to 2.0~beta
[0mdatakit-client-9p is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - install datakit-client-9p dev*
[datakit-client-9p.dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-client-9p.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> da405c723a7c
Error removing intermediate container a3e0d757e9cf: No such container: a3e0d757e9cf601cdd267312f63cdd1f61baa0b1cc763c032d98129a6221ef02
Step 19/24 : RUN opam pin add -k git datakit-server.dev /home/opam/datakit -y
 ---> Running in 4e593e631aab
[datakit-server.dev: git]
[datakit-server.dev: git]
[datakit-server.dev: git]
[datakit-server.dev: git]
[datakit-server.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-server/datakit-server.opam from 1.2 to 2.0~beta
[0mdatakit-server is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - install datakit-server dev*
[datakit-server.dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-server.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> 8b56466c02a4
Error removing intermediate container a3e0d757e9cf: No such container: a3e0d757e9cf601cdd267312f63cdd1f61baa0b1cc763c032d98129a6221ef02
Step 20/24 : RUN opam pin add -k git datakit-server-9p.dev /home/opam/datakit -y
 ---> Running in c1a9aa360394
Package datakit-server-9p does not exist, create as a NEW package ? [Y/n] y
[datakit-server-9p.dev: git]
[datakit-server-9p.dev: git]
[datakit-server-9p.dev: git]
[datakit-server-9p.dev: git]
[datakit-server-9p.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-server-9p/datakit-server-9p.opam from 1.2 to 2.0~beta
[0mdatakit-server-9p is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - install datakit-server-9p dev*
[datakit-server-9p.dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-server-9p.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> a637db3f86ed
Removing intermediate container 4e593e631aab
Removing intermediate container c1a9aa360394
Error removing intermediate container a3e0d757e9cf: No such container: a3e0d757e9cf601cdd267312f63cdd1f61baa0b1cc763c032d98129a6221ef02
Step 21/24 : RUN opam pin add -k git datakit-github.dev /home/opam/datakit -y
 ---> Running in bb1db588294e
[datakit-github.dev: git]
[datakit-github.dev: git]
[datakit-github.dev: git]
[datakit-github.dev: git]
[datakit-github.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-github/datakit-github.opam from 1.2 to 2.0~beta
[0mdatakit-github is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - install datakit-github dev*
[datakit-github.dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-github.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> 07f2c7e46819
Removing intermediate container 5b8482aa0ab6
Removing intermediate container ab3c36ba3f84
Error removing intermediate container bb1db588294e: Driver aufs failed to remove root filesystem bb1db588294e646ead8f69edfe6d41530b5e9132a13b8f2e6b9e2f11fd718b01: rename /var/lib/docker/aufs/mnt/7a8d6df3803bac159c85ad936fa7a655ebb3cfbd5c703ca6929c6177578da027 /var/lib/docker/aufs/mnt/7a8d6df3803bac159c85ad936fa7a655ebb3cfbd5c703ca6929c6177578da027-removing: device or resource busy
Step 22/24 : RUN opam pin add -k git datakit.dev /home/opam/datakit -y
 ---> Running in 2be9d0ff327c
[datakit.dev: git]
[datakit.dev: git]
[datakit.dev: git]
[datakit.dev: git]
[datakit.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit/datakit.opam from 1.2 to 2.0~beta
[0mdatakit is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - install irmin-mem 1.2.0*                                    [required by datakit]
  - install datakit   dev*
===== 2 to install =====
[datakit.dev] synchronised from git+file:///home/opam/datakit#master
[irmin-mem.1.2.0] synchronised from git+https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed irmin-mem.1.2.0
-> installed datakit.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> 70e67f0862a3
Error removing intermediate container bb1db588294e: No such container: bb1db588294e646ead8f69edfe6d41530b5e9132a13b8f2e6b9e2f11fd718b01
Step 23/24 : RUN opam pin add -k git datakit-ci.dev /home/opam/datakit -yt
 ---> Running in 89acf8ad5e59
[datakit-ci.dev: git]
[datakit-ci.dev: git]
[datakit-ci.dev: git]
[datakit-ci.dev: git]
[datakit-ci.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-ci/datakit-ci.opam from 1.2 to 2.0~beta
[0mdatakit-ci is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - install   redis-lwt  0.3.5                                  [required by datakit-ci]
  - recompile session    0.3.2                                  [uses redis-lwt]
  - install   datakit-ci dev*
===== 2 to install | 1 to recompile =====

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[redis-lwt.0.3.5] found in cache
[session.0.3.2] found in cache
[datakit-ci.dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> removed   session.0.3.2
-> installed redis-lwt.0.3.5
-> installed session.0.3.2
-> installed datakit-ci.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> b7125f3f32e0
Error removing intermediate container a3e0d757e9cf: No such container: a3e0d757e9cf601cdd267312f63cdd1f61baa0b1cc763c032d98129a6221ef02
Step 24/24 : VOLUME /secrets
 ---> Running in 667fd33a1fec
 ---> 908493a7183e
Error removing intermediate container a3e0d757e9cf: No such container: a3e0d757e9cf601cdd267312f63cdd1f61baa0b1cc763c032d98129a6221ef02
Successfully built 908493a7183e
[2017-06-01 11:15.03] Success
