=== Docker build Dockerfile.bridge-local-git
[2017-03-13 10:46.40] Starting...
Cloning into '/tmp/with_clone29c9f781'...
done.
HEAD is now at a68eee0 cmdliner: restrict to < 1.0
[2017-03-13 10:46.40] Rewrite Dockerfile's first line to:
FROM sha256:e6d7feafa4cd29d32a17b3eab5e5e7e533b6b9f082ff1403150c57cdc882c93f
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.685 MBSending build context to Docker daemon 7.242 MBSending build context to Docker daemon  7.53 MB
Step 1/17 : FROM sha256:e6d7feafa4cd29d32a17b3eab5e5e7e533b6b9f082ff1403150c57cdc882c93f
 ---> e6d7feafa4cd
Step 2/17 : RUN opam pin add github --dev -n
 ---> Running in fa4860c440ed
github is now git-pinned to https://github.com/mirage/ocaml-github.git

[github: git]
[github: git]
[github: git]
[github: git]
[github: git]
[github: git]
[github] https://github.com/mirage/ocaml-github.git updated

 ---> 25d670b744bf
Removing intermediate container fa4860c440ed
Step 3/17 : RUN opam pin add datakit-github.dev /home/opam/src/datakit -n
 ---> Running in f5cfbedf418e
datakit-github is now path-pinned to /home/opam/src/datakit

[datakit-github: local]
[datakit-github] /home/opam/src/datakit/ synchronized

 ---> 5803bfe71be7
Removing intermediate container f5cfbedf418e
Step 4/17 : RUN opam depext datakit-github && opam install datakit-github --deps
 ---> Running in 7800c6e02f92
# Detecting depexts using flags: x86_64 linux alpine
# The following system packages are needed:
#  - m4
#  - ncurses-dev
#  - pkgconfig
m4
ncurses-dev
pkgconf
# All required OS packages found.

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-github: local] Command started
[datakit-github] /home/opam/src/datakit/ already up-to-date
The following actions will be performed:
  - install asetmap 0.8.1

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[asetmap: http] Command started
[asetmap: http] Command started
[asetmap.0.8.1] http://erratique.ch/software/asetmap/releases/asetmap-0.8.1.tbz downloaded

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[asetmap: ocaml build] Command started
-> installed asetmap.0.8.1
Done.
 ---> 8b5ede5a8a12
Removing intermediate container 7800c6e02f92
Step 5/17 : COPY datakit-bridge-local-git.opam /home/opam/src/datakit/datakit-bridge-local-git.opam
 ---> 34f4409587f8
Removing intermediate container c7f2dfb2c8b4
Step 6/17 : RUN opam pin add datakit-bridge-local-git.dev /home/opam/src/datakit -n
 ---> Running in 1fb9c6d0d03a
datakit-bridge-local-git is now path-pinned to /home/opam/src/datakit

[datakit-bridge-local-git: local]
[datakit-bridge-local-git] /home/opam/src/datakit/ synchronized
[datakit-bridge-local-git] Installing new package description from
/home/opam/src/datakit

 ---> a860c31c7af9
Removing intermediate container 1fb9c6d0d03a
Step 7/17 : RUN opam depext datakit-bridge-local-git && opam install datakit-bridge-local-git --deps
 ---> Running in 1bf6dade7427
# Detecting depexts using flags: x86_64 linux alpine
# The following system packages are needed:
#  - gmp-dev
#  - linux-headers
#  - m4
#  - ncurses-dev
#  - openssl-dev
#  - perl
#  - pkgconfig
#  - zlib-dev
m4
ncurses-dev
pkgconf
# The following new OS packages need to be installed: gmp-dev linux-headers openssl-dev perl zlib-dev
The following command needs to be run through "sudo":
    apk add gmp-dev linux-headers openssl-dev perl zlib-dev
(1/8) Installing libgmpxx (6.1.1-r0)
(2/8) Installing gmp-dev (6.1.1-r0)
(3/8) Installing linux-headers (4.4.6-r1)
(4/8) Installing zlib-dev (1.2.8-r2)
(5/8) Installing libcrypto1.0 (1.0.2k-r0)
(6/8) Installing libssl1.0 (1.0.2k-r0)
(7/8) Installing openssl-dev (1.0.2k-r0)
(8/8) Installing perl (5.24.0-r0)
Executing busybox-1.25.1-r0.trigger
OK: 654 MiB in 101 packages
# OS packages installation successful

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-bridge-local-git: local] Command started
[datakit-bridge-local-git] /home/opam/src/datakit/ already up-to-date
The following actions will be performed:
  - install conf-perl       1             
  - install camlzip         1.07          
  - install bin_prot        113.33.00+4.03
  - install mtime           0.8.4         
  - install uchar           0.0.1         
  - install mirage-no-solo5 1             
  - install magic-mime      1.0.0         
  - install crunch          2.0.0         
  - install cpuid           0.1.0         
  - install ipaddr          2.7.2         
  - install base64          2.1.2         
  - install mstruct         1.3.2         
  - install datakit-github  dev*          
  - install mirage-no-xen   1             
  - install conf-gmp        1             
  - install hex             1.0.0         
  - install fieldslib       113.24.00     
  - install ocamlgraph      1.8.7         
  - install uutf            1.0.1         
  - install conduit         0.15.0        
  - install zarith          1.4.1         
  - install ppx_fields_conv 113.33.00+4.03
  - install jsonm           1.0.1         
  - install nocrypto        0.5.4         
  - install cohttp          0.22.0        
  - install ezjsonm         0.4.3         
  - install git             1.9.3         
  - install mirage-tc       0.3.0         
  - install git-unix        1.7.1         
  - install irmin           0.11.1        
  - install irmin-unix      0.9.9         
===== 31 to install =====

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[base64: http] Command started
[bin_prot: http] Command started
[camlzip: http] Command started
[bin_prot: http] Command started
[bin_prot.113.33.00+4.03] https://ocaml.janestreet.com/ocaml-core/113.33/files/bin_prot-113.33.00+4.03.tar.gz downloaded
[cohttp: http] Command started
[base64: http] Command started
[base64.2.1.2] https://github.com/mirage/ocaml-base64/releases/download/v2.1.2/base64-2.1.2.tbz downloaded
[conduit: http] Command started
[camlzip: http] Command started
[camlzip.1.07] https://github.com/xavierleroy/camlzip/archive/rel107.zip downloaded
[cpuid: http] Command started
[cpuid: http] Command started
[cpuid.0.1.0] https://github.com/pqwy/cpuid/releases/download/v0.1.0/cpuid-0.1.0.tbz downloaded
[crunch: http] Command started
[conduit: http] Command started
[conduit.0.15.0] https://github.com/mirage/ocaml-conduit/archive/v0.15.0.tar.gz downloaded
[datakit-github: local] Command started
[datakit-github.dev] /home/opam/src/datakit/ already up-to-date
[ezjsonm: http] Command started
[cohttp: http] Command started
[cohttp.0.22.0] https://github.com/mirage/ocaml-cohttp/archive/v0.22.0.tar.gz downloaded
[fieldslib: http] Command started
[fieldslib: http] Command started
[fieldslib.113.24.00] https://ocaml.janestreet.com/ocaml-core/113.24/files/fieldslib-113.24.00.tar.gz downloaded
[git: http] Command started
[crunch: http] Command started
[crunch.2.0.0] https://github.com/mirage/ocaml-crunch/releases/download/2.0.0/crunch-2.0.0.tbz downloaded
[hex: http] Command started
[ezjsonm: http] Command started
[ezjsonm.0.4.3] https://github.com/mirage/ezjsonm/archive/0.4.3.tar.gz downloaded
[ipaddr: http] Command started
[hex: http] Command started
[hex.1.0.0] https://github.com/mirage/ocaml-hex/archive/1.0.0.tar.gz downloaded
[irmin: http] Command started
[ipaddr: http] Command started
[ipaddr.2.7.2] https://github.com/mirage/ocaml-ipaddr/releases/download/2.7.2/ipaddr-2.7.2.tbz downloaded
[jsonm: http] Command started
[git: http] Command started
[git.1.9.3] https://github.com/mirage/ocaml-git/releases/download/1.9.3/git-1.9.3.tbz downloaded
[magic-mime: http] Command started
[jsonm: http] Command started
[jsonm.1.0.1] http://erratique.ch/software/jsonm/releases/jsonm-1.0.1.tbz downloaded
[mirage-tc: http] Command started
[magic-mime: http] Command started
[magic-mime.1.0.0] https://github.com/mirage/ocaml-magic-mime/archive/v1.0.0.tar.gz downloaded
[mstruct: http] Command started
[mirage-tc: http] Command started
[mirage-tc.0.3.0] https://github.com/mirage/mirage-tc/archive/0.3.0.tar.gz downloaded
[mtime: http] Command started
[mtime: http] Command started
[mtime.0.8.4] http://erratique.ch/software/mtime/releases/mtime-0.8.4.tbz downloaded
[nocrypto: http] Command started
[irmin: http] Command started
[irmin.0.11.1] https://github.com/mirage/irmin/archive/0.11.1.tar.gz downloaded
[ocamlgraph: http] Command started
[ocamlgraph: http] Command started
[ocamlgraph.1.8.7] http://ocamlgraph.lri.fr/download/ocamlgraph-1.8.7.tar.gz downloaded
[ppx_fields_conv: http] Command started
[mstruct: http] Command started
[mstruct.1.3.2] https://github.com/mirage/ocaml-mstruct/archive/1.3.2.tar.gz downloaded
[uchar: http] Command started
[ppx_fields_conv: http] Command started
[ppx_fields_conv.113.33.00+4.03] https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_fields_conv-113.33.00+4.03.tar.gz downloaded
[uutf: http] Command started
[uutf: http] Command started
[uutf.1.0.1] http://erratique.ch/software/uutf/releases/uutf-1.0.1.tbz downloaded
[zarith: http] Command started
[uchar: http] Command started
[uchar.0.0.1] https://github.com/ocaml/uchar/releases/download/v0.0.1/uchar-0.0.1.tbz downloaded
[zarith: http] Command started
[zarith.1.4.1] https://forge.ocamlcore.org/frs/download.php/1574/zarith-1.4.1.tgz downloaded
[nocrypto: http] Command started
[nocrypto.0.5.4] https://github.com/mirleft/ocaml-nocrypto/releases/download/v0.5.4/nocrypto-0.5.4.tbz downloaded

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[base64: ocaml build] Command started
[bin_prot: ./configure] Command started
[camlzip: make all] Command started
[conf-gmp: sh] Command started
-> installed conf-gmp.1
[conf-perl: perl] Command started
-> installed conf-perl.1
[cpuid: ocaml build] Command started
-> installed base64.2.1.2
[crunch: ocaml build] Command started
[camlzip: make allopt] Command started
[camlzip: make install-findlib] Command started
-> installed camlzip.1.07
[datakit-github: ocaml build] Command started
-> installed crunch.2.0.0
[fieldslib: ./configure] Command started
-> installed cpuid.0.1.0
[hex: ./configure] Command started
[bin_prot: make] Command started
[fieldslib: make] Command started
-> installed datakit-github.dev
[ipaddr: ocaml build] Command started
[hex: make] Command started
-> installed fieldslib.113.24.00
[magic-mime: ./configure] Command started
-> installed ipaddr.2.7.2
[conduit: ./configure] Command started
[conduit: make] Command started
[hex: make install] Command started
-> installed bin_prot.113.33.00+4.03
-> installed mirage-no-solo5.1
-> installed mirage-no-xen.1
[mstruct: ./configure] Command started
[magic-mime: make] Command started
-> installed hex.1.0.0
[mtime: ocaml build] Command started
[mstruct: make] Command started
-> installed mtime.0.8.4
[ocamlgraph: touch] Command started
[ocamlgraph: ./configure] Command started
[ocamlgraph: make] Command started
[magic-mime: make install] Command started
[mstruct: make install] Command started
[conduit: make install] Command started
-> installed conduit.0.15.0
[ppx_fields_conv: ./configure] Command started
-> installed magic-mime.1.0.0
[uchar: ocaml] Command started
[uchar: ocaml] Command started
-> installed uchar.0.0.1
[uutf: ocaml build] Command started
-> installed mstruct.1.3.2
[zarith: ./configure] Command started
[ppx_fields_conv: make] Command started
[zarith: make] Command started
-> installed uutf.1.0.1
[jsonm: ocaml build] Command started
-> installed jsonm.1.0.1
[ezjsonm: ./configure] Command started
-> installed ppx_fields_conv.113.33.00+4.03
[cohttp: make] Command started
[ezjsonm: make] Command started
[zarith: make install] Command started
-> installed zarith.1.4.1
[nocrypto: ocaml build] Command started
[ocamlgraph: make install-findlib] Command started
-> installed ocamlgraph.1.8.7
[ezjsonm: make install] Command started
-> installed ezjsonm.0.4.3
[mirage-tc: ./configure] Command started
[mirage-tc: make] Command started
[mirage-tc: make install] Command started
-> installed nocrypto.0.5.4
-> installed mirage-tc.0.3.0
[cohttp: make install] Command started
-> installed cohttp.0.22.0
[git: ocaml build] Command started
[91m[ERROR] The compilation of git failed at "ocaml pkg/pkg.ml build --pinned false
        --with-http true --with-unix true --with-mirage false".
[0m[91m
#=== ERROR while installing git.1.9.3 =========================================#
# opam-version         1.2.2
# os                   linux
# command              ocaml pkg/pkg.ml build --pinned false --with-http true --with-unix true --with-mirage false
# path                 /home/opam/.opam/system/build/git.1.9.3
# compiler             system (4.04.0)
# exit-code            1
# env-file             /home/opam/.opam/system/build/git.1.9.3/git-61-f18e8c.env
# stdout-file          /home/opam/.opam/system/build/git.1.9.3/git-61-f18e8c.out
# stderr-file          /home/opam/.opam/system/build/git.1.9.3/git-61-f18e8c.err
### stdout ###
# [...]
# ocamlfind ocamlc -c -g -bin-annot -safe-string -short-paths -package 'cohttp.lwt conduit.lwt-unix zip nocrypto logs.cli' -package 'cmdliner fmt.cli logs.fmt fmt.tty mtime.os lwt.unix' -package 'cstruct astring fmt hex logs lwt ocamlgraph re uri mstruct' -warn-error +1..49 -w A-4-41-44 -I bin -I lib -I lib/unix -I lib/http -I lib/mirage -o bin/ogit.cmo bin/ogit.ml
# + ocamlfind ocamlc -c -g -bin-annot -safe-string -short-paths -package 'cohttp.lwt conduit.lwt-unix zip nocrypto logs.cli' -package 'cmdliner fmt.cli logs.fmt fmt.tty mtime.os lwt.unix' -package 'cstruct astring fmt hex logs lwt ocamlgraph re uri mstruct' -warn-error +1..49 -w A-4-41-44 -I bin -I lib -I lib/unix -I lib/http -I lib/mirage -o bin/ogit.cmo bin/ogit.ml
# File "bin/ogit.ml", line 90, characters 19-23:
# Error: This expression has type
#          ?docv:string ->
#          (string -> ('a, [ `Msg of string ]) result) * 'a printer ->
#          'a converter
#        but an expression was expected of type
#          'b converter = 'b parser * 'b printer
# Command exited with code 2.
### stderr ###
# pkg.ml: [ERROR] cmd ['ocamlbuild' '-use-ocamlfind' '-classic-display' '-tag' 'debug'
# [...]
#      'lib/git_store.cmx' 'lib/git_s.cmx' 'lib/git.cmx' 'lib/git.cmi'
#      'lib/git.mli' 'lib/top/git-top.a' 'lib/top/git-top.cmxs'
#      'lib/top/git-top.cmxa' 'lib/top/git-top.cma' 'lib/top/git_top.cmx'
#      'lib/top/git_top.cmi' 'lib/top/git_top.mli' 'lib/http/git-http.a'
#      'lib/http/git-http.cmxs' 'lib/http/git-http.cmxa'
#      'lib/http/git-http.cma' 'lib/http/git_http.cmx' 'lib/http/git_http.cmi'
#      'lib/http/git_http.mli' 'lib/unix/git-unix.a' 'lib/unix/git-unix.cmxs'
#      'lib/unix/git-unix.cmxa' 'lib/unix/git-unix.cma' 'lib/unix/git_unix.cmx'
#      'lib/unix/git_unix.cmi' 'lib/unix/git_unix.mli' 'bin/ogit.native']: exited with 10

[0m

=-=- Error report -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
The following actions were aborted
  - install git-unix   1.7.1 
  - install irmin      0.11.1
  - install irmin-unix 0.9.9 
The following actions failed
  - install git 1.9.3
The following changes have been performed
  - install base64          2.1.2         
  - install bin_prot        113.33.00+4.03
  - install camlzip         1.07          
  - install cohttp          0.22.0        
  - install conduit         0.15.0        
  - install conf-gmp        1             
  - install conf-perl       1             
  - install cpuid           0.1.0         
  - install crunch          2.0.0         
  - install datakit-github  dev           
  - install ezjsonm         0.4.3         
  - install fieldslib       113.24.00     
  - install hex             1.0.0         
  - install ipaddr          2.7.2         
  - install jsonm           1.0.1         
  - install magic-mime      1.0.0         
  - install mirage-no-solo5 1             
  - install mirage-no-xen   1             
  - install mirage-tc       0.3.0         
  - install mstruct         1.3.2         
  - install mtime           0.8.4         
  - install nocrypto        0.5.4         
  - install ocamlgraph      1.8.7         
  - install ppx_fields_conv 113.33.00+4.03
  - install uchar           0.0.1         
  - install uutf            1.0.1         
  - install zarith          1.4.1         
[91m
The former state can be restored with:
    opam switch import "~/.opam/system/backup/state-20170213104710.export"
[0mThe command '/bin/sh -c opam depext datakit-bridge-local-git && opam install datakit-bridge-local-git --deps' returned a non-zero code: 4
[2017-03-13 10:47.57] Failed: Command "docker" "build" "-f" "Dockerfile.bridge-local-git" "." exited with status 4
