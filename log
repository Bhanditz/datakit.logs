=== Docker build Dockerfile.ci
[2017-02-09 18:14.52] Starting...
Cloning into '/tmp/with_clone2b990c40'...
done.
HEAD is now at 2247980 Merge pull request #481 from samoht/changes
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.685 MBSending build context to Docker daemon 6.809 MB
Step 1/19 : FROM ocaml/opam:alpine-3.5_ocaml-4.04.0
alpine-3.5_ocaml-4.04.0: Pulling from ocaml/opam
Digest: sha256:8c73fc2a9afe303ec8f249d55b0e92548856c0520be31f392054aca16a138f10
Status: Image is up to date for ocaml/opam:alpine-3.5_ocaml-4.04.0
 ---> 059d7cd6ce55
Step 2/19 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 58e79a59d19c
Step 3/19 : RUN sudo apk add tzdata
 ---> Using cache
 ---> 9473c3be3943
Step 4/19 : RUN opam depext -i opam-devel && sudo cp $(opam config var "opam-devel:lib")/opam /usr/bin/opam
 ---> Using cache
 ---> 6d5e3ad4ecfd
Step 5/19 : RUN rm -rf ~/.opam
 ---> Using cache
 ---> 97e046be63c5
Step 6/19 : RUN opam init -y
 ---> Using cache
 ---> 9494d04b832f
Step 7/19 : RUN opam install ocaml -y
 ---> Using cache
 ---> 1d4450f1863c
Step 8/19 : RUN opam install depext -y
 ---> Using cache
 ---> 552f58a316f5
Step 9/19 : RUN opam pin add -yn datakit-client https://github.com/docker/datakit.git &&     opam pin add -yn github --dev &&     opam pin add -yn datakit-github https://github.com/talex5/datakit.git#split-prometheus &&     opam pin add -yn datakit-server https://github.com/talex5/datakit.git#split-prometheus &&     opam pin add -yn datakit https://github.com/talex5/datakit.git#split-prometheus
 ---> Using cache
 ---> 76f7a02562eb
Step 10/19 : ADD datakit-ci.opam /tmp/deps/opam
 ---> Using cache
 ---> e28dda47a04e
Step 11/19 : RUN opam pin add -y tmp /tmp/deps/opam -n
 ---> Using cache
 ---> 135402be8300
Step 12/19 : RUN opam depext tmp -y
 ---> Using cache
 ---> 5f303c55441f
Step 13/19 : RUN opam install --deps-only tmp -y
 ---> Using cache
 ---> 42eb4ae5ed35
Step 14/19 : ADD . /home/opam/datakit
 ---> 1b22b485ced5
Removing intermediate container 8239bab1f7ba
Step 15/19 : RUN sudo chown opam /home/opam/datakit
 ---> Running in 0fd396e2b346
 ---> be3197e1d11d
Removing intermediate container 0fd396e2b346
Step 16/19 : RUN opam pin add -k git datakit-client /home/opam/datakit -y
 ---> Running in 1165e10bf00b
[91m[NOTE] Will pin to 'master' using git
[0m[91m[NOTE] Package datakit-client is currently pinned to git+https://github.com/docker/datakit.git (version 0.8.0).
[0mProceed and change pinning target ? [Y/n] y
[datakit-client.0.8.0: git]
[datakit-client.0.8.0: git]
[datakit-client.0.8.0: git]
[datakit-client.0.8.0: git]
[datakit-client.0.8.0] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-client/datakit-client.opam from 1.2 to 2.0~beta
[0mdatakit-client is now pinned to git+file:///home/opam/datakit#master (version 0.8.0)

The following actions will be performed:
  - recompile datakit-client 0.8.0*
  - recompile datakit-github 0.8.1*                             [uses datakit-client]
===== 2 to recompile =====
[datakit-client.0.8.0] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> removed   datakit-github.0.8.1
-> removed   datakit-client.0.8.0
-> installed datakit-client.0.8.0
-> installed datakit-github.0.8.1
Done.
# Run eval `opam env` to update the current shell environment
 ---> 568c0051bc7a
Removing intermediate container 1165e10bf00b
Step 17/19 : RUN opam pin add -k git datakit-ci /home/opam/datakit -y
 ---> Running in d3426877dd6d
[91m[NOTE] Will pin to 'master' using git
[0mPackage datakit-ci does not exist, create as a NEW package ? [Y/n] y
[datakit-ci.~dev: git]
[datakit-ci.~dev: git]
[datakit-ci.~dev: git]
[datakit-ci.~dev: git]
[datakit-ci.~dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-ci/datakit-ci.opam from 1.2 to 2.0~beta
[0mdatakit-ci is now pinned to git+file:///home/opam/datakit#master (version ~dev)

The following actions will be performed:
  - install datakit-ci ~dev*
[datakit-ci.~dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-ci.~dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> 1856a14b2fbb
Removing intermediate container d3426877dd6d
Step 18/19 : RUN opam pin add -k git datakit-github /home/opam/datakit -yn
 ---> Running in f68070b431ae
[91m[NOTE] Will pin to 'master' using git
[0m[91m[NOTE] Package datakit-github is currently pinned to git+https://github.com/talex5/datakit.git#split-prometheus (version 0.8.1).
[0mProceed and change pinning target ? [Y/n] y
[datakit-github.0.8.1: git]
[datakit-github.0.8.1: git]
[datakit-github.0.8.1: git]
[datakit-github.0.8.1: git]
[datakit-github.0.8.1] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-github/datakit-github.opam from 1.2 to 2.0~beta
[0mdatakit-github is now pinned to git+file:///home/opam/datakit#master (version 0.8.1)
 ---> 5c65cfb055fc
Removing intermediate container f68070b431ae
Step 19/19 : VOLUME /secrets
 ---> Running in 84eede3fda74
 ---> 1fc0a0e10d55
Removing intermediate container 84eede3fda74
Successfully built 1fc0a0e10d55
[2017-02-09 18:15.54] Success
