=== Docker build Dockerfile
[2017-04-26 16:07.57] Starting...
Cloning into '/tmp/with_clone2137db80'...
done.
warning: remote HEAD refers to nonexistent ref, unable to checkout.

HEAD is now at 948fb92 Use jbuilder
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.338 MB
Step 1/30 : FROM ocaml/opam-dev@sha256:337fd0f78b182a12da3f66d9d5ca075dbb79df414fc01d6a0aee99ffeb35552a
sha256:337fd0f78b182a12da3f66d9d5ca075dbb79df414fc01d6a0aee99ffeb35552a: Pulling from ocaml/opam-dev
Digest: sha256:337fd0f78b182a12da3f66d9d5ca075dbb79df414fc01d6a0aee99ffeb35552a
Status: Image is up to date for ocaml/opam-dev@sha256:337fd0f78b182a12da3f66d9d5ca075dbb79df414fc01d6a0aee99ffeb35552a
 ---> 9107a2254d1d
Step 2/30 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 90b67f82c489
Step 3/30 : RUN sudo apk add tzdata aspcud gmp-dev perl
 ---> Using cache
 ---> fff031e34a88
Step 4/30 : RUN opam pin add hvsock.0.14.0 -n https://github.com/mirage/ocaml-hvsock.git#88397c37a910c61507a9655ed8413c1692294da0
 ---> Using cache
 ---> a0c3d8deec46
Step 5/30 : RUN opam pin add irmin.1.1.0 -n https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0
 ---> Using cache
 ---> 3bf883894542
Step 6/30 : RUN opam pin add irmin-git.1.1.0 -n https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0
 ---> Using cache
 ---> 1ccc0ba0bf22
Step 7/30 : RUN opam pin add -yn protocol-9p 'https://github.com/talex5/ocaml-9p.git#ping-mirage-3'
 ---> Using cache
 ---> 9e6264aef747
Step 8/30 : RUN opam depext -ui lwt inotify alcotest conf-libev lambda-term asl win-eventlog camlzip irmin-watcher mtime mirage-flow conduit hvsock cohttp prometheus-app git irmin cmdliner protocol-9p channel rresult win-error named-pipe
 ---> Using cache
 ---> 07ae063a9513
Step 9/30 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> 173ef7632cca
Step 10/30 : RUN opam config exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> 6624c133a8bd
Step 11/30 : COPY datakit.opam /home/opam/src/datakit/
 ---> Using cache
 ---> f2e54cb07c68
Step 12/30 : COPY datakit-client.opam /home/opam/src/datakit/datakit-client.opam
 ---> Using cache
 ---> 475c4d1348e7
Step 13/30 : COPY datakit-server.opam /home/opam/src/datakit/datakit-server.opam
 ---> Using cache
 ---> 3903a7ce18bc
Step 14/30 : COPY datakit-github.opam /home/opam/src/datakit/datakit-github.opam
 ---> Using cache
 ---> 844ee011b2a9
Step 15/30 : RUN opam pin add datakit-server.dev /home/opam/src/datakit -yn &&     opam pin add datakit-client.dev /home/opam/src/datakit -yn &&     opam pin add datakit.dev /home/opam/src/datakit -yn        &&     opam pin add datakit-github.dev /home/opam/src/datakit -yn
 ---> Using cache
 ---> 0d548b6118ac
Step 16/30 : RUN opam depext -y datakit
 ---> Using cache
 ---> 1914248aec78
Step 17/30 : RUN opam install -y --deps-only datakit-client datakit-server
 ---> Using cache
 ---> ded6ac2cc244
Step 18/30 : COPY . /home/opam/src/datakit
 ---> 891c0807b53d
Removing intermediate container 260ee1eab048
Step 19/30 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in 409f7628564f
 ---> bf08f4b68bc7
Removing intermediate container 409f7628564f
Step 20/30 : RUN cd /home/opam/src/datakit &&     scripts/watermark.sh &&     git status --porcelain
 ---> Running in 260b5cd3b324
 M src/version.ml
 ---> ad679ea2bd50
Removing intermediate container 260b5cd3b324
Step 21/30 : RUN opam install datakit-client datakit-github alcotest
 ---> Running in c17aa3d25030

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-github.dev] synchronised from file:///home/opam/src/datakit
[datakit-client.dev] synchronised from file:///home/opam/src/datakit

[91m[NOTE] Package alcotest is already installed (current version is 0.7.2).
[0mThe following actions will be performed:
  - install datakit-client dev*
  - install datakit-github dev*
===== 2 to install =====
[datakit-client.dev] synchronised from file:///home/opam/src/datakit
[datakit-github.dev] synchronised from file:///home/opam/src/datakit

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-client.dev
-> installed datakit-github.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> c4f9ed45c52e
Error removing intermediate container c17aa3d25030: Driver aufs failed to remove root filesystem c17aa3d2503007504c5251c84ae7a52b7f867973672f7f0a9658f4551564c278: rename /var/lib/docker/aufs/mnt/f1940c2a93e22df5530169de39e30133f75acd6e3b55badd568e98c78362ee20 /var/lib/docker/aufs/mnt/f1940c2a93e22df5530169de39e30133f75acd6e3b55badd568e98c78362ee20-removing: device or resource busy
Step 22/30 : RUN opam install datakit -ytv
 ---> Running in 1941210cc4cd

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Processing  1/1: [datakit.dev: rsync]
[datakit.dev] synchronised from file:///home/opam/src/datakit

The following actions will be performed:
  - install irmin-git      1.1.0*                               [required by datakit]
  - install datakit-server dev*                                 [required by datakit]
  - install datakit        dev*
===== 3 to install =====
Processing  1/3: [datakit.dev: rsync]
Processing  2/3: [datakit.dev: rsync] [datakit-server.dev: rsync]
Processing  3/3: [datakit.dev: rsync] [datakit-server.dev: rsync] [irmin-git.1.1.0: git]
[datakit.dev] synchronised from file:///home/opam/src/datakit
Processing  3/3: [datakit-server.dev: rsync] [irmin-git.1.1.0: git]
[datakit-server.dev] synchronised from file:///home/opam/src/datakit
Processing  3/3: [irmin-git.1.1.0: git]
[irmin-git.1.1.0] synchronised from git+https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Processing  1/6: [datakit-server: jbuilder build]
+ jbuilder "build" "-p" "datakit-server" "-j" "1" (CWD=/home/opam/.opam/default/.opam-switch/build/datakit-server.dev)
-     ocamldep src/datakit-server/datakit_server.depends.ocamldep-output
-     ocamldep src/datakit-server/datakit_server.dependsi.ocamldep-output
-       ocamlc src/datakit-server/vfs.{cmi,cmti}
-       ocamlc src/datakit-server/vfs.{cmo,cmt}
-     ocamlopt src/datakit-server/vfs.{cmx,o}
-       ocamlc src/datakit-server/fs9p.{cmi,cmti}
-       ocamlc src/datakit-server/fs9p_error.{cmi,cmti}
-       ocamlc src/datakit-server/fs9p_error.{cmo,cmt}
-     ocamlopt src/datakit-server/fs9p_error.{cmx,o}
-       ocamlc src/datakit-server/fs9p.{cmo,cmt}
-     ocamlopt src/datakit-server/fs9p.{cmx,o}
-       ocamlc src/datakit-server/datakit_server.cma
-     ocamlopt src/datakit-server/datakit_server.{a,cmxa}
-     ocamlopt src/datakit-server/datakit_server.cmxs
-> compiled  datakit-server.dev
Processing  2/6: [irmin-git: ocaml build]
+ ocaml "pkg/pkg.ml" "build" "--pinned" "true" "-n" "irmin-git" (CWD=/home/opam/.opam/default/.opam-switch/build/irmin-git.1.1.0)
- pkg.ml: [WARNING] Watermarks: opam fields of irmin-git.opam: topkg: no such command. Did you install topkg-care ?
- pkg.ml: [WARNING] file irmin-git.opam: opam field "maintainer" undefined or unsupported
- pkg.ml: [WARNING] file irmin-git.opam: opam field "authors" undefined or unsupported
- pkg.ml: [WARNING] file irmin-git.opam: opam field "homepage" undefined or unsupported
- pkg.ml: [WARNING] file irmin-git.opam: opam field "bug-reports" undefined or unsupported
- pkg.ml: [WARNING] file irmin-git.opam: opam field "doc" undefined or unsupported
- pkg.ml: [WARNING] file irmin-git.opam: opam field "license" undefined or unsupported
- pkg.ml: [WARNING] file irmin-git.opam: opam field "dev-repo" undefined or unsupported
- ocamlfind ocamldep -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -package irmin -modules src-git/irmin_git.ml > src-git/irmin_git.ml.depends
- ocamlfind ocamldep -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -package irmin -modules src-git/irmin_git.mli > src-git/irmin_git.mli.depends
- ocamlfind ocamlc -c -g -bin-annot -short-paths -strict-sequence -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -warn-error +1..49+60 -w A-4-41-44-7 -package irmin -I src-git -o src-git/irmin_git.cmi src-git/irmin_git.mli
- ocamlfind ocamlopt -c -g -bin-annot -short-paths -strict-sequence -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -warn-error +1..49+60 -w A-4-41-44-7 -package irmin -I src-git -o src-git/irmin_git.cmx src-git/irmin_git.ml
- ocamlfind ocamlopt -a -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -package irmin -I src-git src-git/irmin_git.cmx -o src-git/irmin-git.cmxa
- ocamlfind ocamlopt -shared -linkall -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -package irmin -I src-git src-git/irmin-git.cmxa -o src-git/irmin-git.cmxs
- ocamlfind ocamlc -c -g -bin-annot -short-paths -strict-sequence -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -warn-error +1..49+60 -w A-4-41-44-7 -package irmin -I src-git -o src-git/irmin_git.cmo src-git/irmin_git.ml
- ocamlfind ocamlc -a -package 'git irmin' -package 'cstruct fmt hex logs lwt ocamlgraph re astring uri jsonm' -package irmin -I src-git src-git/irmin_git.cmo -o src-git/irmin-git.cma
- pkg.ml: [WARNING] Package description has 8 warning(s), see log above.
-> compiled  irmin-git.1.1.0
-> installed datakit-server.dev
-> installed irmin-git.1.1.0
Processing  5/6: [datakit: jbuilder build]
+ jbuilder "build" "-p" "datakit" "-j" "1" (CWD=/home/opam/.opam/default/.opam-switch/build/datakit.dev)
-     ocamldep src/datakit/bin/main.depends.ocamldep-output
-     ocamldep src/datakit/datakit.depends.ocamldep-output
-     ocamldep src/datakit/datakit.dependsi.ocamldep-output
-     ocamldep src/datakit-conduit/datakit_conduit.depends.ocamldep-output
-     ocamldep src/datakit-io/datakit_io.depends.ocamldep-output
-     ocamldep src/datakit-log/datakit_log.depends.ocamldep-output
-     ocamldep src/datakit-conduit/datakit_conduit.dependsi.ocamldep-output
-     ocamldep src/datakit-io/datakit_io.dependsi.ocamldep-output
-     ocamldep src/datakit-log/datakit_log.dependsi.ocamldep-output
-       ocamlc src/datakit-conduit/datakit_conduit.{cmi,cmti}
-       ocamlc src/datakit-io/datakit_io.{cmi,cmti}
-       ocamlc src/datakit-log/datakit_log.{cmi,cmti}
-     ocamlopt src/datakit-conduit/datakit_conduit.{cmx,o}
-       ocamlc src/datakit/autopush.{cmi,cmo,cmt}
-       ocamlc src/datakit/ivfs_blob.{cmi,cmti}
-     ocamlopt src/datakit-io/datakit_io.{cmx,o}
-     ocamlopt src/datakit-log/datakit_log.{cmx,o}
-     ocamlopt src/datakit-conduit/datakit_conduit.{a,cmxa}
-       ocamlc src/datakit/ivfs_blob.{cmo,cmt}
-       ocamlc src/datakit/ivfs_tree.{cmi,cmti}
-     ocamlopt src/datakit-io/datakit_io.{a,cmxa}
-     ocamlopt src/datakit/autopush.{cmx,o}
-     ocamlopt src/datakit/ivfs_blob.{cmx,o}
-     ocamlopt src/datakit-log/datakit_log.{a,cmxa}
-       ocamlc src/datakit/ivfs_tree.{cmo,cmt}
-       ocamlc src/datakit/ivfs.{cmi,cmti}
-       ocamlc src/datakit/ivfs_merge.{cmi,cmti}
-       ocamlc src/datakit/ivfs_remote.{cmi,cmti}
-       ocamlc src/datakit/ivfs_rw.{cmi,cmti}
-     ocamlopt src/datakit/ivfs_tree.{cmx,o}
-       ocamlc src/datakit/ivfs_merge.{cmo,cmt}
-       ocamlc src/datakit/ivfs_remote.{cmo,cmt}
-       ocamlc src/datakit/ivfs_rw.{cmo,cmt}
-       ocamlc src/datakit/bin/version.{cmi,cmo,cmt}
-       ocamlc src/datakit/ivfs.{cmo,cmt}
-     ocamlopt src/datakit/ivfs_merge.{cmx,o}
-     ocamlopt src/datakit/ivfs_remote.{cmx,o}
-     ocamlopt src/datakit/ivfs_rw.{cmx,o}
-       ocamlc src/datakit/bin/main.{cmi,cmo,cmt}
-       ocamlc src/datakit/datakit.cma
-     ocamlopt src/datakit/ivfs.{cmx,o}
-     ocamlopt src/datakit/datakit.{a,cmxa}
-     ocamlopt src/datakit/bin/version.{cmx,o}
-     ocamlopt src/datakit/datakit.cmxs
-     ocamlopt src/datakit/bin/main.{cmx,o}
-     ocamlopt src/datakit/bin/main.exe
Processing  5/6: [datakit: jbuilder runtest]
+ jbuilder "runtest" "-p" "datakit" "-j" "1" (CWD=/home/opam/.opam/default/.opam-switch/build/datakit.dev)
- Error: Findlib package "datakit-ci" not found.
- -> required by "ci/tests/jbuild (context default)"
- Hint: try: jbuilder external-lib-deps --missing


=-=- Error report -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
+- The following actions failed
| - build datakit dev
+- 
+- The following changes have been performed
| - install datakit-server dev
| - install irmin-git      1.1.0
+- 
[91m[ERROR] The compilation of datakit failed at "jbuilder runtest -p datakit -j 1".

#=== ERROR while compiling datakit.dev ========================================#
# command              jbuilder runtest -p datakit -j 1
# path                 /home/opam/.opam/default/.opam-switch/build/datakit.dev
# exit-code            1
# env-file             /home/opam/.opam/log/datakit-7-543ebd.env
# output-file          /home/opam/.opam/log/datakit-7-543ebd.out
### output ###
# Error: Findlib package "datakit-ci" not found.
# -> required by "ci/tests/jbuild (context default)"
# Hint: try: jbuilder external-lib-deps --missing

[0m# Run eval `opam env` to update the current shell environment
[91m
The former state can be restored with:
    opam switch import "/home/opam/.opam/default/.opam-switch/backup/state-20170426160834.export"
'opam install datakit -ytv' failed.
[0mThe command '/bin/sh -c opam install datakit -ytv' returned a non-zero code: 4
[2017-04-26 16:08.53] Failed: Command "docker" "build" "--pull" "-f" "Dockerfile" "." exited with status 4
