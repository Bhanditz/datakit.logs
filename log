=== Docker build Dockerfile.github
[2017-04-26 16:07.57] Starting...
Cloning into '/tmp/with_clone3d65487f'...
done.
warning: remote HEAD refers to nonexistent ref, unable to checkout.

HEAD is now at 948fb92 Use jbuilder
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.338 MB
Step 1/31 : FROM ocaml/opam-dev@sha256:337fd0f78b182a12da3f66d9d5ca075dbb79df414fc01d6a0aee99ffeb35552a
sha256:337fd0f78b182a12da3f66d9d5ca075dbb79df414fc01d6a0aee99ffeb35552a: Pulling from ocaml/opam-dev
Digest: sha256:337fd0f78b182a12da3f66d9d5ca075dbb79df414fc01d6a0aee99ffeb35552a
Status: Image is up to date for ocaml/opam-dev@sha256:337fd0f78b182a12da3f66d9d5ca075dbb79df414fc01d6a0aee99ffeb35552a
 ---> 9107a2254d1d
Step 2/31 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 90b67f82c489
Step 3/31 : RUN sudo apk add tzdata aspcud
 ---> Using cache
 ---> 1a4e4ce8b7ee
Step 4/31 : RUN opam pin add hvsock.0.14.0 -n https://github.com/mirage/ocaml-hvsock.git#88397c37a910c61507a9655ed8413c1692294da0
 ---> Using cache
 ---> afaec49f149c
Step 5/31 : RUN opam pin add irmin.1.1.0 -n https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0
 ---> Using cache
 ---> e276a27b48b0
Step 6/31 : RUN opam pin add irmin-git.1.1.0 -n https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0
 ---> Using cache
 ---> ba98ccd23980
Step 7/31 : RUN opam pin add -yn protocol-9p.0.9.0 'https://github.com/talex5/ocaml-9p.git#ping-mirage-3'
 ---> Using cache
 ---> fa7176c4d885
Step 8/31 : RUN opam pin add github --dev -n
 ---> Using cache
 ---> 8db1278421eb
Step 9/31 : RUN opam depext -ui lwt inotify alcotest conf-libev lambda-term cmdliner github protocol-9p rresult prometheus-app asl win-eventlog mtime hex github-hooks hvsock camlzip irmin-watcher git irmin
 ---> Using cache
 ---> 467110fb79b9
Step 10/31 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> b461e59034d2
Step 11/31 : RUN opam config exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> f93cc8075f34
Step 12/31 : COPY datakit.opam /home/opam/src/datakit/datakit.opam
 ---> Using cache
 ---> 2f65eaaa5846
Step 13/31 : COPY datakit-client.opam /home/opam/src/datakit/datakit-client.opam
 ---> Using cache
 ---> 318fbb337772
Step 14/31 : COPY datakit-server.opam /home/opam/src/datakit/datakit-server.opam
 ---> Using cache
 ---> 2559b045cb58
Step 15/31 : COPY datakit-github.opam /home/opam/src/datakit/datakit-github.opam
 ---> Using cache
 ---> b587182b9ad0
Step 16/31 : COPY datakit-bridge-github.opam /home/opam/src/datakit/datakit-bridge-github.opam
 ---> Using cache
 ---> 921346968654
Step 17/31 : RUN opam pin add datakit.dev /home/opam/src/datakit -yn &&     opam pin add datakit-server.dev /home/opam/src/datakit -yn &&     opam pin add datakit-client.dev /home/opam/src/datakit -yn &&     opam pin add datakit-github.dev /home/opam/src/datakit -yn &&     opam pin add datakit-bridge-github.dev /home/opam/src/datakit -yn
 ---> Using cache
 ---> 03ffbd483cd1
Step 18/31 : COPY . /home/opam/src/datakit
 ---> abd377b25085
Removing intermediate container 24ba618f152e
Step 19/31 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in f1d694ab200f
 ---> 026823dd8d26
Error removing intermediate container f1d694ab200f: Driver aufs failed to remove root filesystem f1d694ab200f2c4327a638ef19cec73a6638172c06ff6370b8792e03fd841716: rename /var/lib/docker/aufs/mnt/5301abb52d51e21a89549029e8d50b37fa74c69faa2f2caa9a2b755e2db19019 /var/lib/docker/aufs/mnt/5301abb52d51e21a89549029e8d50b37fa74c69faa2f2caa9a2b755e2db19019-removing: device or resource busy
Step 20/31 : RUN cd /home/opam/src/datakit &&     scripts/watermark.sh &&     git status --porcelain
 ---> Running in bb4e30999c83
 M src/version.ml
 ---> 8482aad3870b
Error removing intermediate container f1d694ab200f: No such container: f1d694ab200f2c4327a638ef19cec73a6638172c06ff6370b8792e03fd841716
Step 21/31 : RUN opam install datakit
 ---> Running in 5d299b53daaf

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit.dev] synchronised from file:///home/opam/src/datakit

The following actions will be performed:
  - install irmin-git      1.1.0*                               [required by datakit]
  - install datakit-server dev*                                 [required by datakit]
  - install datakit        dev*
===== 3 to install =====
[datakit.dev] synchronised from file:///home/opam/src/datakit
[datakit-server.dev] synchronised from file:///home/opam/src/datakit
[irmin-git.1.1.0] synchronised from git+https://github.com/mirage/irmin.git#89196ad17c53b02f333022a87ecc264ec8c06af0

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-server.dev
-> installed irmin-git.1.1.0
-> installed datakit.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> 091cb846ca8a
Error removing intermediate container f1d694ab200f: No such container: f1d694ab200f2c4327a638ef19cec73a6638172c06ff6370b8792e03fd841716
Step 22/31 : RUN opam install datakit-bridge-github -ytv
 ---> Running in fa3a1d86d62b

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Processing  1/1: [datakit-bridge-github.dev: rsync]
[datakit-bridge-github.dev] synchronised from file:///home/opam/src/datakit

The following actions will be performed:
  - install datakit-client        dev*                          [required by datakit-bridge-github]
  - install datakit-github        dev*                          [required by datakit-bridge-github]
  - install datakit-bridge-github dev*
===== 3 to install =====
Processing  1/3: [datakit-bridge-github.dev: rsync]
Processing  2/3: [datakit-bridge-github.dev: rsync] [datakit-client.dev: rsync]
Processing  3/3: [datakit-bridge-github.dev: rsync] [datakit-client.dev: rsync] [datakit-github.dev: rsync]
[datakit-client.dev] synchronised from file:///home/opam/src/datakit
Processing  3/3: [datakit-bridge-github.dev: rsync] [datakit-github.dev: rsync]
[datakit-bridge-github.dev] synchronised from file:///home/opam/src/datakit
Processing  3/3: [datakit-github.dev: rsync]
[datakit-github.dev] synchronised from file:///home/opam/src/datakit

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Processing  1/6: [datakit-client: jbuilder build]
+ jbuilder "build" "-p" "datakit-client" "-j" "1" (CWD=/home/opam/.opam/default/.opam-switch/build/datakit-client.dev)
- Warning: Module Datakit_S in api/ocaml doesn't have a corresponding .ml file.
- Modules without an implementation are not recommended, see this discussion:
- 
-   https://github.com/janestreet/jbuilder/issues/9
- 
- In the meantime I'm setting up a rule for copying datakit_S.mli to datakit_S.ml.
-     ocamldep api/ocaml/bin/mount.depends.ocamldep-output
-     ocamldep api/ocaml/datakit_client.dependsi.ocamldep-output
-     ocamldep api/ocaml/datakit_client.depends.ocamldep-output
-       ocamlc api/ocaml/bin/version.{cmi,cmo,cmt}
-       ocamlc api/ocaml/datakit_path.{cmi,cmti}
-       ocamlc api/ocaml/bin/mount.{cmi,cmo,cmt}
-     ocamlopt api/ocaml/bin/version.{cmx,o}
-       ocamlc api/ocaml/datakit_path.{cmo,cmt}
-     ocamlopt api/ocaml/datakit_path.{cmx,o}
-       ocamlc api/ocaml/datakit_S.{cmi,cmti}
-     ocamlopt api/ocaml/bin/mount.{cmx,o}
-       ocamlc api/ocaml/datakit_client_9p.{cmi,cmti}
-       ocamlc api/ocaml/datakit_S.{cmo,cmt}
-     ocamlopt api/ocaml/datakit_S.{cmx,o}
-     ocamlopt api/ocaml/bin/mount.exe
-       ocamlc api/ocaml/datakit_client_9p.{cmo,cmt}
-     ocamlopt api/ocaml/datakit_client_9p.{cmx,o}
-       ocamlc api/ocaml/datakit_client.cma
-     ocamlopt api/ocaml/datakit_client.{a,cmxa}
-     ocamlopt api/ocaml/datakit_client.cmxs
-> compiled  datakit-client.dev
-> installed datakit-client.dev
Processing  3/6: [datakit-github: jbuilder build]
+ jbuilder "build" "-p" "datakit-github" "-j" "1" (CWD=/home/opam/.opam/default/.opam-switch/build/datakit-github.dev)
-     ocamldep src/datakit-github/datakit_github.depends.ocamldep-output
-     ocamldep src/datakit-github/datakit_github.dependsi.ocamldep-output
-       ocamlc src/datakit-github/datakit_github.{cmi,cmti}
-       ocamlc src/datakit-github/datakit_github.{cmo,cmt}
-     ocamlopt src/datakit-github/datakit_github.{cmx,o}
-       ocamlc src/datakit-github/datakit_github_conv.{cmi,cmti}
-       ocamlc src/datakit-github/datakit_github_conv.{cmo,cmt}
-     ocamlopt src/datakit-github/datakit_github_conv.{cmx,o}
-       ocamlc src/datakit-github/datakit_github.cma
-     ocamlopt src/datakit-github/datakit_github.{a,cmxa}
-     ocamlopt src/datakit-github/datakit_github.cmxs
-> compiled  datakit-github.dev
-> installed datakit-github.dev
Processing  5/6: [datakit-bridge-github: jbuilder build]
+ jbuilder "build" "-p" "datakit-bridge-github" "-j" "1" (CWD=/home/opam/.opam/default/.opam-switch/build/datakit-bridge-github.dev)
- Error: Findlib package "datakit-server.fs9p" not found.
- -> required by "bridge/github/jbuild (context default)"
- Hint: try: jbuilder external-lib-deps --missing -p datakit-bridge-github -j 1


=-=- Error report -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
+- The following actions failed
| - build datakit-bridge-github dev
+- 
+- The following changes have been performed
| - install datakit-client dev
| - install datakit-github dev
+- 
[91m[ERROR] The compilation of datakit-bridge-github failed at "jbuilder build -p datakit-bridge-github -j 1".

#=== ERROR while compiling datakit-bridge-github.dev ==========================#
# command              jbuilder build -p datakit-bridge-github -j 1
# path                 /home/opam/.opam/default/.opam-switch/build/datakit-bridge-github.dev
# exit-code            1
# env-file             /home/opam/.opam/log/datakit-bridge-github-7-543ebd.env
# output-file          /home/opam/.opam/log/datakit-bridge-github-7-543ebd.out
### output ###
# Error: Findlib package "datakit-server.fs9p" not found.
# -> required by "bridge/github/jbuild (context default)"
# Hint: try: jbuilder external-lib-deps --missing -p datakit-bridge-github -j 1

[0m# Run eval `opam env` to update the current shell environment
[91m
The former state can be restored with:
    opam switch import "/home/opam/.opam/default/.opam-switch/backup/state-20170426160843.export"
'opam install datakit-bridge-github -ytv' failed.
[0mThe command '/bin/sh -c opam install datakit-bridge-github -ytv' returned a non-zero code: 4
[2017-04-26 16:08.55] Failed: Command "docker" "build" "--pull" "-f" "Dockerfile.github" "." exited with status 4
