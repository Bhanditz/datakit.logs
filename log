=== Docker build Dockerfile.ci
[2017-02-16 16:00.22] Starting...
Cloning into '/tmp/with_clone2c77c6b4'...
done.
HEAD is now at 1dea81a self-ci: fix docker-compose deployment
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.685 MBSending build context to Docker daemon 6.982 MB
Step 1/19 : FROM ocaml/opam:alpine-3.5_ocaml-4.04.0
alpine-3.5_ocaml-4.04.0: Pulling from ocaml/opam
Digest: sha256:209b7003457af0d1eb7cbcf09d8bc1b3a816bd210e34b67b700e99b4f2e50db1
Status: Image is up to date for ocaml/opam:alpine-3.5_ocaml-4.04.0
 ---> 4c087fe6eabb
Step 2/19 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 57b0ec356777
Step 3/19 : RUN sudo apk add tzdata
 ---> Using cache
 ---> 6e1281ca8467
Step 4/19 : RUN opam depext -i opam-devel && sudo cp $(opam config var "opam-devel:lib")/opam /usr/bin/opam
 ---> Using cache
 ---> e6945a5c4117
Step 5/19 : RUN rm -rf ~/.opam
 ---> Using cache
 ---> 9284ca61b0e4
Step 6/19 : RUN opam init -y
 ---> Using cache
 ---> b930e4ce83cb
Step 7/19 : RUN opam install ocaml -y
 ---> Using cache
 ---> fdf7094ceb4f
Step 8/19 : RUN opam install depext -y
 ---> Using cache
 ---> dc4917a5e7b6
Step 9/19 : RUN opam pin add -yn datakit-client.dev https://github.com/docker/datakit.git &&     opam pin add -yn github --dev &&     opam pin add -yn datakit-github.dev https://github.com/talex5/datakit.git#split-prometheus &&     opam pin add -yn datakit-server.dev https://github.com/talex5/datakit.git#split-prometheus &&     opam pin add -yn datakit.dev https://github.com/talex5/datakit.git#split-prometheus
 ---> Using cache
 ---> 2baf04e60def
Step 10/19 : ADD datakit-ci.opam /tmp/deps/opam
 ---> Using cache
 ---> 4b4b06c0c84b
Step 11/19 : RUN opam pin add -y tmp /tmp/deps/opam -n
 ---> Using cache
 ---> b9e88a4a4c1d
Step 12/19 : RUN opam depext tmp -y
 ---> Using cache
 ---> e4a09d7c5361
Step 13/19 : RUN opam install --deps-only tmp -y
 ---> Using cache
 ---> 2a96110e6606
Step 14/19 : ADD . /home/opam/datakit
 ---> b79db14f83a5
Removing intermediate container 8149742b1c10
Step 15/19 : RUN sudo chown opam /home/opam/datakit
 ---> Running in ab95452de910
 ---> f6ea0a0da999
Removing intermediate container ab95452de910
Step 16/19 : RUN opam pin add -k git datakit-client.dev /home/opam/datakit -y
 ---> Running in 4c34a34fe8c7
[91m[NOTE] Will pin to 'master' using git
[0mProceed and change pinning target ? [Y/n] y
[91m[NOTE] Package datakit-client is currently pinned to git+https://github.com/docker/datakit.git (version dev).
[0m[datakit-client.dev: git]
[datakit-client.dev: git]
[datakit-client.dev: git]
[datakit-client.dev: git]
[datakit-client.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-client/datakit-client.opam from 1.2 to 2.0~beta
[0mdatakit-client is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - recompile datakit-client dev*
  - recompile datakit-github dev*                               [uses datakit-client]
===== 2 to recompile =====
[datakit-client.dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> removed   datakit-github.dev
-> removed   datakit-client.dev
-> installed datakit-client.dev
-> installed datakit-github.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> 7d7bc391063a
Removing intermediate container 4c34a34fe8c7
Step 17/19 : RUN opam pin add -k git datakit-ci.dev /home/opam/datakit -y
 ---> Running in e9be0ec618be
[91m[NOTE] Will pin to 'master' using git
[0m[datakit-ci.dev: git]
[datakit-ci.dev: git]
[datakit-ci.dev: git]
[datakit-ci.dev: git]
[datakit-ci.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-ci/datakit-ci.opam from 1.2 to 2.0~beta
[0mdatakit-ci is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - install datakit-ci dev*
[datakit-ci.dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-ci.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> 86b5e474bb28
Removing intermediate container e9be0ec618be
Step 18/19 : RUN opam pin add -k git datakit-github.dev /home/opam/datakit -yn
 ---> Running in b98cfb8b0c7a
[91m[NOTE] Will pin to 'master' using git
[0m[91m[NOTE] Package datakit-github is currently pinned to git+https://github.com/talex5/datakit.git#split-prometheus (version dev).
[0mProceed and change pinning target ? [Y/n] y
[datakit-github.dev: git]
[datakit-github.dev: git]
[datakit-github.dev: git]
[datakit-github.dev: git]
[datakit-github.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-github/datakit-github.opam from 1.2 to 2.0~beta
[0mdatakit-github is now pinned to git+file:///home/opam/datakit#master (version dev)
 ---> 12e54a6c7cdc
Removing intermediate container b98cfb8b0c7a
Step 19/19 : VOLUME /secrets
 ---> Running in b1f806ac0342
 ---> 0e41eabb10d2
Removing intermediate container b1f806ac0342
Successfully built 0e41eabb10d2
[2017-02-16 16:01.22] Success
