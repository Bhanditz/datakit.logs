=== Docker build Dockerfile.ci
[2017-02-14 19:28.44] Starting...
Cloning into '/tmp/with_clone3b8bb4ac'...
done.
HEAD is now at 8b658ca github: add a constraint for uri version
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.685 MBSending build context to Docker daemon 6.896 MB
Step 1/19 : FROM ocaml/opam:alpine-3.5_ocaml-4.04.0
alpine-3.5_ocaml-4.04.0: Pulling from ocaml/opam
Digest: sha256:a4d07643bc7825a34986bdc4d0216e08f3d0714888ded2368c470765dbb164c0
Status: Image is up to date for ocaml/opam:alpine-3.5_ocaml-4.04.0
 ---> c1ca2cf6d3c1
Step 2/19 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 8baffbce93f0
Step 3/19 : RUN sudo apk add tzdata
 ---> Using cache
 ---> ab2d360a9c01
Step 4/19 : RUN opam depext -i opam-devel && sudo cp $(opam config var "opam-devel:lib")/opam /usr/bin/opam
 ---> Using cache
 ---> c2fc56bca8e2
Step 5/19 : RUN rm -rf ~/.opam
 ---> Using cache
 ---> fc611d67de64
Step 6/19 : RUN opam init -y
 ---> Using cache
 ---> 5bf31341c57c
Step 7/19 : RUN opam install ocaml -y
 ---> Using cache
 ---> c934e55d4e6d
Step 8/19 : RUN opam install depext -y
 ---> Using cache
 ---> 6eb08ba9a1a0
Step 9/19 : RUN opam pin add -yn datakit-client.dev https://github.com/docker/datakit.git &&     opam pin add -yn github --dev &&     opam pin add -yn datakit-github.dev https://github.com/talex5/datakit.git#split-prometheus &&     opam pin add -yn datakit-server.dev https://github.com/talex5/datakit.git#split-prometheus &&     opam pin add -yn datakit.dev https://github.com/talex5/datakit.git#split-prometheus
 ---> Using cache
 ---> a2af96ad6d2b
Step 10/19 : ADD datakit-ci.opam /tmp/deps/opam
 ---> Using cache
 ---> 771770e45885
Step 11/19 : RUN opam pin add -y tmp /tmp/deps/opam -n
 ---> Using cache
 ---> a6aa109374c9
Step 12/19 : RUN opam depext tmp -y
 ---> Using cache
 ---> 2f74aa23b204
Step 13/19 : RUN opam install --deps-only tmp -y
 ---> Using cache
 ---> 2748ab392d65
Step 14/19 : ADD . /home/opam/datakit
 ---> f75056e75067
Removing intermediate container efb2e78412e7
Step 15/19 : RUN sudo chown opam /home/opam/datakit
 ---> Running in 647e5ba6bf02
 ---> 281ace75e149
Removing intermediate container 647e5ba6bf02
Step 16/19 : RUN opam pin add -k git datakit-client.dev /home/opam/datakit -y
 ---> Running in eb346068e298
[91m[NOTE] Will pin to 'master' using git
[0mProceed and change pinning target ? [Y/n] y
[91m[NOTE] Package datakit-client is currently pinned to git+https://github.com/docker/datakit.git (version dev).
[0m[datakit-client.dev: git]
[datakit-client.dev: git]
[datakit-client.dev: git]
[datakit-client.dev: git]
[datakit-client.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-client/datakit-client.opam from 1.2 to 2.0~beta
[0mdatakit-client is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - recompile datakit-client dev*
  - recompile datakit-github dev*                               [uses datakit-client]
===== 2 to recompile =====
[datakit-client.dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> removed   datakit-github.dev
-> removed   datakit-client.dev
-> installed datakit-client.dev
-> installed datakit-github.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> 113b89bfe15e
Removing intermediate container eb346068e298
Step 17/19 : RUN opam pin add -k git datakit-ci.dev /home/opam/datakit -y
 ---> Running in efb53626554d
[91m[NOTE] Will pin to 'master' using git
[0mPackage datakit-ci does not exist, create as a NEW package ? [Y/n] y
[datakit-ci.dev: git]
[datakit-ci.dev: git]
[datakit-ci.dev: git]
[datakit-ci.dev: git]
[datakit-ci.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-ci/datakit-ci.opam from 1.2 to 2.0~beta
[0mdatakit-ci is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - install datakit-ci dev*
[datakit-ci.dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-ci.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> 0afb9d305ae3
Removing intermediate container efb53626554d
Step 18/19 : RUN opam pin add -k git datakit-github.dev /home/opam/datakit -yn
 ---> Running in 9ca686fbebf0
[91m[NOTE] Will pin to 'master' using git
[0mProceed and change pinning target ? [Y/n] y
[91m[NOTE] Package datakit-github is currently pinned to git+https://github.com/talex5/datakit.git#split-prometheus (version dev).
[0m[datakit-github.dev: git]
[datakit-github.dev: git]
[datakit-github.dev: git]
[datakit-github.dev: git]
[datakit-github.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-github/datakit-github.opam from 1.2 to 2.0~beta
[0mdatakit-github is now pinned to git+file:///home/opam/datakit#master (version dev)
 ---> f22533e3c24a
Removing intermediate container 9ca686fbebf0
Step 19/19 : VOLUME /secrets
 ---> Running in 22268100e4d0
 ---> 5eb2309860da
Removing intermediate container 22268100e4d0
Successfully built 5eb2309860da
[2017-02-14 19:29.42] Success
