=== Docker build Dockerfile
[2018-04-24 16:13.14] Starting...
Cloning into '/tmp/with_clone219c540c'...
done.
warning: remote HEAD refers to nonexistent ref, unable to checkout.

HEAD is now at bab9528 Bridge should depend on tls
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.685 MBSending build context to Docker daemon 7.242 MBSending build context to Docker daemon 7.799 MBSending build context to Docker daemon 8.356 MBSending build context to Docker daemon 8.913 MBSending build context to Docker daemon 9.325 MB
Step 1/22 : FROM ocaml/opam-dev:alpine-3.5_ocaml-4.05.0
alpine-3.5_ocaml-4.05.0: Pulling from ocaml/opam-dev
Digest: sha256:56eabc77608dac440c0907a0d3d3c2fbff0d65141b20dc5296783c21d42310d3
Status: Image is up to date for ocaml/opam-dev:alpine-3.5_ocaml-4.05.0
 ---> 1b9232af4c8c
Step 2/22 : RUN sudo apk add --no-cache tzdata aspcud gmp-dev perl libev-dev m4
 ---> Using cache
 ---> d0597535afb8
Step 3/22 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> a0b121bfc5fa
Step 4/22 : RUN git -C /home/opam/opam-repository fetch origin &&     git -C /home/opam/opam-repository reset 818ebb219 --hard &&     opam update -u
 ---> Using cache
 ---> 78c138e3773a
Step 5/22 : RUN opam install alcotest lwt conf-libev inotify
 ---> Using cache
 ---> 0d3fb40c5bdf
Step 6/22 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> de64742ed3fb
Step 7/22 : RUN opam config exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> bcb6b47c536e
Step 8/22 : COPY *.opam /home/opam/src/datakit/
 ---> Using cache
 ---> 2b0683791775
Step 9/22 : RUN opam pin add /home/opam/src/datakit/ -n
 ---> Using cache
 ---> d740f973703f
Step 10/22 : RUN opam install datakit --deps -t
 ---> Using cache
 ---> eeb3914aeed7
Step 11/22 : COPY . /home/opam/src/datakit
 ---> 4ce702d36985
Removing intermediate container 546036abd57b
Step 12/22 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in 0cf795fddb0b
 ---> 91845866b185
Error removing intermediate container 0cf795fddb0b: Driver aufs failed to remove root filesystem 0cf795fddb0b1a76f509404851413431fe04574ee04fb363d0d338e37a34c850: rename /var/lib/docker/aufs/mnt/9ef9bebe8b4a041ee4bce4ef63213afcfea4e876c004c8c0387b2b5821cfcdff /var/lib/docker/aufs/mnt/9ef9bebe8b4a041ee4bce4ef63213afcfea4e876c004c8c0387b2b5821cfcdff-removing: device or resource busy
Step 13/22 : RUN opam update --dev && opam upgrade
 ---> Running in d730317e8aad

=-=- Synchronising development packages -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-bridge-github.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-bridge-local-git.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-ci.0.12.1] synchronised from file:///home/opam/src/datakit
[datakit-client.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-client-9p.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-client-git.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-github.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-server.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit-server-9p.0.12.0] synchronised from file:///home/opam/src/datakit
[datakit] Conflicting update of the metadata from file:///home/opam/src/datakit.
Override files in /home/opam/.opam/ocaml-base-compiler.4.05.0/.opam-switch/overlay/datakit (there will be a backup) ? [Y/n] y
User metadata backed up in /home/opam/.opam/backup/datakit.bak
[datakit-bridge-github] Conflicting update of the metadata from file:///home/opam/src/datakit.
Override files in /home/opam/.opam/ocaml-base-compiler.4.05.0/.opam-switch/overlay/datakit-bridge-github (there will be a backup) ? [Y/n] y
User metadata backed up in /home/opam/.opam/backup/datakit-bridge-github.bak
[datakit-bridge-local-git] Installing new package description from upstream file:///home/opam/src/datakit
[datakit-ci] Installing new package description from upstream file:///home/opam/src/datakit
[datakit-client] Installing new package description from upstream file:///home/opam/src/datakit
[datakit-client-9p] Installing new package description from upstream file:///home/opam/src/datakit
[datakit-client-git] Installing new package description from upstream file:///home/opam/src/datakit
[datakit-github] Installing new package description from upstream file:///home/opam/src/datakit
[datakit-server] Installing new package description from upstream file:///home/opam/src/datakit
[datakit-server-9p] Installing new package description from upstream file:///home/opam/src/datakit
Now run 'opam upgrade' to apply any package updates.
The following actions will be performed:
  - recompile datakit-server    0.12.0* [upstream changes]
  - recompile datakit-client    0.12.0* [upstream changes]
  - recompile datakit-server-9p 0.12.0* [upstream changes]
  - recompile datakit-client-9p 0.12.0* [upstream changes]
===== 4 to recompile =====

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> removed   datakit-client-9p.0.12.0
-> removed   datakit-client.0.12.0
-> removed   datakit-server-9p.0.12.0
-> removed   datakit-server.0.12.0
-> installed datakit-client.0.12.0
-> installed datakit-client-9p.0.12.0
-> installed datakit-server.0.12.0
-> installed datakit-server-9p.0.12.0
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 57deee6cdcbb
Error removing intermediate container 0cf795fddb0b: No such container: 0cf795fddb0b1a76f509404851413431fe04574ee04fb363d0d338e37a34c850
Step 14/22 : RUN opam install datakit -ytv
 ---> Running in c787dd44efff

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Processing  1/1: [datakit.0.12.0: rsync]
[datakit.0.12.0] no changes from file:///home/opam/src/datakit

The following actions will be performed:
  - install datakit 0.12.0* 

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Processing  1/2: [datakit: jbuilder build]
+ /home/opam/.opam/ocaml-base-compiler.4.05.0/bin/jbuilder "build" "-p" "datakit" "-j" "1" (CWD=/home/opam/.opam/ocaml-base-compiler.4.05.0/.opam-switch/build/datakit.0.12.0)
Processing  1/2: [datakit: jbuilder runtest]
+ /home/opam/.opam/ocaml-base-compiler.4.05.0/bin/jbuilder "runtest" "tests/datakit" (CWD=/home/opam/.opam/ocaml-base-compiler.4.05.0/.opam-switch/build/datakit.0.12.0)
-         test alias tests/datakit/runtest
- /bin/sh: tput: not found
- stty: standard input: Not a tty
- Testing datakit.
- [33m ...[m                [36mserver[m           0   Writes.[32m[OK][m                [36mserver[m           0   Writes.
- [33m ...[m                [36mserver[m           1   RW.[32m[OK][m                [36mserver[m           1   RW.
- [33m ...[m                [36mserver[m           2   Blobs fast.[32m[OK][m                [36mserver[m           2   Blobs fast.
- [33m ...[m                [36mserver[m           3   Blobs random.[32m[OK][m                [36mserver[m           3   Blobs random.
- [33m ...[m                [36mserver[m           4   Streams.[32m[OK][m                [36mserver[m           4   Streams.
- [33m ...[m                [36mconduit[m          0   basic.[32m[OK][m                [36mconduit[m          0   basic.
- The full test results are available in `_build/_tests`.
- [32mTest Successful[m in 0.004s. 6 tests run.
+ /home/opam/.opam/ocaml-base-compiler.4.05.0/bin/jbuilder "runtest" "tests/datakit-9p" (CWD=/home/opam/.opam/ocaml-base-compiler.4.05.0/.opam-switch/build/datakit.0.12.0)
-         test alias tests/datakit-9p/runtest
- /bin/sh: tput: not found
- stty: standard input: Not a tty
- Testing datakit-9p.
- [33m ...[m                [36mserver[m          0   Transaction.[32m[OK][m                [36mserver[m          0   Transaction.
- [33m ...[m                [36mserver[m          1   Qids.[32m[OK][m                [36mserver[m          1   Qids.
- [33m ...[m                [36mserver[m          2   Watch.[32m[OK][m                [36mserver[m          2   Watch.
- [33m ...[m                [36mserver[m          3   Range.[32m[OK][m                [36mserver[m          3   Range.
- [33m ...[m                [36mserver[m          4   Rename branch.[32m[OK][m                [36mserver[m          4   Rename branch.
- [33m ...[m                [36mserver[m          5   Rename file.[32m[OK][m                [36mserver[m          5   Rename file.
- [33m ...[m                [36mserver[m          6   Truncate.[32m[OK][m                [36mserver[m          6   Truncate.
- [33m ...[m                [36mserver[m          7   Parents.[32m[OK][m                [36mserver[m          7   Parents.
- [33m ...[m                [36mserver[m          8   Merge.[32m[OK][m                [36mserver[m          8   Merge.
- [33m ...[m                [36mserver[m          9   Merge_metadata.[32m[OK][m                [36mserver[m          9   Merge_metadata.
- [33m ...[m                [36mserver[m         10   Merge empty.[32m[OK][m                [36mserver[m         10   Merge empty.
- [33m ...[m                [36mserver[m         11   Conflicts.[32m[OK][m                [36mserver[m         11   Conflicts.
- [33m ...[m                [36mserver[m         12   Stable inodes.[32m[OK][m                [36mserver[m         12   Stable inodes.
- [33m ...[m                [36mserver[m         13   Remotes.[33m[SKIP][m              [36mserver[m         13   Remotes.
- [33m ...[m                [36mserver[m         14   Debug.[32m[OK][m                [36mserver[m         14   Debug.
- [33m ...[m                [36mclient[m          0   Transaction.[32m[OK][m                [36mclient[m          0   Transaction.
- [33m ...[m                [36mclient[m          1   Watch.[32m[OK][m                [36mclient[m          1   Watch.
- [33m ...[m                [36mclient[m          2   Make dirs.[32m[OK][m                [36mclient[m          2   Make dirs.
- [33m ...[m                [36mclient[m          3   Truncate.[32m[OK][m                [36mclient[m          3   Truncate.
- [33m ...[m                [36mclient[m          4   Parents.[32m[OK][m                [36mclient[m          4   Parents.
- [33m ...[m                [36mclient[m          5   Merge.[32m[OK][m                [36mclient[m          5   Merge.
- [33m ...[m                [36mclient[m          6   Diff.[32m[OK][m                [36mclient[m          6   Diff.
- [33m ...[m                [36mclient[m          7   Merge_metadata.[32m[OK][m                [36mclient[m          7   Merge_metadata.
- [33m ...[m                [36mclient[m          8   Merge empty.[32m[OK][m                [36mclient[m          8   Merge empty.
- [33m ...[m                [36mclient[m          9   Conflicts.[32m[OK][m                [36mclient[m          9   Conflicts.
- [33m ...[m                [36mclient[m         10   Large write.[32m[OK][m                [36mclient[m         10   Large write.
- [33m ...[m                [36mclient[m         11   Remove.[32m[OK][m                [36mclient[m         11   Remove.
- [33m ...[m                [36mclient[m         12   Remotes.[33m[SKIP][m              [36mclient[m         12   Remotes.
- [33m ...[m                [36mclient[m         13   Create_or_replace.[33m[SKIP][m              [36mclient[m         13   Create_or_replace.
- The full test results are available in `_build/_tests`.
- [32mTest Successful[m in 0.240s. 26 tests run.
-> compiled  datakit.0.12.0
-> installed datakit.0.12.0
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 59381dff0bba
Error removing intermediate container 0cf795fddb0b: No such container: 0cf795fddb0b1a76f509404851413431fe04574ee04fb363d0d338e37a34c850
Step 15/22 : RUN sudo cp $(opam config exec -- which datakit) /usr/bin/datakit &&     sudo cp $(opam config exec -- which datakit-mount) /usr/bin/datakit-mount
 ---> Running in 19d7bc3cd56d
 ---> 2ff8b65d7c78
Error removing intermediate container 0cf795fddb0b: No such container: 0cf795fddb0b1a76f509404851413431fe04574ee04fb363d0d338e37a34c850
Step 16/22 : FROM alpine:3.5
3.5: Pulling from library/alpine
Digest: sha256:9148d069e50eee519ec45e5683e56a1c217b61a52ed90eb77bdce674cc212f1e
Status: Image is up to date for alpine:3.5
 ---> 6c6084ed97e5
Error removing intermediate container 0cf795fddb0b: No such container: 0cf795fddb0b1a76f509404851413431fe04574ee04fb363d0d338e37a34c850
Step 17/22 : RUN apk add --no-cache libev gmp tzdata ca-certificates git openssh-client bash
 ---> Using cache
 ---> 35df30ccf38a
Removing intermediate container d730317e8aad
Removing intermediate container c787dd44efff
Removing intermediate container 19d7bc3cd56d
Error removing intermediate container 0cf795fddb0b: No such container: 0cf795fddb0b1a76f509404851413431fe04574ee04fb363d0d338e37a34c850
Step 18/22 : EXPOSE 5640
 ---> Using cache
 ---> 2daba84f0461
Error removing intermediate container 0cf795fddb0b: No such container: 0cf795fddb0b1a76f509404851413431fe04574ee04fb363d0d338e37a34c850
Step 19/22 : ENTRYPOINT /usr/bin/datakit
 ---> Using cache
 ---> 1a23108d3ccc
Error removing intermediate container 0cf795fddb0b: No such container: 0cf795fddb0b1a76f509404851413431fe04574ee04fb363d0d338e37a34c850
Step 20/22 : CMD --url=tcp://0.0.0.0:5640 --git=/data -v
 ---> Using cache
 ---> fc5adf88a158
Error removing intermediate container 0cf795fddb0b: No such container: 0cf795fddb0b1a76f509404851413431fe04574ee04fb363d0d338e37a34c850
Step 21/22 : COPY --from=0 /usr/bin/datakit /usr/bin/datakit
 ---> Using cache
 ---> 3cbd1c99b062
Error removing intermediate container 0cf795fddb0b: No such container: 0cf795fddb0b1a76f509404851413431fe04574ee04fb363d0d338e37a34c850
Step 22/22 : COPY --from=0 /usr/bin/datakit-mount /usr/bin/datakit-mount
 ---> Using cache
 ---> e761161de71b
Error removing intermediate container 0cf795fddb0b: No such container: 0cf795fddb0b1a76f509404851413431fe04574ee04fb363d0d338e37a34c850
Successfully built e761161de71b
[2018-04-24 16:14.46] Success
