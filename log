=== Docker build Dockerfile.ci
[2017-05-18 18:08.18] Starting...
Cloning into '/tmp/with_clone396216f'...
done.
warning: remote HEAD refers to nonexistent ref, unable to checkout.

HEAD is now at 86c4776 ci: use the dev version of protocol-9p-unix to avoid End_of_file async exceptions
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.685 MBSending build context to Docker daemon 7.139 MB
Step 1/24 : FROM ocaml/opam-dev@sha256:64dc0522876ebbd27b186e3ba955ae5ab864ace580add5b0d1abb8715bdf1bbe
sha256:64dc0522876ebbd27b186e3ba955ae5ab864ace580add5b0d1abb8715bdf1bbe: Pulling from ocaml/opam-dev
Digest: sha256:64dc0522876ebbd27b186e3ba955ae5ab864ace580add5b0d1abb8715bdf1bbe
Status: Image is up to date for ocaml/opam-dev@sha256:64dc0522876ebbd27b186e3ba955ae5ab864ace580add5b0d1abb8715bdf1bbe
 ---> 477ad7d223ad
Step 2/24 : RUN git -C /home/opam/opam-repository fetch origin &&     git -C /home/opam/opam-repository reset origin/master --hard &&     opam update -u
 ---> Using cache
 ---> 52e71e2e863a
Step 3/24 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> cfabc32e9e4f
Step 4/24 : RUN sudo apk add tzdata aspcud
 ---> Using cache
 ---> 51ed7ede4caa
Step 5/24 : RUN opam pin add git.dev --dev -n
 ---> Using cache
 ---> 09561fa35521
Step 6/24 : RUN opam pin add git-unix.dev --dev -n
 ---> Using cache
 ---> ca2717bed195
Step 7/24 : RUN opam pin add irmin.1.2.0 -n https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821
 ---> Using cache
 ---> cc441b126226
Step 8/24 : RUN opam pin add irmin-mem.1.2.0 -n https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821
 ---> Using cache
 ---> 38e441d69d39
Step 9/24 : RUN opam pin add irmin-fs.1.2.0 -n https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821
 ---> Using cache
 ---> fcb396508511
Step 10/24 : RUN opam pin add irmin-http.1.2.0 -n https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821
 ---> Using cache
 ---> a2a562dcf0ea
Step 11/24 : RUN opam pin add irmin-git.1.2.0 -n https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821
 ---> Using cache
 ---> 15909fa820d7
Step 12/24 : RUN opam pin add irmin-unix.1.2.0 -n https://github.com/mirage/irmin.git#81ffa256d3aa6b73b689609f7a5ff01c298fe821
 ---> Using cache
 ---> aaac172ada2d
Step 13/24 : RUN opam pin add protocol-9p-unix.dev --dev
 ---> Running in ba30ab8452e6
[protocol-9p-unix.dev: git]
[protocol-9p-unix.dev: git]
[protocol-9p-unix.dev: git]
[protocol-9p-unix.dev: git]
[protocol-9p-unix.dev] synchronised from git+https://github.com/mirage/ocaml-9p.git
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/protocol-9p-unix/protocol-9p-unix.opam from 1.2 to 2.0~beta
[0mprotocol-9p-unix is now pinned to git+https://github.com/mirage/ocaml-9p.git (version dev)

The following actions will be performed:
  - install uchar                   0.0.1                       [required by fmt]
  - install conf-m4                 1                           [required by ocamlfind]
  - install result                  1.2                         [required by protocol-9p-unix]
  - install ocamlfind               1.7.1                       [required by protocol-9p-unix]
  - install topkg                   0.9.0                       [required by mirage-kv-lwt, logs, cmdliner, etc.]
  - install ppx_tools               5.0                         [required by protocol-9p-unix]
  - install jbuilder                1.0+beta8                   [required by protocol-9p-unix]
  - install base-bytes              base                        [required by protocol-9p-unix]
  - install rresult                 0.5.0                       [required by protocol-9p-unix]
  - install cmdliner                1.0.0                       [required by protocol-9p-unix]
  - install astring                 0.8.3                       [required by protocol-9p-unix]
  - install asetmap                 0.8.1                       [required by prometheus]
  - install sexplib                 v0.9.1                      [required by protocol-9p-unix]
  - install ppx_traverse_builtins   v0.9.0                      [required by ppx_core, ppx_metaquot]
  - install ocaml-migrate-parsetree 1.0                         [required by cstruct, ppx_sexp_conv]
  - install ocaml-compiler-libs     v0.9.0                      [required by ppx_core]
  - install win-error               0.2                         [required by protocol-9p-unix]
  - install cppo                    1.5.0                       [required by ppx_deriving]
  - install fmt                     0.8.3                       [required by protocol-9p-unix]
  - install ocb-stubblr             0.1.1                       [required by named-pipe]
  - install base                    v0.9.2                      [required by ppx_core]
  - install ppx_tools_versioned     5.0.1                       [required by cstruct]
  - install ppx_ast                 v0.9.1                      [required by ppx_core]
  - install ppx_deriving            4.1                         [required by protocol-9p-unix]
  - install ocplib-endian           1.0                         [required by cstruct]
  - install lwt                     3.0.0                       [required by protocol-9p-unix]
  - install mirage-flow             1.2.0                       [required by mirage-channel, mirage-flow-lwt]
  - install mirage-device           1.0.0                       [required by mirage-kv]
  - install stdio                   v0.9.0                      [required by ppx_core]
  - install prometheus              0.1                         [required by protocol-9p-unix]
  - install named-pipe              0.4.0                       [required by protocol-9p-unix]
  - install logs                    0.6.2                       [required by protocol-9p-unix]
  - install cstruct                 2.4.1                       [required by protocol-9p-unix]
  - install mirage-channel          3.0.0                       [required by mirage-channel-lwt]
  - install mirage-kv               1.0.0                       [required by mirage-kv-lwt]
  - install mirage-clock            1.2.0                       [required by mirage-flow-lwt]
  - install ppx_core                v0.9.0                      [required by ppx_sexp_conv]
  - install io-page                 1.6.1                       [required by mirage-channel-lwt]
  - install cstruct-lwt             0                           [required by protocol-9p]
  - install mirage-kv-lwt           1.0.0                       [required by protocol-9p-unix]
  - install mirage-flow-lwt         1.2.0                       [required by protocol-9p-unix]
  - install ppx_optcomp             v0.9.0                      [required by ppx_driver]
  - install mirage-channel-lwt      3.0.0                       [required by protocol-9p-unix]
  - install ppx_driver              v0.9.1                      [required by ppx_sexp_conv]
  - install ppx_metaquot            v0.9.0                      [required by ppx_sexp_conv]
  - install ppx_type_conv           v0.9.0                      [required by ppx_sexp_conv]
  - install ppx_sexp_conv           v0.9.0                      [required by protocol-9p-unix]
  - install protocol-9p             0.11.0                      [required by protocol-9p-unix]
  - install protocol-9p-unix        dev*
===== 49 to install =====

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[asetmap.0.8.1] downloaded from http://erratique.ch/software/asetmap/releases/asetmap-0.8.1.tbz
[astring.0.8.3] downloaded from http://erratique.ch/software/astring/releases/astring-0.8.3.tbz
[cmdliner.1.0.0] downloaded from http://erratique.ch/software/cmdliner/releases/cmdliner-1.0.0.tbz
[cppo.1.5.0] downloaded from https://github.com/mjambon/cppo/archive/v1.5.0.tar.gz
[fmt.0.8.3] downloaded from http://erratique.ch/software/fmt/releases/fmt-0.8.3.tbz
[base.v0.9.2] downloaded from https://github.com/janestreet/base/archive/v0.9.2.tar.gz
[cstruct.2.4.1] downloaded from https://github.com/mirage/ocaml-cstruct/archive/v2.4.1.tar.gz
[logs.0.6.2] downloaded from http://erratique.ch/software/logs/releases/logs-0.6.2.tbz
[io-page.1.6.1] downloaded from https://github.com/mirage/io-page/archive/v1.6.1.tar.gz
[jbuilder.1.0+beta8] downloaded from https://github.com/janestreet/jbuilder/archive/1.0+beta8.tar.gz
[lwt.3.0.0] downloaded from https://github.com/ocsigen/lwt/archive/3.0.0.tar.gz
[mirage-channel.3.0.0] downloaded from https://github.com/mirage/mirage-channel/releases/download/v3.0.0/mirage-channel-3.0.0.tbz
[mirage-clock.1.2.0] downloaded from https://github.com/mirage/mirage-clock/releases/download/1.2.0/mirage-clock-1.2.0.tbz
[mirage-channel-lwt.3.0.0] downloaded from https://github.com/mirage/mirage-channel/releases/download/v3.0.0/mirage-channel-lwt-3.0.0.tbz
[mirage-device.1.0.0] downloaded from https://github.com/mirage/mirage-device/releases/download/1.0.0/mirage-device-1.0.0.tbz
[mirage-flow.1.2.0] downloaded from https://github.com/mirage/mirage-flow/releases/download/1.2.0/mirage-flow-1.2.0.tbz
[mirage-flow-lwt.1.2.0] downloaded from https://github.com/mirage/mirage-flow/releases/download/1.2.0/mirage-flow-lwt-1.2.0.tbz
[mirage-kv.1.0.0] downloaded from https://github.com/mirage/mirage-kv/releases/download/1.0.0/mirage-kv-1.0.0.tbz
[ocaml-compiler-libs.v0.9.0] downloaded from https://ocaml.janestreet.com/ocaml-core/v0.9/files/ocaml-compiler-libs-v0.9.0.tar.gz
[mirage-kv-lwt.1.0.0] downloaded from https://github.com/mirage/mirage-kv/releases/download/1.0.0/mirage-kv-lwt-1.0.0.tbz
[ocamlfind.1.7.1] downloaded from http://download.camlcity.org/download/findlib-1.7.1.tar.gz
[named-pipe.0.4.0] downloaded from https://github.com/mirage/ocaml-named-pipe/releases/download/0.4.0/named-pipe-0.4.0.tbz
[ocaml-migrate-parsetree.1.0] downloaded from https://github.com/let-def/ocaml-migrate-parsetree/archive/v1.0.tar.gz
[ocb-stubblr.0.1.1] downloaded from https://github.com/pqwy/ocb-stubblr/releases/download/v0.1.1/ocb-stubblr-0.1.1.tbz
[ocplib-endian.1.0] downloaded from https://github.com/OCamlPro/ocplib-endian/archive/1.0.tar.gz
[ppx_core.v0.9.0] downloaded from https://ocaml.janestreet.com/ocaml-core/v0.9/files/ppx_core-v0.9.0.tar.gz
[ppx_ast.v0.9.1] downloaded from https://github.com/janestreet/ppx_ast/archive/v0.9.1.tar.gz
[ppx_metaquot.v0.9.0] downloaded from https://ocaml.janestreet.com/ocaml-core/v0.9/files/ppx_metaquot-v0.9.0.tar.gz
[ppx_deriving.4.1] downloaded from https://github.com/whitequark/ppx_deriving/archive/v4.1.tar.gz
[ppx_driver.v0.9.1] downloaded from https://github.com/janestreet/ppx_driver/archive/v0.9.1.tar.gz
[ppx_optcomp.v0.9.0] downloaded from https://ocaml.janestreet.com/ocaml-core/v0.9/files/ppx_optcomp-v0.9.0.tar.gz
[ppx_sexp_conv.v0.9.0] downloaded from https://ocaml.janestreet.com/ocaml-core/v0.9/files/ppx_sexp_conv-v0.9.0.tar.gz
[ppx_traverse_builtins.v0.9.0] downloaded from https://ocaml.janestreet.com/ocaml-core/v0.9/files/ppx_traverse_builtins-v0.9.0.tar.gz
[ppx_tools.5.0] downloaded from https://github.com/alainfrisch/ppx_tools/tarball/f70ca1d07d565989a0041e312e8efc00ff2ad87e
[ppx_tools_versioned.5.0.1] downloaded from https://github.com/let-def/ppx_tools_versioned/archive/5.0.1.tar.gz
[ppx_type_conv.v0.9.0] downloaded from https://ocaml.janestreet.com/ocaml-core/v0.9/files/ppx_type_conv-v0.9.0.tar.gz
[prometheus.0.1] downloaded from https://github.com/mirage/prometheus/releases/download/v0.1/prometheus-0.1.tbz
[protocol-9p.0.11.0] downloaded from https://github.com/mirage/ocaml-9p/archive/v0.11.0.tar.gz
[rresult.0.5.0] downloaded from http://erratique.ch/software/rresult/releases/rresult-0.5.0.tbz
[protocol-9p-unix.dev] synchronised from git+https://github.com/mirage/ocaml-9p.git
[result.1.2] downloaded from https://github.com/janestreet/result/archive/1.2.tar.gz
[stdio.v0.9.0] downloaded from https://ocaml.janestreet.com/ocaml-core/v0.9/files/stdio-v0.9.0.tar.gz
[topkg.0.9.0] downloaded from http://erratique.ch/software/topkg/releases/topkg-0.9.0.tbz
[sexplib.v0.9.1] downloaded from https://github.com/janestreet/sexplib/archive/v0.9.1.tar.gz
[win-error.0.2] downloaded from https://github.com/djs55/ocaml-win-error/archive/v0.2.tar.gz
[uchar.0.0.1] downloaded from https://github.com/ocaml/uchar/releases/download/v0.0.1/uchar-0.0.1.tbz

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[91m[ERROR] The compilation of conf-m4 failed at "sh -exc echo | m4".
[0m-> installed result.1.2
-> installed uchar.0.0.1
[91m
#=== ERROR while compiling conf-m4.1 ==========================================#
# command              sh -exc echo | m4
# path                 /home/opam/.opam/default/.opam-switch/build/conf-m4.1
# exit-code            127
# env-file             /home/opam/.opam/log/conf-m4-7-22e6fb.env
# output-file          /home/opam/.opam/log/conf-m4-7-22e6fb.out
### output ###
# + echo
# + m4
# sh: m4: not found

[0m

=-=- Error report -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
+- The following actions were aborted
| - install asetmap                 0.8.1
| - install astring                 0.8.3
| - install base                    v0.9.2
| - install base-bytes              base
| - install cmdliner                1.0.0
| - install cppo                    1.5.0
| - install cstruct                 2.4.1
| - install cstruct-lwt             0
| - install fmt                     0.8.3
| - install io-page                 1.6.1
| - install jbuilder                1.0+beta8
| - install logs                    0.6.2
| - install lwt                     3.0.0
| - install mirage-channel          3.0.0
| - install mirage-channel-lwt      3.0.0
| - install mirage-clock            1.2.0
| - install mirage-device           1.0.0
| - install mirage-flow             1.2.0
| - install mirage-flow-lwt         1.2.0
| - install mirage-kv               1.0.0
| - install mirage-kv-lwt           1.0.0
| - install named-pipe              0.4.0
| - install ocaml-compiler-libs     v0.9.0
| - install ocaml-migrate-parsetree 1.0
| - install ocamlfind               1.7.1
| - install ocb-stubblr             0.1.1
| - install ocplib-endian           1.0
| - install ppx_ast                 v0.9.1
| - install ppx_core                v0.9.0
| - install ppx_deriving            4.1
| - install ppx_driver              v0.9.1
| - install ppx_metaquot            v0.9.0
| - install ppx_optcomp             v0.9.0
| - install ppx_sexp_conv           v0.9.0
| - install ppx_tools               5.0
| - install ppx_tools_versioned     5.0.1
| - install ppx_traverse_builtins   v0.9.0
| - install ppx_type_conv           v0.9.0
| - install prometheus              0.1
| - install protocol-9p             0.11.0
| - install protocol-9p-unix        dev
| - install rresult                 0.5.0
| - install sexplib                 v0.9.1
| - install stdio                   v0.9.0
| - install topkg                   0.9.0
| - install win-error               0.2
+- 
+- The following actions failed
| - build conf-m4 1
+- 
+- The following changes have been performed
| - install result 1.2
| - install uchar  0.0.1
+- 

=-=- conf-m4.1 troubleshooting =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
=> This package relies on external (system) dependencies that may be missing. `opam depext conf-m4.1' may help you find the correct installation for your system.
# Run eval `opam env` to update the current shell environment
[91m[NOTE] Pinning command successful, but your installed packages may be out of sync.

The former state can be restored with:
    opam switch import "/home/opam/.opam/default/.opam-switch/backup/state-20170518180836.export"
[0mThe command '/bin/sh -c opam pin add protocol-9p-unix.dev --dev' returned a non-zero code: 4
[2017-05-18 18:08.56] Failed: Command "docker" "build" "--pull" "-f" "Dockerfile.ci" "." exited with status 4
