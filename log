=== Run docker-build-datakit on commit a9003d40cd45ed359159c9f23eaf1c83f9ed438e
[2017-01-12 15:52.38] Starting...
Cloning into '/tmp/with_clone52b787e'...
done.
HEAD is now at a9003d4 build: disable ocamlbuild automatic traversal
[2017-01-12 15:52.39] Running "docker" "build" "--pull" "-f" "Dockerfile" "."...
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 4.707 MB
Step 1 : FROM docker/datakit:server
server: Pulling from docker/datakit
b7f33cc0b48e: Already exists
42bb68aa98c1: Already exists
6a91586a2c32: Already exists
741069926369: Already exists
392d5cb61a4d: Pulling fs layer
aa6fba6fe414: Pulling fs layer
fb832a4cf31d: Pulling fs layer
2758280dc3eb: Pulling fs layer
148b24cb90d9: Pulling fs layer
ef0d778aa316: Pulling fs layer
955c614f7aa2: Pulling fs layer
28443e03b77f: Pulling fs layer
bfeea37b6ac2: Pulling fs layer
2b02f0866f0d: Pulling fs layer
2b02f0866f0d: Waiting
2758280dc3eb: Waiting
148b24cb90d9: Waiting
955c614f7aa2: Waiting
28443e03b77f: Waiting
bfeea37b6ac2: Waiting
ef0d778aa316: Waiting
fb832a4cf31d: Verifying Checksum
fb832a4cf31d: Download complete
2758280dc3eb: Verifying Checksum
2758280dc3eb: Download complete
392d5cb61a4d: Download complete
392d5cb61a4d: Pull complete
ef0d778aa316: Download complete
aa6fba6fe414: Verifying Checksum
aa6fba6fe414: Download complete
955c614f7aa2: Verifying Checksum
955c614f7aa2: Download complete
28443e03b77f: Verifying Checksum
28443e03b77f: Download complete
148b24cb90d9: Verifying Checksum
148b24cb90d9: Download complete
2b02f0866f0d: Verifying Checksum
2b02f0866f0d: Download complete
bfeea37b6ac2: Download complete
aa6fba6fe414: Pull complete
fb832a4cf31d: Pull complete
2758280dc3eb: Pull complete
148b24cb90d9: Pull complete
ef0d778aa316: Pull complete
955c614f7aa2: Pull complete
28443e03b77f: Pull complete
bfeea37b6ac2: Pull complete
2b02f0866f0d: Pull complete
Digest: sha256:8d7b0a50ce0e1fda0eb63ca0b6d76a56cae2f522892b8b89f8a85b14c65680d8
Status: Image is up to date for docker/datakit:server
 ---> da28ffaac645
Step 2 : RUN cd /home/opam/opam-repository && git pull && opam update -y
 ---> Running in c23988df3b9a
[91mFrom git://github.com/ocaml/opam-repository
   708b202..6aed8a2  master     -> origin/master
[0mUpdating 708b202..6aed8a2
Fast-forward
 packages/fd-send-recv/fd-send-recv.1.0.0/opam | 17 +++++++++++++++--
 packages/fd-send-recv/fd-send-recv.1.0.0/url  |  2 +-
 packages/fd-send-recv/fd-send-recv.1.0.1/opam | 15 +++++++++++++--
 packages/fd-send-recv/fd-send-recv.1.0.1/url  |  2 +-
 4 files changed, 30 insertions(+), 6 deletions(-)

=-=- Updating package repositories =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[default: local] Command started
[default: local] Command started
[default: local] Command started
[default] /home/opam/opam-repository synchronized

=-=- Synchronizing development packages -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-server: local] Command started
[datakit-server] /home/opam/src/datakit/ synchronized

Updates available for 4.03.0, apply them with 'opam upgrade':
===== 1 to recompile =====
 ---> 6b7712976b1c
Removing intermediate container c23988df3b9a
Step 3 : COPY opam /home/opam/src/datakit/opam
 ---> dc288abe32e9
Removing intermediate container a3bff32c31e6
Step 4 : RUN opam pin add datakit.dev /home/opam/src/datakit -n
 ---> Running in 53af11c7d74c
datakit is now path-pinned to /home/opam/src/datakit

[datakit: local]
[datakit] /home/opam/src/datakit/ synchronized
[datakit] Installing new package description from /home/opam/src/datakit

 ---> 684a2edcf26f
Removing intermediate container 53af11c7d74c
Step 5 : RUN opam depext datakit && opam install datakit --deps
 ---> Running in 11ee1be7d4d0
# Detecting depexts using flags: x86_64 linux alpine
# The following system packages are needed:
#  - linux-headers
#  - m4
#  - ncurses-dev
#  - openssl-dev
#  - pkgconfig
#  - zlib-dev
m4
ncurses-dev
pkgconfig
# The following new OS packages need to be installed: linux-headers openssl-dev zlib-dev
The following command needs to be run through "sudo":
    apk add linux-headers openssl-dev zlib-dev
(1/3) Installing linux-headers (4.4.6-r1)
(2/3) Installing zlib-dev (1.2.8-r2)
(3/3) Installing openssl-dev (1.0.2j-r0)
OK: 435 MiB in 87 packages
# OS packages installation successful

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit: local] Command started
[datakit] /home/opam/src/datakit/ already up-to-date
The following actions will be performed:
  - install mtime           0.8.3         
  - install bin_prot        113.33.00+4.03
  - install conduit         0.14.4        
  - install asetmap         0.8.1         
  - install uchar           0.0.1         
  - install magic-mime      1.0.0         
  - install asl             0.10          
  - install camlzip         1.06          
  - install base64          2.1.2         
  - install irmin-watcher   0.2.0         
  - install mstruct         1.3.2         
  - install crunch          1.4.1         
  - install mirage-flow     1.1.0         
  - install hex             1.0.0         
  - install win-eventlog    0.1           
  - install fieldslib       113.24.00     
  - install duration        0.1.0         
  - install ocamlgraph      1.8.7         
  - install uutf            1.0.0         
  - install ppx_fields_conv 113.33.00+4.03
  - install hvsock          0.11.1        
  - install jsonm           1.0.0         
  - install cohttp          0.21.0        
  - install ezjsonm         0.4.3         
  - install git             1.9.3         
  - install mirage-tc       0.3.0         
  - install irmin           0.12.0        
===== 27 to install =====
Do you want to continue ? [Y/n] y

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[asetmap: http] Command started
[asl: http] Command started
[base64: http] Command started
[asetmap: http] Command started
[asetmap.0.8.1] http://erratique.ch/software/asetmap/releases/asetmap-0.8.1.tbz downloaded
[bin_prot: http] Command started
[base64: http] Command started
[base64.2.1.2] https://github.com/mirage/ocaml-base64/releases/download/v2.1.2/base64-2.1.2.tbz downloaded
[camlzip: http] Command started
[bin_prot: http] Command started
[bin_prot.113.33.00+4.03] https://ocaml.janestreet.com/ocaml-core/113.33/files/bin_prot-113.33.00+4.03.tar.gz downloaded
[cohttp: http] Command started
[asl: http] Command started
[asl.0.10] https://github.com/mirage/ocaml-asl/archive/v0.10.tar.gz downloaded
[conduit: http] Command started
[camlzip: http] Command started
[camlzip.1.06] https://forge.ocamlcore.org/frs/download.php/1616/camlzip-1.06.tar.gz downloaded
[crunch: http] Command started
[conduit: http] Command started
[conduit.0.14.4] https://github.com/mirage/ocaml-conduit/archive/v0.14.4.tar.gz downloaded
[duration: http] Command started
[cohttp: http] Command started
[cohttp.0.21.0] https://github.com/mirage/ocaml-cohttp/archive/v0.21.0.tar.gz downloaded
[ezjsonm: http] Command started
[crunch: http] Command started
[crunch.1.4.1] https://github.com/mirage/ocaml-crunch/archive/v1.4.1.tar.gz downloaded
[fieldslib: http] Command started
[duration: http] Command started
[duration.0.1.0] https://github.com/hannesm/duration/releases/download/0.1.0/duration-0.1.0.tbz downloaded
[git: http] Command started
[fieldslib: http] Command started
[fieldslib.113.24.00] https://ocaml.janestreet.com/ocaml-core/113.24/files/fieldslib-113.24.00.tar.gz downloaded
[hex: http] Command started
[ezjsonm: http] Command started
[ezjsonm.0.4.3] https://github.com/mirage/ezjsonm/archive/0.4.3.tar.gz downloaded
[hvsock: http] Command started
[hex: http] Command started
[hex.1.0.0] https://github.com/mirage/ocaml-hex/archive/1.0.0.tar.gz downloaded
[irmin: http] Command started
[git: http] Command started
[git.1.9.3] https://github.com/mirage/ocaml-git/releases/download/1.9.3/git-1.9.3.tbz downloaded
[irmin-watcher: http] Command started
[hvsock: http] Command started
[hvsock.0.11.1] https://github.com/mirage/ocaml-hvsock/archive/v0.11.1.tar.gz downloaded
[jsonm: http] Command started
[jsonm: http] Command started
[jsonm.1.0.0] http://erratique.ch/software/jsonm/releases/jsonm-1.0.0.tbz downloaded
[magic-mime: http] Command started
[irmin-watcher: http] Command started
[irmin-watcher.0.2.0] https://github.com/samoht/irmin-watcher/releases/download/0.2.0/irmin-watcher-0.2.0.tbz downloaded
[mirage-flow: http] Command started
[magic-mime: http] Command started
[magic-mime.1.0.0] https://github.com/mirage/ocaml-magic-mime/archive/v1.0.0.tar.gz downloaded
[mirage-tc: http] Command started
[irmin: http] Command started
[irmin.0.12.0] https://github.com/mirage/irmin/releases/download/0.12.0/irmin-0.12.0.tbz downloaded
[mstruct: http] Command started
[mirage-flow: http] Command started
[mirage-flow.1.1.0] https://github.com/mirage/mirage-flow/archive/v1.1.0.tar.gz downloaded
[mtime: http] Command started
[mtime: http] Command started
[mtime.0.8.3] http://erratique.ch/software/mtime/releases/mtime-0.8.3.tbz downloaded
[ocamlgraph: http] Command started
[mstruct: http] Command started
[mstruct.1.3.2] https://github.com/mirage/ocaml-mstruct/archive/1.3.2.tar.gz downloaded
[ppx_fields_conv: http] Command started
[mirage-tc: http] Command started
[mirage-tc.0.3.0] https://github.com/mirage/mirage-tc/archive/0.3.0.tar.gz downloaded
[uchar: http] Command started
[ppx_fields_conv: http] Command started
[ppx_fields_conv.113.33.00+4.03] https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_fields_conv-113.33.00+4.03.tar.gz downloaded
[uutf: http] Command started
[uutf: http] Command started
[uutf.1.0.0] http://erratique.ch/software/uutf/releases/uutf-1.0.0.tbz downloaded
[win-eventlog: http] Command started
[uchar: http] Command started
[uchar.0.0.1] https://github.com/ocaml/uchar/releases/download/v0.0.1/uchar-0.0.1.tbz downloaded
[win-eventlog: http] Command started
[win-eventlog.0.1] https://github.com/djs55/ocaml-win-eventlog/archive/v0.1.tar.gz downloaded
[ocamlgraph: http] Command started
[ocamlgraph.1.8.7] http://ocamlgraph.lri.fr/download/ocamlgraph-1.8.7.tar.gz downloaded

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[asetmap: ocaml build] Command started
[asl: make] Command started
[base64: ocaml build] Command started
[bin_prot: ./configure] Command started
-> installed asetmap.0.8.1
[camlzip: make all] Command started
-> installed base64.2.1.2
[conduit: ./configure] Command started
[conduit: make] Command started
[camlzip: make allopt] Command started
[bin_prot: make] Command started
[camlzip: make install-findlib] Command started
-> installed camlzip.1.06
[crunch: ocaml setup.ml] Command started
[crunch: ocaml setup.ml] Command started
[asl: make install] Command started
[crunch: ocaml setup.ml] Command started
-> installed bin_prot.113.33.00+4.03
[duration: ocaml build] Command started
-> installed asl.0.10
[fieldslib: ./configure] Command started
-> installed duration.0.1.0
[hex: ./configure] Command started
-> installed crunch.1.4.1
[irmin-watcher: ocaml build] Command started
[fieldslib: make] Command started
[conduit: make install] Command started
-> installed conduit.0.14.4
[magic-mime: ./configure] Command started
[hex: make] Command started
-> installed irmin-watcher.0.2.0
[mirage-flow: ./configure] Command started
[magic-mime: make] Command started
-> installed fieldslib.113.24.00
[mstruct: ./configure] Command started
[hex: make install] Command started
[mirage-flow: make] Command started
[mstruct: make] Command started
[magic-mime: make install] Command started
-> installed hex.1.0.0
[mtime: ocaml] Command started
[mtime: ocaml] Command started
-> installed magic-mime.1.0.0
[ocamlgraph: touch] Command started
[ocamlgraph: ./configure] Command started
[mstruct: make install] Command started
-> installed mtime.0.8.3
[ppx_fields_conv: ./configure] Command started
[ocamlgraph: make] Command started
[mirage-flow: make install] Command started
-> installed mstruct.1.3.2
[uchar: ocaml] Command started
[uchar: ocaml] Command started
[ppx_fields_conv: make] Command started
-> installed uchar.0.0.1
[uutf: ocaml build] Command started
-> installed mirage-flow.1.1.0
[hvsock: ocaml setup.ml] Command started
-> installed uutf.1.0.0
[jsonm: ocaml build] Command started
-> installed jsonm.1.0.0
[ezjsonm: ./configure] Command started
[hvsock: make] Command started
-> installed ppx_fields_conv.113.33.00+4.03
[cohttp: make] Command started
[ezjsonm: make] Command started
[ocamlgraph: make install-findlib] Command started
-> installed ocamlgraph.1.8.7
[win-eventlog: make] Command started
[ezjsonm: make install] Command started
[hvsock: make install] Command started
-> installed ezjsonm.0.4.3
[mirage-tc: ./configure] Command started
-> installed hvsock.0.11.1
[mirage-tc: make] Command started
[win-eventlog: make install] Command started
-> installed win-eventlog.0.1
[mirage-tc: make install] Command started
-> installed mirage-tc.0.3.0
[cohttp: make install] Command started
-> installed cohttp.0.21.0
[git: ocaml build] Command started
-> installed git.1.9.3
[irmin: ocaml build] Command started
-> installed irmin.0.12.0
Done.
 ---> 9baea0cf4642
Removing intermediate container 11ee1be7d4d0
Step 6 : COPY . /home/opam/src/datakit/
 ---> bc56eb38a3af
Removing intermediate container 459e82d9ab8d
Step 7 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in cc948301e4c8
 ---> f79d7ef865ce
Removing intermediate container cc948301e4c8
Step 8 : RUN cd /home/opam/src/datakit &&     git diff && git status --porcelain &&     git checkout . && scripts/watermark.sh &&     git status --porcelain
 ---> Running in 6ce0b9eaf9a2
 M src/version.ml
 ---> 6186497693b8
Removing intermediate container 6ce0b9eaf9a2
Step 9 : RUN opam update datakit
 ---> Running in 53ba34622646

=-=- Synchronizing development packages -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit: local] Command started
[datakit] /home/opam/src/datakit/ synchronized

Updates available for 4.03.0, apply them with 'opam upgrade':
===== 1 to recompile =====
 ---> c62e1e6791e4
Removing intermediate container 53ba34622646
Step 10 : RUN opam install datakit -vv
 ---> Running in 008ebc475468

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit: local] Command started
+ rsync "-rLptgoDrvc" "--exclude" ".git" "--exclude" "_darcs" "--exclude" ".hg" "--exclude" ".#*" "--delete" "/home/opam/src/datakit/" "/home/opam/.opam/4.03.0/packages.dev/datakit"
- sending incremental file list
- 
- sent 7,970 bytes  received 41 bytes  16,022.00 bytes/sec
- total size is 1,245,309  speedup is 155.45
[datakit] /home/opam/src/datakit/ already up-to-date
The following actions will be performed:
  - install datakit dev*

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit: local] Command started
+ rsync "-rLptgoDrvc" "--exclude" ".git" "--exclude" "_darcs" "--exclude" ".hg" "--exclude" ".#*" "--delete" "/home/opam/src/datakit/" "/home/opam/.opam/4.03.0/packages.dev/datakit"
- sending incremental file list
- 
- sent 7,970 bytes  received 41 bytes  16,022.00 bytes/sec
- total size is 1,245,309  speedup is 155.45
[datakit.dev] /home/opam/src/datakit/ already up-to-date

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit: ocaml build] Command started
+ ocaml "pkg/pkg.ml" "build" "--pinned" "true" "--tests" "false" (CWD=/home/opam/.opam/4.03.0/build/datakit.dev)
[91m[ERROR] The compilation of datakit failed at "ocaml pkg/pkg.ml build --pinned
        true --tests false".
[0m- ocamlfind ocamlopt unix.cmxa -I /home/opam/.opam/4.03.0/lib/ocamlbuild /home/opam/.opam/4.03.0/lib/ocamlbuild/ocamlbuildlib.cmxa -linkpkg myocamlbuild.ml /home/opam/.opam/4.03.0/lib/ocamlbuild/ocamlbuild.cmx -o myocamlbuild
- ocamlfind ocamldep -package prometheus-cohttp -package 'conduit.lwt-unix irmin lwt.unix uri camlzip git tc' -package 'irmin tc datakit-server.vfs asetmap' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules src/datakit/ivfs.ml > src/datakit/ivfs.ml.depends
- + ocamlfind ocamldep -package prometheus-cohttp -package 'conduit.lwt-unix irmin lwt.unix uri camlzip git tc' -package 'irmin tc datakit-server.vfs asetmap' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules src/datakit/ivfs.ml > src/datakit/ivfs.ml.depends
- ocamlfind: Package `prometheus-cohttp' not found
- Command exited with code 2.
- pkg.ml: [ERROR] cmd ['ocamlbuild' '-use-ocamlfind' '-tag' 'debug' '-build-dir' '_build'
-      'CHANGES.md' 'LICENSE.md' 'README.md' 'pkg/META' 'opam'
-      'src/datakit/ivfs.a' 'src/datakit/ivfs.cmxs' 'src/datakit/ivfs.cmxa'
-      'src/datakit/ivfs.cma' 'src/datakit/ivfs_rw.cmx'
-      'src/datakit/ivfs_rw.cmi' 'src/datakit/ivfs_rw.mli'
-      'src/datakit/ivfs_merge.cmx' 'src/datakit/ivfs_merge.cmi'
-      'src/datakit/ivfs_merge.mli' 'src/datakit/ivfs_blob.cmx'
-      'src/datakit/ivfs_blob.cmi' 'src/datakit/ivfs_blob.mli'
-      'src/datakit/ivfs_remote.cmx' 'src/datakit/ivfs_remote.cmi'
-      'src/datakit/ivfs_remote.mli' 'src/datakit/ivfs_tree.cmx'
-      'src/datakit/ivfs_tree.cmi' 'src/datakit/ivfs_tree.mli'
-      'src/datakit/ivfs.cmx' 'src/datakit/ivfs.cmi' 'src/datakit/ivfs.mli'
-      'src/datakit/main.native' 'src/datakit-client/mount.native']: exited with 10


=-=- Error report -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
The following actions failed
  - install datakit dev
No changes have been performed
[91m
#=== ERROR while installing datakit.dev =======================================#
# opam-version         1.2.2 (58ef3b8213100953848d362f7120a30356d7f77d)
# os                   linux
# command              ocaml pkg/pkg.ml build --pinned true --tests false
# path                 /home/opam/.opam/4.03.0/build/datakit.dev
# compiler             4.03.0
# exit-code            1
# env-file             /home/opam/.opam/4.03.0/build/datakit.dev/datakit-7-ffb3fd.env
# stdout-file          /home/opam/.opam/4.03.0/build/datakit.dev/datakit-7-ffb3fd.out
# stderr-file          /home/opam/.opam/4.03.0/build/datakit.dev/datakit-7-ffb3fd.err
### stdout ###
# ocamlfind ocamlopt unix.cmxa -I /home/opam/.opam/4.03.0/lib/ocamlbuild /home/opam/.opam/4.03.0/lib/ocamlbuild/ocamlbuildlib.cmxa -linkpkg myocamlbuild.ml /home/opam/.opam/4.03.0/lib/ocamlbuild/ocamlbuild.cmx -o myocamlbuild
# ocamlfind ocamldep -package prometheus-cohttp -package 'conduit.lwt-unix irmin lwt.unix uri camlzip git tc' -package 'irmin tc datakit-server.vfs asetmap' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules src/datakit/ivfs.ml > src/datakit/ivfs.ml.depends
# + ocamlfind ocamldep -package prometheus-cohttp -package 'conduit.lwt-unix irmin lwt.unix uri camlzip git tc' -package 'irmin tc datakit-server.vfs asetmap' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules src/datakit/ivfs.ml > src/datakit/ivfs.ml.depends
# ocamlfind: Package `prometheus-cohttp' not found
# Command exited with code 2.
### stderr ###
# pkg.ml: [ERROR] cmd ['ocamlbuild' '-use-ocamlfind' '-tag' 'debug' '-build-dir' '_build'
# [...]
#      'src/datakit/ivfs_rw.cmi' 'src/datakit/ivfs_rw.mli'
#      'src/datakit/ivfs_merge.cmx' 'src/datakit/ivfs_merge.cmi'
#      'src/datakit/ivfs_merge.mli' 'src/datakit/ivfs_blob.cmx'
#      'src/datakit/ivfs_blob.cmi' 'src/datakit/ivfs_blob.mli'
#      'src/datakit/ivfs_remote.cmx' 'src/datakit/ivfs_remote.cmi'
#      'src/datakit/ivfs_remote.mli' 'src/datakit/ivfs_tree.cmx'
#      'src/datakit/ivfs_tree.cmi' 'src/datakit/ivfs_tree.mli'
#      'src/datakit/ivfs.cmx' 'src/datakit/ivfs.cmi' 'src/datakit/ivfs.mli'
#      'src/datakit/main.native' 'src/datakit-client/mount.native']: exited with 10

[0m[91m'opam install datakit -vv' failed.
[0mThe command '/bin/sh -c opam install datakit -vv' returned a non-zero code: 4
[2017-01-12 15:55.07] Failed: Command "docker" "build" "--pull" "-f" "Dockerfile" "." exited with status 1
