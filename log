=== Docker build Dockerfile.bridge-local-git
[2017-02-09 14:17.36] Starting...
Cloning into '/tmp/with_clone210dac10'...
done.
HEAD is now at b411907 github: add a warning when trying to remove a non-existing directory
[2017-02-09 14:17.37] Rewrite Dockerfile's first line to:
FROM sha256:593d8271a66e2ef89fcd60acd2710778986561b9c6f8fdf7c7ab30046e4d72ed
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.578 MB
Step 1/17 : FROM sha256:593d8271a66e2ef89fcd60acd2710778986561b9c6f8fdf7c7ab30046e4d72ed
 ---> 593d8271a66e
Step 2/17 : RUN opam pin add github --dev -n
 ---> Using cache
 ---> a04e6d725b76
Step 3/17 : RUN opam pin add datakit-github.dev /home/opam/src/datakit -n
 ---> Using cache
 ---> d16b5f8014c1
Step 4/17 : RUN opam depext datakit-github && opam install datakit-github --deps
 ---> Using cache
 ---> 15814148b5ab
Step 5/17 : COPY datakit-bridge-local-git.opam /home/opam/src/datakit/datakit-bridge-local-git.opam
 ---> Using cache
 ---> 146a51d238a8
Step 6/17 : RUN opam pin add datakit-bridge-local-git.dev /home/opam/src/datakit -n
 ---> Using cache
 ---> 601b1b68a264
Step 7/17 : RUN opam depext datakit-bridge-local-git && opam install datakit-bridge-local-git --deps
 ---> Running in 4293c9d01407
# Detecting depexts using flags: x86_64 linux alpine
# The following system packages are needed:
#  - gmp-dev
#  - linux-headers
#  - m4
#  - ncurses-dev
#  - openssl-dev
#  - perl
#  - pkgconfig
#  - zlib-dev
gmp-dev
linux-headers
m4
ncurses-dev
openssl-dev
perl
pkgconfig
zlib-dev
# All required OS packages found.

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-bridge-local-git: local] Command started
[datakit-bridge-local-git] /home/opam/src/datakit/ already up-to-date
The following actions will be performed:
  - install datakit-github dev*          
  - install camlzip        1.07          
  - install bin_prot       113.33.00+4.03
  - install irmin-watcher  0.2.0         
  - install mstruct        1.3.2         
  - install crunch         1.4.1         
  - install uchar          0.0.1         
  - install ocamlgraph     1.8.7         
  - install uutf           1.0.0         
  - install git            1.9.3         
  - install jsonm          1.0.0         
  - install git-unix       1.7.1         
  - install ezjsonm        0.4.3         
  - install mirage-tc      0.3.0         
  - install irmin          0.12.0        
  - install irmin-unix     0.12.0        
===== 16 to install =====

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[bin_prot: http] Command started
[camlzip: http] Command started
[crunch: http] Command started
[bin_prot: http] Command started
[bin_prot.113.33.00+4.03] https://ocaml.janestreet.com/ocaml-core/113.33/files/bin_prot-113.33.00+4.03.tar.gz downloaded
[datakit-github: local] Command started
[datakit-github.dev] /home/opam/src/datakit/ already up-to-date
[ezjsonm: http] Command started
[camlzip: http] Command started
[camlzip.1.07] https://github.com/xavierleroy/camlzip/archive/rel107.zip downloaded
[git: http] Command started
[crunch: http] Command started
[crunch.1.4.1] https://github.com/mirage/ocaml-crunch/archive/v1.4.1.tar.gz downloaded
[irmin: http] Command started
[ezjsonm: http] Command started
[ezjsonm.0.4.3] https://github.com/mirage/ezjsonm/archive/0.4.3.tar.gz downloaded
[irmin-watcher: http] Command started
[git: http] Command started
[git.1.9.3] https://github.com/mirage/ocaml-git/releases/download/1.9.3/git-1.9.3.tbz downloaded
[jsonm: http] Command started
[jsonm: http] Command started
[jsonm.1.0.0] http://erratique.ch/software/jsonm/releases/jsonm-1.0.0.tbz downloaded
[mirage-tc: http] Command started
[irmin: http] Command started
[irmin.0.12.0] https://github.com/mirage/irmin/releases/download/0.12.0/irmin-0.12.0.tbz downloaded
[mstruct: http] Command started
[irmin-watcher: http] Command started
[irmin-watcher.0.2.0] https://github.com/samoht/irmin-watcher/releases/download/0.2.0/irmin-watcher-0.2.0.tbz downloaded
[ocamlgraph: http] Command started
[ocamlgraph: http] Command started
[ocamlgraph.1.8.7] http://ocamlgraph.lri.fr/download/ocamlgraph-1.8.7.tar.gz downloaded
[uchar: http] Command started
[mirage-tc: http] Command started
[mirage-tc.0.3.0] https://github.com/mirage/mirage-tc/archive/0.3.0.tar.gz downloaded
[uutf: http] Command started
[uutf: http] Command started
[uutf.1.0.0] http://erratique.ch/software/uutf/releases/uutf-1.0.0.tbz downloaded
[mstruct: http] Command started
[mstruct.1.3.2] https://github.com/mirage/ocaml-mstruct/archive/1.3.2.tar.gz downloaded
[uchar: http] Command started
[uchar.0.0.1] https://github.com/ocaml/uchar/releases/download/v0.0.1/uchar-0.0.1.tbz downloaded

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[bin_prot: ./configure] Command started
[camlzip: make all] Command started
[crunch: ocaml setup.ml] Command started
[datakit-github: ocaml build] Command started
[camlzip: make allopt] Command started
[camlzip: make install-findlib] Command started
-> installed camlzip.1.07
[irmin-watcher: ocaml build] Command started
[bin_prot: make] Command started
[crunch: ocaml setup.ml] Command started
-> installed irmin-watcher.0.2.0
[mstruct: ./configure] Command started
[crunch: ocaml setup.ml] Command started
[mstruct: make] Command started
-> installed crunch.1.4.1
[ocamlgraph: touch] Command started
[ocamlgraph: ./configure] Command started
[ocamlgraph: make] Command started
[mstruct: make install] Command started
-> installed datakit-github.dev
[uchar: ocaml] Command started
-> installed bin_prot.113.33.00+4.03
[uchar: ocaml] Command started
-> installed mstruct.1.3.2
-> installed uchar.0.0.1
[uutf: ocaml build] Command started
-> installed uutf.1.0.0
[jsonm: ocaml build] Command started
-> installed jsonm.1.0.0
[ezjsonm: ./configure] Command started
[ezjsonm: make] Command started
[ocamlgraph: make install-findlib] Command started
-> installed ocamlgraph.1.8.7
[git: ocaml build] Command started
[ezjsonm: make install] Command started
-> installed ezjsonm.0.4.3
[mirage-tc: ./configure] Command started
[mirage-tc: make] Command started
[mirage-tc: make install] Command started
-> installed mirage-tc.0.3.0
-> installed git.1.9.3
-> installed git-unix.1.7.1
[irmin: ocaml build] Command started
-> installed irmin.0.12.0
-> installed irmin-unix.0.12.0
Done.
 ---> a1abe126c287
Removing intermediate container 4293c9d01407
Step 8/17 : COPY . /home/opam/src/datakit/
 ---> c38e15ddbc8b
Removing intermediate container 46e4ce2a9752
Step 9/17 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in e2fc9fc5ae15
 ---> 6c7fa3da09a2
Removing intermediate container e2fc9fc5ae15
Step 10/17 : RUN cd /home/opam/src/datakit &&     git diff && git status --porcelain &&     git checkout . && scripts/watermark.sh &&     git status --porcelain
 ---> Running in 28a51ac04d4c
diff --git a/Dockerfile.bridge-local-git b/Dockerfile.bridge-local-git
index d93d44e..e813b9d 100644
--- a/Dockerfile.bridge-local-git
+++ b/Dockerfile.bridge-local-git
@@ -1,4 +1,4 @@
-FROM docker/datakit:client
+FROM sha256:593d8271a66e2ef89fcd60acd2710778986561b9c6f8fdf7c7ab30046e4d72ed
 
 RUN opam pin add github --dev -n
 RUN opam pin add datakit-github.dev /home/opam/src/datakit -n
 M Dockerfile.bridge-local-git
 M src/version.ml
 ---> 38d5b932a84f
Removing intermediate container 28a51ac04d4c
Step 11/17 : RUN opam update datakit-bridge-local-git
 ---> Running in 93616d288ad6

=-=- Synchronizing development packages -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-bridge-local-git: local] Command started
[datakit-bridge-local-git] /home/opam/src/datakit/ synchronized
 ---> df6f4a483eee
Removing intermediate container 93616d288ad6
Step 12/17 : RUN opam install datakit-bridge-local-git -vv
 ---> Running in 62dc26384ba5

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-bridge-local-git: local] Command started
+ rsync "-rLptgoDrvc" "--exclude" ".git" "--exclude" "_darcs" "--exclude" ".hg" "--exclude" ".#*" "--delete" "/home/opam/src/datakit/" "/home/opam/.opam/4.03.0/packages.dev/datakit-bridge-local-git"
- sending incremental file list
- ./
- api/
- bridge/
- ci/
- ci/static/
- src/
- 
- sent 8,107 bytes  received 60 bytes  16,334.00 bytes/sec
- total size is 1,283,549  speedup is 157.16
[datakit-bridge-local-git] /home/opam/src/datakit/ synchronized
The following actions will be performed:
  - install datakit-bridge-local-git dev*

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-bridge-local-git: local] Command started
+ rsync "-rLptgoDrvc" "--exclude" ".git" "--exclude" "_darcs" "--exclude" ".hg" "--exclude" ".#*" "--delete" "/home/opam/src/datakit/" "/home/opam/.opam/4.03.0/packages.dev/datakit-bridge-local-git"
- sending incremental file list
- ./
- ci/
- 
- sent 8,095 bytes  received 48 bytes  16,286.00 bytes/sec
- total size is 1,283,549  speedup is 157.63
[datakit-bridge-local-git.dev] /home/opam/src/datakit/ synchronized

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-bridge-local-git: ocaml build] Command started
+ ocaml "pkg/pkg.ml" "build" "--pinned" "true" "-n" "datakit-bridge-local-git" (CWD=/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev)
- ocamlfind ocamlopt unix.cmxa -I /home/opam/.opam/4.03.0/lib/ocamlbuild /home/opam/.opam/4.03.0/lib/ocamlbuild/ocamlbuildlib.cmxa -linkpkg myocamlbuild.ml /home/opam/.opam/4.03.0/lib/ocamlbuild/ocamlbuild.cmx -o myocamlbuild
- ocamlfind ocamldep -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules bridge/local/main.ml > bridge/local/main.ml.depends
- ocamlfind ocamldep -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules bridge/local/main.mli > bridge/local/main.mli.depends
- ocamlfind ocamlc -c -g -annot -bin-annot -safe-string -strict-sequence -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -w A -package 'bytes lwt astring logs result cstruct fmt rresult' -I bridge/local -o bridge/local/main.cmi bridge/local/main.mli
- ocamlfind ocamldep -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules bridge/local/sync.ml > bridge/local/sync.ml.depends
- ocamlfind ocamldep -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules bridge/local/sync.mli > bridge/local/sync.mli.depends
- ocamlfind ocamlc -c -g -annot -bin-annot -safe-string -strict-sequence -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -w A -package 'bytes lwt astring logs result cstruct fmt rresult' -I bridge/local -o bridge/local/sync.cmi bridge/local/sync.mli
- ocamlfind ocamlopt -c -g -annot -bin-annot -safe-string -strict-sequence -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -w A -package 'bytes lwt astring logs result cstruct fmt rresult' -I bridge/local -o bridge/local/sync.cmx bridge/local/sync.ml
- ocamlfind ocamlopt -c -g -annot -bin-annot -safe-string -strict-sequence -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -w A -package 'bytes lwt astring logs result cstruct fmt rresult' -I bridge/local -o bridge/local/main.cmx bridge/local/main.ml
- ocamlfind ocamlopt -a -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -package 'bytes lwt astring logs result cstruct fmt rresult' bridge/local/sync.cmx bridge/local/main.cmx -o bridge/local/datakit-bridge-local-git.cmxa
- ocamlfind ocamlopt -shared -linkall -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -package 'bytes lwt astring logs result cstruct fmt rresult' bridge/local/datakit-bridge-local-git.cmxa -o bridge/local/datakit-bridge-local-git.cmxs
- ocamlfind ocamlc -c -g -annot -bin-annot -safe-string -strict-sequence -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -w A -package 'bytes lwt astring logs result cstruct fmt rresult' -I bridge/local -o bridge/local/main.cmo bridge/local/main.ml
- ocamlfind ocamlc -c -g -annot -bin-annot -safe-string -strict-sequence -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -w A -package 'bytes lwt astring logs result cstruct fmt rresult' -I bridge/local -o bridge/local/sync.cmo bridge/local/sync.ml
- ocamlfind ocamlc -a -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -package 'bytes lwt astring logs result cstruct fmt rresult' bridge/local/sync.cmo bridge/local/main.cmo -o bridge/local/datakit-bridge-local-git.cma
- ocamlfind ocamlopt -linkpkg -g -package 'irmin.unix, irmin.git, irmin-watcher, datakit-github.client' -package 'cmdliner, logs, datakit-client, protocol-9p.unix, fmt.cli, fmt.tty, logs.cli' -package 'bytes lwt astring logs result cstruct fmt rresult' bridge/local/sync.cmx bridge/local/main.cmx -o bridge/local/main.native
+ install "-m" "0755" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/main.native" "/home/opam/.opam/4.03.0/bin/datakit-bridge-local-git"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/datakit-bridge-local-git.a" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/datakit-bridge-local-git.a"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/datakit-bridge-local-git.cma" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/datakit-bridge-local-git.cma"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/datakit-bridge-local-git.cmxa" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/datakit-bridge-local-git.cmxa"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/datakit-bridge-local-git.cmxs" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/datakit-bridge-local-git.cmxs"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/main.cmi" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/main.cmi"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/main.cmti" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/main.cmti"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/main.cmx" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/main.cmx"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/main.mli" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/main.mli"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/sync.cmi" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/sync.cmi"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/sync.cmti" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/sync.cmti"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/sync.cmx" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/sync.cmx"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/bridge/local/sync.mli" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/sync.mli"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/datakit-bridge-local-git.opam" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/opam"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/pkg/META.bridge-local-git" "/home/opam/.opam/4.03.0/lib/datakit-bridge-local-git/META"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/CHANGES.md" "/home/opam/.opam/4.03.0/doc/datakit-bridge-local-git/CHANGES.md"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/LICENSE.md" "/home/opam/.opam/4.03.0/doc/datakit-bridge-local-git/LICENSE.md"
+ install "-m" "0644" "/home/opam/.opam/4.03.0/build/datakit-bridge-local-git.dev/_build/README.md" "/home/opam/.opam/4.03.0/doc/datakit-bridge-local-git/README.md"
-> installed datakit-bridge-local-git.dev
Done.
 ---> b920be02065e
Removing intermediate container 62dc26384ba5
Step 13/17 : RUN opam config exec -- ocaml /home/opam/src/datakit/check-libev.ml
 ---> Running in 61d270ea6f41
 ---> 3f947f87572a
Removing intermediate container 61d270ea6f41
Step 14/17 : RUN sudo cp $(opam config exec -- which datakit-bridge-local-git) /usr/bin/
 ---> Running in 9f2b04707aa5
 ---> 50c40a0bec30
Removing intermediate container 9f2b04707aa5
Step 15/17 : USER root
 ---> Running in 22305556c3e2
 ---> c8dce9b4c06a
Removing intermediate container 22305556c3e2
Step 16/17 : ENTRYPOINT /usr/bin/datakit-bridge-local-git
 ---> Running in 59f980b78eab
 ---> f945314d7b43
Removing intermediate container 59f980b78eab
Step 17/17 : CMD -v --datakit=tcp:datakit:5640
 ---> Running in 4549b1271a47
 ---> b9e172baab91
Removing intermediate container 4549b1271a47
Successfully built b9e172baab91
[2017-02-09 14:19.58] Success
