=== Run docker-build-ci on commit 19da2316573d372d64f9c2c9752edb5d55c35358
[2016-12-02 08:49.48] Starting...
Cloning into '/tmp/with_clone6edba6a'...
done.
HEAD is now at 19da231 ci: fix opam and Dockerfile to use datakit-github
[2016-12-02 08:49.49] Running "docker" "build" "--pull" "-f" "Dockerfile.ci" "."...
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.685 MBSending build context to Docker daemon 7.242 MBSending build context to Docker daemon 7.567 MB
Step 1 : FROM ocaml/opam:alpine-3.4_ocaml-4.03.0
alpine-3.4_ocaml-4.03.0: Pulling from ocaml/opam
Digest: sha256:0d6b39b76d34b91bac67d6e706e6dd0554cf6bdbbc9bf3f13faf046599715230
Status: Image is up to date for ocaml/opam:alpine-3.4_ocaml-4.03.0
 ---> 5a4ee39ad30c
Step 2 : RUN sudo apk add tzdata
 ---> Using cache
 ---> 5b11b725a78a
Step 3 : RUN cd /home/opam/opam-repository && git pull && opam update -y
 ---> Using cache
 ---> 50328f6becf3
Step 4 : RUN opam depext -ui cohttp yojson ssl tyxml fmt rresult logs lwt conf-libev react camlp4     tls pbkdf ppx_sexp_conv webmachine session asetmap
 ---> Using cache
 ---> 6bda4059e6c0
Step 5 : RUN opam pin add multipart-form-data https://github.com/cryptosense/multipart-form-data.git
 ---> Using cache
 ---> dd5f7f41eb7b
Step 6 : RUN opam pin add datakit-client https://github.com/docker/datakit.git
 ---> Using cache
 ---> d8ef3bb77bb8
Step 7 : RUN opam pin add datakit-github https://github.com/docker/datakit.git
 ---> Running in 230bd7235d68
Package datakit-github does not exist, create as a NEW package ? [Y/n] y
datakit-github is now git-pinned to https://github.com/docker/datakit.git

[datakit-github: git]
[datakit-github: git]
[datakit-github: git]
[datakit-github: git]
[datakit-github: git]
[datakit-github: git]
[datakit-github] https://github.com/docker/datakit.git updated
[datakit-github] Installing new package description from
https://github.com/docker/datakit.git

datakit-github needs to be installed.
The following actions will be performed:
  - install   mtime          0.8.3                              [required by datakit-github]
  - install   camomile       0.8.5                              [required by zed]
  - install   menhir         20161115                           [required by atd]
  - install   asl            0.10                               [required by datakit-github]
  - install   mirage-flow    1.1.0                              [required by hvsock]
  - install   hex            1.0.0                              [required by datakit-github]
  - install   win-eventlog   0.1                                [required by datakit-github]
  - install   duration       0.1.0                              [required by hvsock]
  - install   zed            1.4                                [required by lambda-term]
  - install   atd            1.2.0                              [required by atdgen]
  - install   hvsock         0.11.1                             [required by datakit-github]
  - install   lambda-term    1.10.1                             [required by github]
  - install   atdgen         1.10.0                             [required by github]
  - recompile protocol-9p    0.7.4                              [uses lambda-term]
  - install   github         2.1.0                              [required by datakit-github]
  - install   datakit-server 0.7.0                              [required by datakit-github]
  - recompile datakit-client 0.7.0*                             [uses protocol-9p]
  - install   github-hooks   0.1.1                              [required by datakit-github]
  - install   datakit-github *       
===== 17 to install | 2 to recompile =====
Do you want to continue ? [Y/n] y

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[asl: http] Command started
[atd: http] Command started
[atdgen: http] Command started
[atdgen: http] Command started
[atd: http] Command started
[asl: http] Command started
[atd.1.2.0] https://github.com/mjambon/atd/archive/v1.2.0.tar.gz downloaded
[camomile: http] Command started
[atdgen.1.10.0] https://github.com/mjambon/atdgen/archive/v1.10.0.tar.gz downloaded
[datakit-client: git] Command started
[asl.0.10] https://github.com/mirage/ocaml-asl/archive/v0.10.tar.gz downloaded
[datakit-github: git] Command started
[datakit-client: git] Command started
[datakit-github: git] Command started
[datakit-github: git] Command started
[datakit-github: git] Command started
[datakit-github] https://github.com/docker/datakit.git already up-to-date
[datakit-server: http] Command started
[datakit-client: git] Command started
[datakit-client: git] Command started
[datakit-client] https://github.com/docker/datakit.git updated
[duration: http] Command started
[duration: http] Command started
[duration.0.1.0] https://github.com/hannesm/duration/releases/download/0.1.0/duration-0.1.0.tbz downloaded
[github: http] Command started
[datakit-server: http] Command started
[datakit-server.0.7.0] https://github.com/docker/datakit/releases/download/0.7.0/datakit-0.7.0.tbz downloaded
[github-hooks: http] Command started
[camomile: http] Command started
[camomile.0.8.5] https://github.com/yoriyuki/Camomile/releases/download/rel-0.8.5/camomile-0.8.5.tar.bz2 downloaded
[hex: http] Command started
[github: http] Command started
[github.2.1.0] https://github.com/mirage/ocaml-github/archive/v2.1.0.tar.gz downloaded
[hvsock: http] Command started
[github-hooks: http] Command started
[github-hooks.0.1.1] https://github.com/dsheets/ocaml-github-hooks/releases/download/0.1.1/github-hooks-0.1.1.tbz downloaded
[lambda-term: http] Command started
[hex: http] Command started
[hex.1.0.0] https://github.com/mirage/ocaml-hex/archive/1.0.0.tar.gz downloaded
[menhir: http] Command started
[hvsock: http] Command started
[hvsock.0.11.1] https://github.com/mirage/ocaml-hvsock/archive/v0.11.1.tar.gz downloaded
[mirage-flow: http] Command started
[menhir: http] Command started
[menhir.20161115] http://gallium.inria.fr/~fpottier/menhir/menhir-20161115.tar.gz downloaded
[mtime: http] Command started
[mtime: http] Command started
[mtime.0.8.3] http://erratique.ch/software/mtime/releases/mtime-0.8.3.tbz downloaded
[win-eventlog: http] Command started
[lambda-term: http] Command started
[lambda-term.1.10.1] https://github.com/diml/lambda-term/archive/1.10.1.tar.gz downloaded
[zed: http] Command started
[mirage-flow: http] Command started
[mirage-flow.1.1.0] https://github.com/mirage/mirage-flow/archive/v1.1.0.tar.gz downloaded
[win-eventlog: http] Command started
[win-eventlog.0.1] https://github.com/djs55/ocaml-win-eventlog/archive/v0.1.tar.gz downloaded
[zed: http] Command started
[zed.1.4] https://github.com/diml/zed/archive/1.4.tar.gz downloaded

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> removed   datakit-client.0.7.0
-> removed   protocol-9p.0.7.4
[asl: make] Command started
[camomile: ./configure] Command started
[duration: ocaml build] Command started
[hex: ./configure] Command started
-> installed duration.0.1.0
[menhir: make Makefile] Command started
[hex: make] Command started
[camomile: make] Command started
[hex: make install] Command started
[asl: make install] Command started
-> installed asl.0.10
[mirage-flow: ./configure] Command started
-> installed hex.1.0.0
[mtime: ocaml] Command started
[mtime: ocaml] Command started
[mirage-flow: make] Command started
-> installed mtime.0.8.3
[win-eventlog: make] Command started
[mirage-flow: make install] Command started
-> installed mirage-flow.1.1.0
[hvsock: ocaml setup.ml] Command started
[win-eventlog: make install] Command started
[hvsock: make] Command started
-> installed win-eventlog.0.1
[hvsock: make install] Command started
-> installed hvsock.0.11.1
[menhir: make Makefile] Command started
-> installed menhir.20161115
[atd: make] Command started
[atd: make install] Command started
-> installed atd.1.2.0
[atdgen: make] Command started
[atdgen: make findlib-install] Command started
-> installed atdgen.1.10.0
[camomile: make install] Command started
-> installed camomile.0.8.5
[zed: ocaml setup.ml] Command started
[zed: ocaml setup.ml] Command started
[zed: ocaml setup.ml] Command started
-> installed zed.1.4
[lambda-term: ocaml setup.ml] Command started
[lambda-term: ocaml setup.ml] Command started
[lambda-term: ocaml setup.ml] Command started
-> installed lambda-term.1.10.1
[github: ocaml setup.ml] Command started
[protocol-9p: ocaml build] Command started
[github: ocaml setup.ml] Command started
-> installed protocol-9p.0.7.4
[datakit-client: ocaml build] Command started
[datakit-server: ocaml build] Command started
-> installed datakit-server.0.7.0
-> installed datakit-client.0.7.0
[github: ocaml setup.ml] Command started
-> installed github.2.1.0
[github-hooks: ocaml build] Command started
-> installed github-hooks.0.1.1
[datakit-github: ocaml build] Command started
[91m[ERROR] The compilation of datakit-github failed at "ocaml pkg/pkg.ml build
        --pinned true -n datakit-github".
[0m[91m
#=== ERROR while installing datakit-github.~unknown ===========================#
# opam-version         1.2.2 (58ef3b8213100953848d362f7120a30356d7f77d)
# os                   linux
# command              ocaml pkg/pkg.ml build --pinned true -n datakit-github
# path                 /home/opam/.opam/4.03.0/build/datakit-github.~unknown
# compiler             4.03.0
# exit-code            1
# env-file             /home/opam/.opam/4.03.0/build/datakit-github.~unknown/datakit-github-6-c7f6dc.env
# stdout-file          /home/opam/.opam/4.03.0/build/datakit-github.~unknown/datakit-github-6-c7f6dc.out
# stderr-file          /home/opam/.opam/4.03.0/build/datakit-github.~unknown/datakit-github-6-c7f6dc.err
### stdout ###
# [...]
# ocamlfind ocamlc -c -g -bin-annot -safe-string -package 'uri datakit-client datakit-server.vfs asetmap' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github.cmi bridge/github/datakit_github.mli
# ocamlfind ocamlc -c -g -bin-annot -safe-string -package 'github github-hooks.unix' -package 'uri datakit-client datakit-server.vfs asetmap' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github_api.cmi bridge/github/datakit_github_api.mli
# ocamlfind ocamldep -package 'uri datakit-client datakit-server.vfs asetmap' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules bridge/github/datakit_github.ml > bridge/github/datakit_github.ml.depends
# ocamlfind ocamlopt -c -g -bin-annot -safe-string -package 'uri datakit-client datakit-server.vfs asetmap' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github.cmx bridge/github/datakit_github.ml
# ocamlfind ocamlopt -c -g -bin-annot -safe-string -package 'github github-hooks.unix' -package 'uri datakit-client datakit-server.vfs asetmap' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github_api.cmx bridge/github/datakit_github_api.ml
# + ocamlfind ocamlopt -c -g -bin-annot -safe-string -package 'github github-hooks.unix' -package 'uri datakit-client datakit-server.vfs asetmap' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github_api.cmx bridge/github/datakit_github_api.ml
# File "bridge/github/datakit_github_api.ml", line 224, characters 5-24:
# Error: Unbound value Github.Repo.get_ref
# Hint: Did you mean get_tag?
# Command exited with code 2.
### stderr ###
# pkg.ml: [ERROR] cmd ['ocamlbuild' '-use-ocamlfind' '-tag' 'debug' '-build-dir' '_build'
# [...]
#      'bridge/github/datakit_github.cmx' 'bridge/github/datakit_github.cmi'
#      'bridge/github/datakit_github.mli'
#      'bridge/github/datakit-github-server.a'
#      'bridge/github/datakit-github-server.cmxs'
#      'bridge/github/datakit-github-server.cmxa'
#      'bridge/github/datakit-github-server.cma'
#      'bridge/github/datakit_github_vfs.cmx'
#      'bridge/github/datakit_github_vfs.cmi'
#      'bridge/github/datakit_github_vfs.mli' 'bridge/github/main.native']: exited with 10

[0m

=-=- Error report -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
The following actions failed
  - install datakit-github ~unknown
The following changes have been performed
  - install asl            0.10    
  - install atd            1.2.0   
  - install atdgen         1.10.0  
  - install camomile       0.8.5   
  - install datakit-server 0.7.0   
  - install duration       0.1.0   
  - install github         2.1.0   
  - install github-hooks   0.1.1   
  - install hex            1.0.0   
  - install hvsock         0.11.1  
  - install lambda-term    1.10.1  
  - install menhir         20161115
  - install mirage-flow    1.1.0   
  - install mtime          0.8.3   
  - install win-eventlog   0.1     
  - install zed            1.4     
[91m[NOTE] Pinning command successful, but your installed packages may be out of
       sync.
[0m[91m
The former state can be restored with:
    opam switch import "~/.opam/4.03.0/backup/state-20161102084955.export"
[0mThe command '/bin/sh -c opam pin add datakit-github https://github.com/docker/datakit.git' returned a non-zero code: 4
[2016-12-02 08:51.40] Failed: Command "docker" "build" "--pull" "-f" "Dockerfile.ci" "." exited with status 1
