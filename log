=== Run docker-build-github on commit 8501cb5e73a9e9c7a0e78e5c9eb528f68e590f40
[2016-11-03 10:33.23] Starting...
Cloning into '/tmp/with_clone21d8951f'...
done.
HEAD is now at 8501cb5 ci: add a CI script to test DataKit itself
[2016-11-03 10:33.23] Running "docker" "build" "--pull" "-f" "Dockerfile.github" "."...
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.632 MB
Step 1 : FROM docker/datakit:server
server: Pulling from docker/datakit
Digest: sha256:235b18e124bf01a6749acb8eb41fee1e7f82bc18c9749dc366ce790b49137d04
Status: Image is up to date for docker/datakit:server
 ---> 99f01b659b82
Step 2 : COPY datakit-github.opam /home/opam/src/datakit/datakit-github.opam
 ---> Using cache
 ---> 8b5e4fd56df2
Step 3 : RUN opam pin add datakit-github.dev /home/opam/src/datakit -n
 ---> Using cache
 ---> d7549190cb89
Step 4 : RUN opam depext datakit-github && opam install datakit-github --deps
 ---> Running in 7fb903b9611d
# Detecting depexts using flags: x86_64 linux alpine
# The following system packages are needed:
#  - gmp-dev
#  - linux-headers
#  - m4
#  - ncurses-dev
#  - openssl-dev
#  - perl
#  - pkgconfig
m4
ncurses-dev
pkgconfig
# The following new OS packages need to be installed: gmp-dev linux-headers openssl-dev perl
The following command needs to be run through "sudo":
    apk add gmp-dev linux-headers openssl-dev perl
(1/6) Installing libgmpxx (6.1.0-r0)
(2/6) Installing gmp-dev (6.1.0-r0)
(3/6) Installing linux-headers (4.4.6-r1)
(4/6) Installing zlib-dev (1.2.8-r2)
(5/6) Installing openssl-dev (1.0.2j-r0)
(6/6) Installing perl (5.22.2-r0)
Executing busybox-1.24.2-r11.trigger
OK: 492 MiB in 92 packages
# OS packages installation successful

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-github: local] Command started
[datakit-github] /home/opam/src/datakit/ already up-to-date
The following actions will be performed:
  - install conf-perl        1        
  - install magic-mime       1.0.0    
  - install menhir           20160825 
  - install easy-format      1.2.0    
  - install asl              0.10     
  - install conf-gmp         1        
  - install ocamlify         0.0.1    
  - install mtime            0.8.3    
  - install ocamlmod         0.0.8    
  - install datakit-client   0.6.0    
  - install fieldslib        113.33.03
  - install base64           2.1.2    
  - install conf-which       1        
  - install mirage-no-xen    1        
  - install mirage-flow      1.1.0    
  - install hex              1.0.0    
  - install win-eventlog     0.1      
  - install atd              1.2.0    
  - install zarith           1.4.1    
  - install oasis            0.4.7    
  - install ppx_fields_conv  113.33.03
  - install biniou           1.0.12   
  - install hvsock           0.10.0   
  - install asn1-combinators 0.1.2    
  - install nocrypto         0.5.3    
  - install yojson           1.3.3    
  - install x509             0.5.3    
  - install atdgen           1.10.0   
  - install tls              0.7.1    
  - install conduit          0.13.0   
  - install cohttp           0.21.0   
  - install github           2.0.3    
  - install github-hooks     0.1.1    
===== 33 to install =====
Do you want to continue ? [Y/n] y

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[asl: http] Command started
[asn1-combinators: http] Command started
[atd: http] Command started
[atd: http] Command started
[atd.1.2.0] https://github.com/mjambon/atd/archive/v1.2.0.tar.gz downloaded
[atdgen: http] Command started
[asl: http] Command started
[asl.0.10] https://github.com/mirage/ocaml-asl/archive/v0.10.tar.gz downloaded
[base64: http] Command started
[asn1-combinators: http] Command started
[asn1-combinators.0.1.2] https://github.com/mirleft/ocaml-asn1-combinators/archive/0.1.2.tar.gz downloaded
[biniou: http] Command started
[base64: http] Command started
[base64.2.1.2] https://github.com/mirage/ocaml-base64/releases/download/v2.1.2/base64-2.1.2.tbz downloaded
[cohttp: http] Command started
[atdgen: http] Command started
[atdgen.1.10.0] https://github.com/mjambon/atdgen/archive/v1.10.0.tar.gz downloaded
[conduit: http] Command started
[biniou: http] Command started
[biniou.1.0.12] https://github.com/mjambon/biniou/archive/v1.0.12.tar.gz downloaded
[datakit-client: http] Command started
[conduit: http] Command started
[conduit.0.13.0] https://github.com/mirage/ocaml-conduit/archive/v0.13.0.tar.gz downloaded
[easy-format: http] Command started
[cohttp: http] Command started
[cohttp.0.21.0] https://github.com/mirage/ocaml-cohttp/archive/v0.21.0.tar.gz downloaded
[fieldslib: http] Command started
[datakit-client: http] Command started
[datakit-client.0.6.0] https://github.com/docker/datakit/releases/download/0.6.0/datakit-0.6.0.tbz downloaded
[github: http] Command started
[fieldslib: http] Command started
[fieldslib.113.33.03] https://ocaml.janestreet.com/ocaml-core/113.33/files/fieldslib-113.33.03.tar.gz downloaded
[github-hooks: http] Command started
[easy-format: http] Command started
[easy-format.1.2.0] https://github.com/mjambon/easy-format/archive/v1.2.0.tar.gz downloaded
[hex: http] Command started
[github-hooks: http] Command started
[github-hooks.0.1.1] https://github.com/dsheets/ocaml-github-hooks/releases/download/0.1.1/github-hooks-0.1.1.tbz downloaded
[hvsock: http] Command started
[hex: http] Command started
[hex.1.0.0] https://github.com/mirage/ocaml-hex/archive/1.0.0.tar.gz downloaded
[magic-mime: http] Command started
[github: http] Command started
[github.2.0.3] https://github.com/mirage/ocaml-github/archive/v2.0.3.tar.gz downloaded
[menhir: http] Command started
[menhir: http] Command started
[menhir.20160825] http://gallium.inria.fr/~fpottier/menhir/menhir-20160825.tar.gz downloaded
[mirage-flow: http] Command started
[hvsock: http] Command started
[hvsock.0.10.0] https://github.com/djs55/ocaml-hvsock/archive/v0.10.0.tar.gz downloaded
[mtime: http] Command started
[mtime: http] Command started
[mtime.0.8.3] http://erratique.ch/software/mtime/releases/mtime-0.8.3.tbz downloaded
[nocrypto: http] Command started
[mirage-flow: http] Command started
[mirage-flow.1.1.0] https://github.com/mirage/mirage-flow/archive/v1.1.0.tar.gz downloaded
[oasis: http] Command started
[oasis: http] Command started
[oasis.0.4.7] https://forge.ocamlcore.org/frs/download.php/1635/oasis-0.4.7.tar.gz downloaded
[ocamlify: http] Command started
[magic-mime: http] Command started
[magic-mime.1.0.0] https://github.com/mirage/ocaml-magic-mime/archive/v1.0.0.tar.gz downloaded
[ocamlmod: http] Command started
[ocamlify: http] Command started
[ocamlify.0.0.1] http://forge.ocamlcore.org/frs/download.php/379/ocamlify-0.0.1.tar.gz downloaded
[ppx_fields_conv: http] Command started
[ocamlmod: http] Command started
[ocamlmod.0.0.8] https://forge.ocamlcore.org/frs/download.php/1544/ocamlmod-0.0.8.tar.gz downloaded
[tls: http] Command started
[ppx_fields_conv: http] Command started
[ppx_fields_conv.113.33.03] https://ocaml.janestreet.com/ocaml-core/113.33/files/ppx_fields_conv-113.33.03.tar.gz downloaded
[win-eventlog: http] Command started
[win-eventlog: http] Command started
[win-eventlog.0.1] https://github.com/djs55/ocaml-win-eventlog/archive/v0.1.tar.gz downloaded
[x509: http] Command started
[x509: http] Command started
[x509.0.5.3] https://github.com/mirleft/ocaml-x509/archive/0.5.3.tar.gz downloaded
[yojson: http] Command started
[tls: http] Command started
[tls.0.7.1] https://github.com/mirleft/ocaml-tls/archive/0.7.1.tar.gz downloaded
[zarith: http] Command started
[zarith: http] Command started
[zarith.1.4.1] https://forge.ocamlcore.org/frs/download.php/1574/zarith-1.4.1.tgz downloaded
[yojson: http] Command started
[yojson.1.3.3] https://github.com/mjambon/yojson/archive/v1.3.3.tar.gz downloaded
[nocrypto: http] Command started
[nocrypto.0.5.3] https://github.com/mirleft/ocaml-nocrypto/archive/v0.5.3.tar.gz downloaded

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[asl: make] Command started
[base64: ocaml build] Command started
[conf-gmp: sh] Command started
[conf-perl: perl] Command started
-> installed conf-perl.1
[conf-which: which which] Command started
-> installed conf-which.1
[datakit-client: ocaml build] Command started
-> installed conf-gmp.1
[easy-format: make] Command started
-> installed base64.2.1.2
[fieldslib: ./configure] Command started
[easy-format: make install] Command started
-> installed easy-format.1.2.0
[biniou: make] Command started
-> installed datakit-client.0.6.0
[hex: ./configure] Command started
[fieldslib: make] Command started
[biniou: make install] Command started
-> installed biniou.1.0.12
[magic-mime: ./configure] Command started
[hex: make] Command started
[magic-mime: make] Command started
-> installed fieldslib.113.33.03
[menhir: make Makefile] Command started
[asl: make install] Command started
[hex: make install] Command started
[magic-mime: make install] Command started
-> installed asl.0.10
[mirage-flow: ./configure] Command started
-> installed hex.1.0.0
-> installed mirage-no-xen.1
[mtime: ocaml] Command started
[mtime: ocaml] Command started
-> installed magic-mime.1.0.0
[ocamlify: ocaml setup.ml] Command started
[mirage-flow: make] Command started
-> installed mtime.0.8.3
[ocamlmod: ocaml setup.ml] Command started
[ocamlify: ocaml setup.ml] Command started
[ocamlmod: ocaml setup.ml] Command started
[ocamlify: ocaml setup.ml] Command started
[mirage-flow: make install] Command started
-> installed ocamlify.0.0.1
[ppx_fields_conv: ./configure] Command started
[ocamlmod: ocaml setup.ml] Command started
-> installed mirage-flow.1.1.0
[hvsock: ocaml setup.ml] Command started
[ppx_fields_conv: make] Command started
-> installed ocamlmod.0.0.8
[oasis: ocaml setup.ml] Command started
[hvsock: make] Command started
-> installed ppx_fields_conv.113.33.03
[win-eventlog: make] Command started
[oasis: ocaml setup.ml] Command started
[hvsock: make install] Command started
[win-eventlog: make install] Command started
-> installed hvsock.0.10.0
[yojson: make] Command started
-> installed win-eventlog.0.1
[zarith: ./configure] Command started
[zarith: make] Command started
[menhir: make Makefile] Command started
-> installed menhir.20160825
[atd: make] Command started
[zarith: make install] Command started
-> installed zarith.1.4.1
[asn1-combinators: ocaml setup.ml] Command started
[yojson: make install-lib] Command started
-> installed yojson.1.3.3
[asn1-combinators: ocaml setup.ml] Command started
[atd: make install] Command started
-> installed atd.1.2.0
[atdgen: make] Command started
[asn1-combinators: ocaml setup.ml] Command started
-> installed asn1-combinators.0.1.2
[atdgen: make findlib-install] Command started
-> installed atdgen.1.10.0
[oasis: ocaml setup.ml] Command started
-> installed oasis.0.4.7
[nocrypto: ./configure] Command started
[nocrypto: make] Command started
[nocrypto: make install] Command started
-> installed nocrypto.0.5.3
[x509: ./configure] Command started
[x509: make] Command started
[x509: make install] Command started
-> installed x509.0.5.3
[tls: ./configure] Command started
[tls: make] Command started
[tls: make install] Command started
-> installed tls.0.7.1
[conduit: make] Command started
[conduit: make install] Command started
-> installed conduit.0.13.0
[cohttp: make] Command started
[cohttp: make install] Command started
-> installed cohttp.0.21.0
[github: ocaml setup.ml] Command started
[github: ocaml setup.ml] Command started
[github: ocaml setup.ml] Command started
-> installed github.2.0.3
[github-hooks: ocaml build] Command started
-> installed github-hooks.0.1.1
Done.
 ---> e53669acc057
Removing intermediate container 7fb903b9611d
Step 5 : COPY . /home/opam/src/datakit/
 ---> 4c73cd40a6c8
Removing intermediate container 891f8993fbd7
Step 6 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in 59b137d4c023
 ---> 1b644482f4b6
Removing intermediate container 59b137d4c023
Step 7 : RUN cd /home/opam/src/datakit &&     git diff && git status --porcelain &&     git checkout . && scripts/watermark.sh &&     git status --porcelain
 ---> Running in 8e942beef193
?? bridge/github/datakit_github_conv.ml
?? bridge/github/datakit_github_conv.mli
?? bridge/github/datakit_github_sync.ml
?? bridge/github/datakit_github_sync.mli
 M src/version.ml
?? bridge/github/datakit_github_conv.ml
?? bridge/github/datakit_github_conv.mli
?? bridge/github/datakit_github_sync.ml
?? bridge/github/datakit_github_sync.mli
 ---> e4bcaaa93145
Removing intermediate container 8e942beef193
Step 8 : RUN opam update datakit-github
 ---> Running in 79cd81383504

=-=- Synchronizing development packages -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-github: local] Command started
[datakit-github] /home/opam/src/datakit/ synchronized
 ---> 3a6c082d8e9f
Removing intermediate container 79cd81383504
Step 9 : RUN opam install datakit-github -vv
 ---> Running in c10ed299a12c

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-github: local] Command started
+ rsync "-rLptgoDrvc" "--exclude" ".git" "--exclude" "_darcs" "--exclude" ".hg" "--exclude" ".#*" "--delete" "/home/opam/src/datakit/" "/home/opam/.opam/system/packages.dev/datakit-github"
- sending incremental file list
- 
- sent 7,196 bytes  received 37 bytes  14,466.00 bytes/sec
- total size is 1,141,395  speedup is 157.80
[datakit-github] /home/opam/src/datakit/ already up-to-date
The following actions will be performed:
  - install datakit-github dev*

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-github: local] Command started
+ rsync "-rLptgoDrvc" "--exclude" ".git" "--exclude" "_darcs" "--exclude" ".hg" "--exclude" ".#*" "--delete" "/home/opam/src/datakit/" "/home/opam/.opam/system/packages.dev/datakit-github"
- sending incremental file list
- 
- sent 7,196 bytes  received 37 bytes  14,466.00 bytes/sec
- total size is 1,141,395  speedup is 157.80
[datakit-github.dev] /home/opam/src/datakit/ already up-to-date

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[datakit-github: ocaml build] Command started
+ ocaml "pkg/pkg.ml" "build" "--pinned" "true" "-n" "datakit-github" (CWD=/home/opam/.opam/system/build/datakit-github.dev)
[91m[ERROR] The compilation of datakit-github failed at "ocaml pkg/pkg.ml build
        --pinned true -n datakit-github".
[0m- ocamlfind ocamlopt unix.cmxa -I /usr/lib/ocaml/ocamlbuild /usr/lib/ocaml/ocamlbuild/ocamlbuildlib.cmxa -linkpkg myocamlbuild.ml /usr/lib/ocaml/ocamlbuild/ocamlbuild.cmx -o myocamlbuild
- ocamlfind ocamldep -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules bridge/github/datakit_github.ml > bridge/github/datakit_github.ml.depends
- ocamlfind ocamldep -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules bridge/github/datakit_github.mli > bridge/github/datakit_github.mli.depends
- ocamlfind ocamlc -c -g -bin-annot -safe-string -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github.cmi bridge/github/datakit_github.mli
- ocamlfind ocamldep -package 'github github-hooks.unix' -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules bridge/github/datakit_github_api.ml > bridge/github/datakit_github_api.ml.depends
- ocamlfind ocamldep -package 'github github-hooks.unix' -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules bridge/github/datakit_github_api.mli > bridge/github/datakit_github_api.mli.depends
- ocamlfind ocamlc -c -g -bin-annot -safe-string -package 'github github-hooks.unix' -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github_api.cmi bridge/github/datakit_github_api.mli
- ocamlfind ocamlopt -c -g -bin-annot -safe-string -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github.cmx bridge/github/datakit_github.ml
- + ocamlfind ocamlopt -c -g -bin-annot -safe-string -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github.cmx bridge/github/datakit_github.ml
- File "bridge/github/datakit_github.ml", line 753, characters 47-65:
- Error: This expression has type Datakit_path.t
-        but an expression was expected of type string
- Command exited with code 2.
- pkg.ml: [ERROR] cmd ['ocamlbuild' '-use-ocamlfind' '-tag' 'debug' '-build-dir' '_build'
-      'CHANGES.md' 'LICENSE.md' 'README.md' 'pkg/META.github'
-      'datakit-github.opam' 'bridge/github/datakit-github.a'
-      'bridge/github/datakit-github.cmxs' 'bridge/github/datakit-github.cmxa'
-      'bridge/github/datakit-github.cma'
-      'bridge/github/datakit_github_vfs.cmx'
-      'bridge/github/datakit_github_vfs.cmi'
-      'bridge/github/datakit_github_vfs.mli'
-      'bridge/github/datakit_github_api.cmx'
-      'bridge/github/datakit_github_api.cmi'
-      'bridge/github/datakit_github_api.mli'
-      'bridge/github/datakit_github.cmx' 'bridge/github/datakit_github.cmi'
-      'bridge/github/datakit_github.mli' 'bridge/github/main.native']: exited with 10
[91m
#=== ERROR while installing datakit-github.dev ================================#
# opam-version         1.2.2
# os                   linux
# command              ocaml pkg/pkg.ml build --pinned true -n datakit-github
# path                 /home/opam/.opam/system/build/datakit-github.dev
# compiler             system (4.02.3)
# exit-code            1
# env-file             /home/opam/.opam/system/build/datakit-github.dev/datakit-github-7-1872ec.env
# stdout-file          /home/opam/.opam/system/build/datakit-github.dev/datakit-github-7-1872ec.out
# stderr-file          /home/opam/.opam/system/build/datakit-github.dev/datakit-github-7-1872ec.err
### stdout ###
# [...]
# ocamlfind ocamlc -c -g -bin-annot -safe-string -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github.cmi bridge/github/datakit_github.mli
# ocamlfind ocamldep -package 'github github-hooks.unix' -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules bridge/github/datakit_github_api.ml > bridge/github/datakit_github_api.ml.depends
# ocamlfind ocamldep -package 'github github-hooks.unix' -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -modules bridge/github/datakit_github_api.mli > bridge/github/datakit_github_api.mli.depends
# ocamlfind ocamlc -c -g -bin-annot -safe-string -package 'github github-hooks.unix' -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github_api.cmi bridge/github/datakit_github_api.mli
# ocamlfind ocamlopt -c -g -bin-annot -safe-string -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github.cmx bridge/github/datakit_github.ml
# + ocamlfind ocamlopt -c -g -bin-annot -safe-string -package 'uri datakit-client datakit-server.vfs' -package 'bytes lwt astring logs result cstruct fmt rresult' -warn-error +1..49 -w A-3-4-41-44 -I bridge/github -I src -I ci/src -I src/datakit -o bridge/github/datakit_github.cmx bridge/github/datakit_github.ml
# File "bridge/github/datakit_github.ml", line 753, characters 47-65:
# Error: This expression has type Datakit_path.t
#        but an expression was expected of type string
# Command exited with code 2.
### stderr ###
# pkg.ml: [ERROR] cmd ['ocamlbuild' '-use-ocamlfind' '-tag' 'debug' '-build-dir' '_build'
# [...]
#      'bridge/github/datakit-github.cma'
#      'bridge/github/datakit_github_vfs.cmx'
#      'bridge/github/datakit_github_vfs.cmi'
#      'bridge/github/datakit_github_vfs.mli'
#      'bridge/github/datakit_github_api.cmx'
#      'bridge/github/datakit_github_api.cmi'
#      'bridge/github/datakit_github_api.mli'
#      'bridge/github/datakit_github.cmx' 'bridge/github/datakit_github.cmi'
#      'bridge/github/datakit_github.mli' 'bridge/github/main.native']: exited with 10

[0m

=-=- Error report -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
The following actions failed
  - install datakit-github dev
No changes have been performed
[91m'opam install datakit-github -vv' failed.
[0mThe command '/bin/sh -c opam install datakit-github -vv' returned a non-zero code: 4
[2016-11-03 10:35.45] Failed: Command "docker" "build" "--pull" "-f" "Dockerfile.github" "." exited with status 1
