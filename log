=== Docker build Dockerfile.ci
[2017-02-10 12:49.52] Starting...
Cloning into '/tmp/with_cloned5893d'...
done.
HEAD is now at 4f63031 Add a multi-release helper
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.685 MBSending build context to Docker daemon 6.872 MB
Step 1/19 : FROM ocaml/opam:alpine-3.5_ocaml-4.04.0
alpine-3.5_ocaml-4.04.0: Pulling from ocaml/opam
Digest: sha256:8c73fc2a9afe303ec8f249d55b0e92548856c0520be31f392054aca16a138f10
Status: Image is up to date for ocaml/opam:alpine-3.5_ocaml-4.04.0
 ---> 059d7cd6ce55
Step 2/19 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 58e79a59d19c
Step 3/19 : RUN sudo apk add tzdata
 ---> Using cache
 ---> 9473c3be3943
Step 4/19 : RUN opam depext -i opam-devel && sudo cp $(opam config var "opam-devel:lib")/opam /usr/bin/opam
 ---> Using cache
 ---> 6d5e3ad4ecfd
Step 5/19 : RUN rm -rf ~/.opam
 ---> Using cache
 ---> 97e046be63c5
Step 6/19 : RUN opam init -y
 ---> Using cache
 ---> 9494d04b832f
Step 7/19 : RUN opam install ocaml -y
 ---> Using cache
 ---> 1d4450f1863c
Step 8/19 : RUN opam install depext -y
 ---> Using cache
 ---> 552f58a316f5
Step 9/19 : RUN opam pin add -yn datakit-client.dev https://github.com/docker/datakit.git &&     opam pin add -yn github --dev &&     opam pin add -yn datakit-github.dev https://github.com/talex5/datakit.git#split-prometheus &&     opam pin add -yn datakit-server.dev https://github.com/talex5/datakit.git#split-prometheus &&     opam pin add -yn datakit.dev https://github.com/talex5/datakit.git#split-prometheus
 ---> Using cache
 ---> f0ebb08c82ab
Step 10/19 : ADD datakit-ci.opam /tmp/deps/opam
 ---> Using cache
 ---> e60667123bd0
Step 11/19 : RUN opam pin add -y tmp /tmp/deps/opam -n
 ---> Using cache
 ---> c055c409d798
Step 12/19 : RUN opam depext tmp -y
 ---> Using cache
 ---> 41aff451c7ef
Step 13/19 : RUN opam install --deps-only tmp -y
 ---> Running in e5346cb70ac5

=-=- Synchronising pinned packages =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[tmp.~dev] no changes from file:///tmp/deps/opam

The following actions will be performed:
  - install conf-gmp            1
  - install mirage-no-xen       1
  - install conf-m4             1
  - install conf-perl           1
  - install conf-which          1
  - install result              1.2
  - install ocamlfind           1.7.1
  - install zarith              1.4.1
  - install uutf                0.9.4
  - install topkg               0.8.1
  - install sexplib             113.33.00+4.03
  - install react               1.2.0
  - install ppx_tools           5.0
  - install ocamlmod            0.0.8
  - install ocamlify            0.0.1
  - install menhir              20170101
  - install magic-mime          1.0.0
  - install fieldslib           113.24.00
  - install easy-format         1.2.0
  - install dispatch            0.3.0
  - install crunch              1.4.1
  - install base-bytes          base
  - install rresult             0.5.0
  - install mtime               0.8.4
  - install fmt                 0.8.0
  - install duration            0.1.0
  - install astring             0.8.3
  - install asetmap             0.8.1
  - install ppx_core            113.33.01+4.03
  - install lwt                 2.7.0
       For module Lwt_react, please install package lwt_react
  - install oasis               0.4.8
  - install biniou              1.0.12
  - install atd                 1.2.0
  - install win-error           0.2
  - install uuidm               0.9.6
  - install stringext           1.4.3
  - install re                  1.7.1
  - install cppo                1.4.1
  - install base64              2.1.2
  - install ocb-stubblr         0.1.0
  - install ppx_optcomp         113.33.01+4.03
  - install prometheus          0.1
  - install logs                0.6.2
  - install multipart-form-data 0.1.0
  - install tyxml               4.0.1
       For tyxml's ppx, please install tyxml-ppx.
  - install redis               0.3.3
  - install yojson              1.3.3
  - install ppx_deriving        4.1
  - install ocplib-endian       1.0
  - install camomile            0.8.5
  - install named-pipe          0.4.0
  - install ppx_driver          113.33.02+4.03
  - install win-eventlog        0.1
  - install asl                 0.10
  - install atdgen              1.10.0
  - install cstruct             2.3.1
  - install zed                 1.4
  - install ppx_type_conv       113.33.02+4.03
  - install io-page             1.6.1
  - install hex                 1.0.0
  - install asn1-combinators    0.1.3
  - install lambda-term         1.10.1
  - install ppx_sexp_conv       113.33.01+4.03
  - install ppx_fields_conv     113.33.00+4.03
  - install uri                 1.9.2
  - install nocrypto            0.5.3
  - install ipaddr              2.7.1
  - install x509                0.5.3
  - install pbkdf               0.2.0
  - install mirage-types        2.8.0
  - install mirage-types-lwt    2.8.0
  - install tls                 0.7.1
  - install mirage-flow         1.1.0
  - install channel             1.1.1
  - install conduit             0.14.5
  - install hvsock              0.11.1
  - install protocol-9p         0.8.0
  - install cohttp              0.20.2
  - install datakit-server      dev*
  - install datakit-client      dev*
  - install webmachine          0.3.2
  - install prometheus-app      0.1
  - install github              2.2.0*
  - install session             0.3.0
  - install github-hooks        0.1.1
  - install datakit-github      dev*
===== 86 to install =====

=-=- Gathering sources =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[asetmap.0.8.1] downloaded from https://opam.ocaml.org/2.0/cache
[asn1-combinators.0.1.3] downloaded from https://opam.ocaml.org/2.0/cache
[asl.0.10] downloaded from https://opam.ocaml.org/2.0/cache
[astring.0.8.3] downloaded from https://opam.ocaml.org/2.0/cache
[atd.1.2.0] downloaded from https://opam.ocaml.org/2.0/cache
[atdgen.1.10.0] downloaded from https://opam.ocaml.org/2.0/cache
[base64.2.1.2] downloaded from https://opam.ocaml.org/2.0/cache
[biniou.1.0.12] downloaded from https://opam.ocaml.org/2.0/cache
[channel.1.1.1] downloaded from https://opam.ocaml.org/2.0/cache
[conduit.0.14.5] downloaded from https://opam.ocaml.org/2.0/cache
[cohttp.0.20.2] downloaded from https://opam.ocaml.org/2.0/cache
[cppo.1.4.1] downloaded from https://opam.ocaml.org/2.0/cache
[crunch.1.4.1] downloaded from https://opam.ocaml.org/2.0/cache
[camomile.0.8.5] downloaded from https://opam.ocaml.org/2.0/cache
[cstruct.2.3.1] downloaded from https://opam.ocaml.org/2.0/cache
[datakit-client.dev] synchronised from git+https://github.com/docker/datakit.git
[datakit-github.dev] synchronised from git+https://github.com/talex5/datakit.git#split-prometheus
[dispatch.0.3.0] downloaded from https://opam.ocaml.org/2.0/cache
[duration.0.1.0] downloaded from https://opam.ocaml.org/2.0/cache
[datakit-server.dev] synchronised from git+https://github.com/talex5/datakit.git#split-prometheus
[easy-format.1.2.0] downloaded from https://opam.ocaml.org/2.0/cache
[fmt.0.8.0] downloaded from https://opam.ocaml.org/2.0/cache
[fieldslib.113.24.00] downloaded from https://opam.ocaml.org/2.0/cache
[github-hooks.0.1.1] downloaded from https://opam.ocaml.org/2.0/cache
[hex.1.0.0] downloaded from https://opam.ocaml.org/2.0/cache
[github.2.2.0] synchronised from git+https://github.com/mirage/ocaml-github.git
[hvsock.0.11.1] downloaded from https://opam.ocaml.org/2.0/cache
[io-page.1.6.1] downloaded from https://opam.ocaml.org/2.0/cache
[ipaddr.2.7.1] downloaded from https://opam.ocaml.org/2.0/cache
[logs.0.6.2] downloaded from https://opam.ocaml.org/2.0/cache
[lambda-term.1.10.1] downloaded from https://opam.ocaml.org/2.0/cache
[magic-mime.1.0.0] downloaded from https://opam.ocaml.org/2.0/cache
[lwt.2.7.0] downloaded from https://opam.ocaml.org/2.0/cache
[mirage-flow.1.1.0] downloaded from https://opam.ocaml.org/2.0/cache
[mirage-types.2.8.0] downloaded from https://opam.ocaml.org/2.0/cache
[mtime.0.8.4] downloaded from https://opam.ocaml.org/2.0/cache
[menhir.20170101] downloaded from https://opam.ocaml.org/2.0/cache
[multipart-form-data.0.1.0] downloaded from https://opam.ocaml.org/2.0/cache
[named-pipe.0.4.0] downloaded from https://opam.ocaml.org/2.0/cache
[ocamlfind.1.7.1] downloaded from https://opam.ocaml.org/2.0/cache
[oasis.0.4.8] downloaded from https://opam.ocaml.org/2.0/cache
[ocamlify.0.0.1] downloaded from https://opam.ocaml.org/2.0/cache
[ocamlmod.0.0.8] downloaded from https://opam.ocaml.org/2.0/cache
[ocb-stubblr.0.1.0] downloaded from https://opam.ocaml.org/2.0/cache
[nocrypto.0.5.3] downloaded from https://opam.ocaml.org/2.0/cache
[pbkdf.0.2.0] downloaded from https://opam.ocaml.org/2.0/cache
[ocplib-endian.1.0] downloaded from https://opam.ocaml.org/2.0/cache
[ppx_deriving.4.1] downloaded from https://opam.ocaml.org/2.0/cache
[ppx_core.113.33.01+4.03] downloaded from https://opam.ocaml.org/2.0/cache
[ppx_driver.113.33.02+4.03] downloaded from https://opam.ocaml.org/2.0/cache
[ppx_fields_conv.113.33.00+4.03] downloaded from https://opam.ocaml.org/2.0/cache
[ppx_optcomp.113.33.01+4.03] downloaded from https://opam.ocaml.org/2.0/cache
[ppx_sexp_conv.113.33.01+4.03] downloaded from https://opam.ocaml.org/2.0/cache
[ppx_tools.5.0] downloaded from https://opam.ocaml.org/2.0/cache
[prometheus.0.1] downloaded from https://opam.ocaml.org/2.0/cache
[ppx_type_conv.113.33.02+4.03] downloaded from https://opam.ocaml.org/2.0/cache
[protocol-9p.0.8.0] downloaded from https://opam.ocaml.org/2.0/cache
[re.1.7.1] downloaded from https://opam.ocaml.org/2.0/cache
[prometheus-app.0.1] downloaded from https://opam.ocaml.org/2.0/cache
[react.1.2.0] downloaded from https://opam.ocaml.org/2.0/cache
[result.1.2] downloaded from https://opam.ocaml.org/2.0/cache
[rresult.0.5.0] downloaded from https://opam.ocaml.org/2.0/cache
[redis.0.3.3] downloaded from https://opam.ocaml.org/2.0/cache
[session.0.3.0] downloaded from https://opam.ocaml.org/2.0/cache
[stringext.1.4.3] downloaded from https://opam.ocaml.org/2.0/cache
[sexplib.113.33.00+4.03] downloaded from https://opam.ocaml.org/2.0/cache
[topkg.0.8.1] downloaded from https://opam.ocaml.org/2.0/cache
[tyxml.4.0.1] downloaded from https://opam.ocaml.org/2.0/cache
[tls.0.7.1] downloaded from https://opam.ocaml.org/2.0/cache
[uuidm.0.9.6] downloaded from https://opam.ocaml.org/2.0/cache
[uri.1.9.2] downloaded from https://opam.ocaml.org/2.0/cache
[uutf.0.9.4] downloaded from https://opam.ocaml.org/2.0/cache
[webmachine.0.3.2] downloaded from https://opam.ocaml.org/2.0/cache
[win-error.0.2] downloaded from https://opam.ocaml.org/2.0/cache
[win-eventlog.0.1] downloaded from https://opam.ocaml.org/2.0/cache
[yojson.1.3.3] downloaded from https://opam.ocaml.org/2.0/cache
[x509.0.5.3] downloaded from https://opam.ocaml.org/2.0/cache
[zed.1.4] downloaded from https://opam.ocaml.org/2.0/cache
[zarith.1.4.1] downloaded from https://opam.ocaml.org/2.0/cache

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed mirage-no-xen.1
-> installed conf-gmp.1
-> installed conf-m4.1
-> installed conf-perl.1
-> installed conf-which.1
-> installed result.1.2
-> installed ocamlfind.1.7.1
-> installed base-bytes.base
-> installed easy-format.1.2.0
-> installed ocamlify.0.0.1
-> installed cppo.1.4.1
-> installed magic-mime.1.0.0
-> installed biniou.1.0.12
-> installed crunch.1.4.1
-> installed dispatch.0.3.0
-> installed fieldslib.113.24.00
-> installed ocamlmod.0.0.8
-> installed ocplib-endian.1.0
-> installed ppx_tools.5.0
-> installed re.1.7.1
-> installed react.1.2.0
-> installed sexplib.113.33.00+4.03
-> installed stringext.1.4.3
-> installed topkg.0.8.1
-> installed uutf.0.9.4
-> installed asetmap.0.8.1
-> installed base64.2.1.2
-> installed duration.0.1.0
-> installed fmt.0.8.0
-> installed rresult.0.5.0
-> installed uuidm.0.9.6
-> installed win-error.0.2
-> installed astring.0.8.3
-> installed mtime.0.8.4
-> installed ppx_deriving.4.1
-> installed yojson.1.3.3
-> installed zarith.1.4.1
-> installed ocb-stubblr.0.1.0
-> installed menhir.20170101
-> installed tyxml.4.0.1
-> installed atd.1.2.0
-> installed ppx_core.113.33.01+4.03
-> installed lwt.2.7.0
-> installed ppx_optcomp.113.33.01+4.03
-> installed atdgen.1.10.0
-> installed multipart-form-data.0.1.0
-> installed prometheus.0.1
-> installed camomile.0.8.5
-> installed logs.0.6.2
-> installed named-pipe.0.4.0
-> installed redis.0.3.3
-> installed cstruct.2.3.1
-> installed asl.0.10
-> installed oasis.0.4.8
-> installed asn1-combinators.0.1.3
-> installed hex.1.0.0
-> installed io-page.1.6.1
-> installed ppx_driver.113.33.02+4.03
-> installed win-eventlog.0.1
-> installed zed.1.4
-> installed ppx_type_conv.113.33.02+4.03
-> installed ppx_fields_conv.113.33.00+4.03
-> installed ppx_sexp_conv.113.33.01+4.03
-> installed ipaddr.2.7.1
-> installed mirage-types.2.8.0
-> installed mirage-types-lwt.2.8.0
-> installed channel.1.1.1
-> installed uri.1.9.2
-> installed mirage-flow.1.1.0
-> installed lambda-term.1.10.1
-> installed nocrypto.0.5.3
-> installed hvsock.0.11.1
-> installed pbkdf.0.2.0
-> installed protocol-9p.0.8.0
-> installed x509.0.5.3
-> installed datakit-client.dev
-> installed datakit-server.dev
-> installed tls.0.7.1
-> installed conduit.0.14.5
-> installed cohttp.0.20.2
-> installed prometheus-app.0.1
-> installed webmachine.0.3.2
-> installed session.0.3.0
-> installed github.2.2.0
-> installed github-hooks.0.1.1
-> installed datakit-github.dev
Done.

=-=- lwt.2.7.0 installed successfully -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
=> The future Lwt 3.0.0 will make minor breaking changes near 1 April 2017. See
     https://github.com/ocsigen/lwt/issues/308
# Run eval `opam env` to update the current shell environment
 ---> 437554af7cbf
Removing intermediate container e5346cb70ac5
Step 14/19 : ADD . /home/opam/datakit
 ---> ca2f9cd1c4e3
Removing intermediate container 5bd4316203e2
Step 15/19 : RUN sudo chown opam /home/opam/datakit
 ---> Running in 3db0c893f5b1
 ---> cd9af9414edf
Removing intermediate container 3db0c893f5b1
Step 16/19 : RUN opam pin add -k git datakit-client.dev /home/opam/datakit -y
 ---> Running in 88e4f3924941
[91m[NOTE] Will pin to 'master' using git
[0m[91m[NOTE] Package datakit-client is currently pinned to git+https://github.com/docker/datakit.git (version dev).
[0mProceed and change pinning target ? [Y/n] y
[datakit-client.dev: git]
[datakit-client.dev: git]
[datakit-client.dev: git]
[datakit-client.dev: git]
[datakit-client.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-client/datakit-client.opam from 1.2 to 2.0~beta
[0mdatakit-client is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - recompile datakit-client dev*
  - recompile datakit-github dev*                               [uses datakit-client]
===== 2 to recompile =====
[datakit-client.dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> removed   datakit-github.dev
-> removed   datakit-client.dev
-> installed datakit-client.dev
-> installed datakit-github.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> 923fe310b28b
Removing intermediate container 88e4f3924941
Step 17/19 : RUN opam pin add -k git datakit-ci.dev /home/opam/datakit -y
 ---> Running in db028b81e1cb
[91m[NOTE] Will pin to 'master' using git
[0mPackage datakit-ci does not exist, create as a NEW package ? [Y/n] y
[datakit-ci.dev: git]
[datakit-ci.dev: git]
[datakit-ci.dev: git]
[datakit-ci.dev: git]
[datakit-ci.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-ci/datakit-ci.opam from 1.2 to 2.0~beta
[0mdatakit-ci is now pinned to git+file:///home/opam/datakit#master (version dev)

The following actions will be performed:
  - install datakit-ci dev*
[datakit-ci.dev] synchronised from git+file:///home/opam/datakit#master

=-=- Processing actions -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-> installed datakit-ci.dev
Done.
# Run eval `opam env` to update the current shell environment
 ---> 9126e4753452
Removing intermediate container db028b81e1cb
Step 18/19 : RUN opam pin add -k git datakit-github.dev /home/opam/datakit -yn
 ---> Running in a2ff9935d175
[91m[NOTE] Will pin to 'master' using git
[0mProceed and change pinning target ? [Y/n] y
[91m[NOTE] Package datakit-github is currently pinned to git+https://github.com/talex5/datakit.git#split-prometheus (version dev).
[0m[datakit-github.dev: git]
[datakit-github.dev: git]
[datakit-github.dev: git]
[datakit-github.dev: git]
[datakit-github.dev] synchronised from git+file:///home/opam/datakit#master
[91m[NOTE] Converting format of /home/opam/.opam/default/.opam-switch/sources/datakit-github/datakit-github.opam from 1.2 to 2.0~beta
[0mdatakit-github is now pinned to git+file:///home/opam/datakit#master (version dev)
 ---> 185fb0dec732
Removing intermediate container a2ff9935d175
Step 19/19 : VOLUME /secrets
 ---> Running in 38961965b0ed
 ---> 1344549747bd
Removing intermediate container 38961965b0ed
Successfully built 1344549747bd
[2017-02-10 12:55.03] Success
